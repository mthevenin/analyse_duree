<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Méthodes non paramétrique</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/simplex.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>










<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Analyse des durées</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Données et théorie
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Introduction.html">Introduction</a>
    </li>
    <li>
      <a href="Donnees.html">Les Donnéees biographiques</a>
    </li>
    <li>
      <a href="Theorie.html">Eléments théoriques</a>
    </li>
  </ul>
</li>
<li>
  <a href="nonparam.html">Méthodes non paramétriques</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Modèles à risques proportionnels
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Intro_mod.html">Intro</a>
    </li>
    <li>
      <a href="cox.html">Cox</a>
    </li>
    <li>
      <a href="discret.html">Méthode à temps discret</a>
    </li>
    <li>
      <a href="dynamiques.html">Variables dynamiques</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Compléments
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="param.html">Modèles paramétriques</a>
    </li>
    <li>
      <a href="concurrents.html">Risques concurrents</a>
    </li>
    <li>
      <a href="cure.html">fragilité et imunité</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Programmation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="SAS.html">SAS</a>
    </li>
    <li>
      <a href="Stata.html">Stata</a>
    </li>
    <li>
      <a href="R.html">R</a>
    </li>
    <li>
      <a href="Python.html">Python</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Méthodes non paramétrique</h1>

</div>


<style>
p.comment {
background-color: #DBDBDB;
padding: 10px;
border: 1px solid black;
margin-left: 25px;
border-radius: 5px;
font-style: italic;
}
</style>
<p>Les méthodes non paramétriques portent généralement sur l’analyse des fonctions de survie (séjour) ou sur celle des fonctions de répartitions, plus rarement sur les mesures d’incidence données par le risque cumulé.<br />
Deux méthodes d’estimations sont proposées : la méthode dite actuarielle et la méthode dite de Kaplan &amp; Meier. Ces deux méthodes sont adaptées à des mesures différentes de la durée : plutôt discrète pour la technique actuarielle et plutôt continue pour Kaplan-Meier (KM). Cela induit un traitement différent de la censure dans l’estimation. La seconde est de très très loin la plus diffusée, surement en raison des tests de comparaison qu’elle est en mesure de fournir.</p>
<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> <strong>Introduction</strong></h1>
<p><br></p>
<div id="les-variables-danalyse" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> <strong>Les variables d’analyse</strong></h2>
<p>On a un échantillon aléatoire de <span class="math inline">\(n\)</span> individus avec:</p>
<ul>
<li>Des indicateurs de fin d’épisode <span class="math inline">\(e_1,e_2,....,e_k\)</span> avec <span class="math inline">\(e_i=0\)</span> si censure à droite et <span class="math inline">\(e_i=1\)</span> si évènement observé pendant la période d’observation.</li>
<li>Des durées d’exposition au risque <span class="math inline">\(t_1,t_2,....,t_k\)</span> jusqu’à l’évènement ou la censure.</li>
<li>En théorie, il ne peut pas y avoir d’évènement en <span class="math inline">\(t=0\)</span>.</li>
</ul>
<p><br></p>
</div>
<div id="calcul-de-la-fonction-de-survie" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> <strong>Calcul de la fonction de survie</strong></h2>
<p>Rappel: La fonction de survie donne la probabilité que l’évènement survienne après <span class="math inline">\(t_i\)</span>, soit <span class="math inline">\(S(t_i)=P(T&gt;t_i)\)</span>.<br />
Pour survivre en <span class="math inline">\(t_i\)</span>, il faut avoir survécu en <span class="math inline">\(t_{i-1}\)</span>, <span class="math inline">\(t_{i-2}\)</span>, …., <span class="math inline">\(t_{1}\)</span>.<br />
La fonction de survie rapporte donc des probabilités conditionnelles: survivre en <span class="math inline">\(t_i\)</span> conditionnellement au fait d’y avoir survécu avant. Il s’agit donc d’un produit de probabilités:<br />
<br></p>
<p>Soit <span class="math inline">\(d_i=\sum e_i\)</span> le nombre d’évènements observé en <span class="math inline">\(t_i\)</span> et <span class="math inline">\(r_i\)</span> la population encore soumise au risque en <span class="math inline">\(i\)</span>. On peut mesurer l’intensité de l’évènement en <span class="math inline">\(t_i\)</span> en calculant le quotient <span class="math inline">\(q(t_i)=\frac{d_i}{r_i}\)</span>. Si le temps est strictement continu on devrait toujours avoir <span class="math inline">\(q(t_i)=\frac{1}{r_i}\)</span>.</p>
<p><span class="math inline">\(S(t_i) = (1 - \frac{d_i}{r_i})\times{S(t_{i-1})} = S(t_i) = (1 - q(t_i))\times{S(t_{i-1})}\)</span>. En remplaçant <span class="math inline">\(S(t_{i-1})\)</span> par sa valeur: <span class="math inline">\(S(t_i) = (1 - \frac{d_i}{r_i})\times(1 - \frac{d_{i-1}}{r_{i-1}})\times{S(t_{i-2})}\)</span>.<br />
<br> En remplaçant toutes les expressions de la survie jusqu’en <span class="math inline">\(t_0\)</span> (<span class="math inline">\(S(0)=1\)</span>):<br />
<br></p>
<p><span class="math display">\[S(t_i)=\displaystyle \prod_{t_i\leq{k}} (1-q(t_i))\]</span></p>
<p><BR></p>
<p class="comment">
<strong>Application pour la suite de la formation</strong><br />
On va analyser le risque de décéder (la survie) de personnes souffrant d’une insuffisance cardiaque. Le début de l’exposition est leur inscription dans un registre d’attente pour une greffe du coeur.<br />
Les covariables sont dans un premier temps toutes fixes: l’année (<em>year</em>) et l’âge (<em>age</em>) à l’entrée dans le registre, et le fait d’avoir été opéré pour un pontage aorto-coronarien avant l’inscription (<em>surgery</em>). Le début de l’exposition au risque est l’entrée dans le registre, la durée est mesurée en jour (<em>stime</em>). La variable évènement est le décès (<em>died</em>). <br> L’introduction d’une dimension dynamique, la greffe, sera donnée par les variable <em>transplant</em> et <em>wait</em>.
</p>
<p><br></p>
</div>
</div>
<div id="la-méthode-actuarielle" class="section level1" number="2">
<h1><span class="header-section-number">2</span> <strong>La méthode actuarielle</strong></h1>
<ul>
<li>Estimation sur des intervalles définies par l’utilisateur.</li>
<li>Approche dite «continue», estimation en milieu d’intevalle.</li>
<li>Méthode apropriée lorsque la durée est mesurée de manière discrète.</li>
</ul>
<p><strong>Echelle temporelle</strong></p>
<p>La durée est divisée en <span class="math inline">\(J\)</span> intervalles, en choisissant <span class="math inline">\(J\)</span> points: <span class="math inline">\(t_0&lt;t_1&lt;...&lt;t_J\)</span> avec <span class="math inline">\(t_{J+1}=\infty\)</span>.</p>
<p><strong>Calcul du Risk set</strong></p>
<ul>
<li>A <span class="math inline">\(t_{min}=0\)</span>, <span class="math inline">\(n_0=n\)</span> individus soumis au risque: <span class="math inline">\(r_0=n_0\)</span>.</li>
<li>Le nombre d’exposé.e.s au risque sur un intervalle est calculé en soustrayant la moitié des cas censurés sur la longueur de l’intervalle: <span class="math inline">\(r_i=n_i- 0.5\times{c_i}\)</span>, avec <span class="math inline">\(n_i\)</span> le nombre de personnes soumises au risque au début de l’intervalle et <span class="math inline">\(c_i\)</span> le nombre d’observations censurées sur la longueur de l’intervalle. On suppose donc que les observations censurées <span class="math inline">\(c_i\)</span> sont sorties de l’observation uniformément sur l’intervalle. Les cas censurés le sont en moyenne au millieu de l’intervalle. <br></li>
</ul>
<p><strong>Calcul de <span class="math inline">\(S(t_i)\)</span></strong><br />
On applique la méthode de la section précédente avec:</p>
<p><span class="math display">\[q(t_i)=\frac{d_i}{n_i - 0.5\times c_i}\]</span></p>
<p><strong>Calcul de la durée médiane (ou autre quantiles)</strong><br />
<br> <em>Rappel</em>: compte tenu des censures à droite, le dernier intervalle étant ouvert, il n’est pas conseillé de calculer des durées moyennes. On préfère utiliser la médiane ou tout autre quantile lorsqu’ils sont définissables.<br />
*Définition**: il s’agit de la durée telle que <span class="math inline">\(S(t_i)=0.5\)</span>.<br />
<em>Calcul</em>: Comme on applique une méthode continue et monotone à l’intérieur dintervalles, on ne peut pas calculer directement un point de coupure qui correspond à 50% de survivants. On doit donc trouver ce point par interpolation linéaire dans l’intervalle<span class="math inline">\([t_i;t_{i+1}[\)</span> avec <span class="math inline">\(S(t_{i+1})\leq0.5\)</span> et <span class="math inline">\(S(t_{i})&gt;0.5\)</span>.</p>
<br> <strong>Logiciels</strong><br />

<div class="alert alert-info">
<ul>
<li><strong>SAS</strong>: incluse dans <code>proc lifetest</code>.</li>
<li><strong>Stata</strong>: commande <code>ltable</code>. Voir la commande externe <code>qlt</code> (MT) qui calcule les durées médianes (+ autres quartiles) et qui cale la définition des intervalles avec celle de SAS.</li>
<li><strong>R</strong>: une fonction programmée par un utilisateur (package <code>discSurv</code> =&gt; fonction <code>lifeTable</code>), mais pas convaincante car pas d’estimation sur les quantiles, et estimation avec des intervalles toujours fixés à <span class="math inline">\(dt=1\)</span>. D’un intérêt très limité.<br />
</li>
<li><strong>Python</strong>: à l’heure actuelle, aucune fonction à ma connaissance.<br />
</li>
</ul>
</div>
<p><br></p>
<p><em>Exemple</em></p>
<pre><code>                 Beg.                                 Std.
   Interval     Total   Deaths   Lost    Survival    Error     [95% Conf. Int.]
-------------------------------------------------------------------------------
    0    10       103       13      0     0.8738    0.0327     0.7926    0.9247
   10    20        90        6      1     0.8152    0.0383     0.7257    0.8779
   20    30        83        3      0     0.7857    0.0405     0.6931    0.8533
   30    40        80        6      2     0.7261    0.0441     0.6284    0.8020
   40    50        72        4      0     0.6857    0.0461     0.5857    0.7664
   50    60        68        4      0     0.6454    0.0476     0.5439    0.7299
   60    70        64        5      0     0.5950    0.0489     0.4926    0.6834
   70    80        59        4      0     0.5546    0.0496     0.4523    0.6454
   80    90        55        3      0     0.5244    0.0499     0.4225    0.6165
   90   100        52        2      0     0.5042    0.0499     0.4029    0.5971
  100   110        50        2      1     0.4838    0.0500     0.3831    0.5773
  110   120        47        1      0     0.4735    0.0499     0.3732    0.5673
  130   140        46        0      1     0.4735    0.0499     0.3732    0.5673
  140   150        45        1      0     0.4630    0.0499     0.3631    0.5570
  150   160        44        1      0     0.4525    0.0499     0.3530    0.5467
  160   170        43        1      0     0.4420    0.0498     0.3429    0.5364
  180   190        42        2      1     0.4207    0.0496     0.3227    0.5154
  200   210        39        1      0     0.4099    0.0495     0.3125    0.5047
  210   220        38        1      0     0.3991    0.0494     0.3024    0.4939
  260   270        37        1      1     0.3882    0.0492     0.2921    0.4830
  280   290        35        2      0     0.3660    0.0489     0.2714    0.4608
  300   310        33        1      0     0.3549    0.0486     0.2612    0.4496
  330   340        32        1      0     0.3438    0.0483     0.2510    0.4383
  340   350        31        2      1     0.3213    0.0477     0.2305    0.4153
  370   380        28        0      1     0.3213    0.0477     0.2305    0.4153
  390   400        27        0      1     0.3213    0.0477     0.2305    0.4153
  420   430        26        0      1     0.3213    0.0477     0.2305    0.4153
  440   450        25        0      1     0.3213    0.0477     0.2305    0.4153
  480   490        24        0      1     0.3213    0.0477     0.2305    0.4153
  510   520        23        0      1     0.3213    0.0477     0.2305    0.4153
  540   550        22        0      1     0.3213    0.0477     0.2305    0.4153
  580   590        21        1      0     0.3060    0.0478     0.2156    0.4008
  590   600        20        0      1     0.3060    0.0478     0.2156    0.4008
  620   630        19        0      1     0.3060    0.0478     0.2156    0.4008
  670   680        18        1      1     0.2885    0.0482     0.1983    0.3847
  730   740        16        1      0     0.2705    0.0484     0.1808    0.3680
  840   850        15        0      1     0.2705    0.0484     0.1808    0.3680
  850   860        14        1      0     0.2511    0.0487     0.1622    0.3501
  910   920        13        0      1     0.2511    0.0487     0.1622    0.3501
  940   950        12        0      1     0.2511    0.0487     0.1622    0.3501
  970   980        11        1      0     0.2283    0.0493     0.1398    0.3299
  990  1000        10        1      0     0.2055    0.0494     0.1187    0.3088
 1030  1040         9        1      0     0.1826    0.0489     0.0988    0.2869
 1140  1150         8        0      1     0.1826    0.0489     0.0988    0.2869
 1320  1330         7        0      1     0.1826    0.0489     0.0988    0.2869
 1380  1390         6        1      0     0.1522    0.0493     0.0715    0.2609
 1400  1410         5        0      2     0.1522    0.0493     0.0715    0.2609
 1570  1580         3        0      1     0.1522    0.0493     0.0715    0.2609
 1580  1590         2        0      1     0.1522    0.0493     0.0715    0.2609
 1790  1800         1        0      1     0.1522    0.0493     0.0715    0.2609
-------------------------------------------------------------------------------

Durée pour differents quantiles de la fonction de survie
Définition des bornes Sas-lifetest
S(t)=0.90: t=    7.923
S(t)=0.75: t=   35.989
S(t)=0.50: t=  102.068
S(t)=0.25: t=  913.968
S(t)=0.10: t=        .</code></pre>
<p><img src="images/Image7.png" /></p>
<p>102 jours après leur inscription dans le registre d’attente pour une greffe, 50% des malades sont toujours en vie. Au bout de 914 jours, 75% des personnes sont décédées.</p>
<p><br></p>
</div>
<div id="la-méthode-de-kaplan-meier" class="section level1" number="3">
<h1><span class="header-section-number">3</span> <strong>La méthode de Kaplan-Meier</strong></h1>
<ul>
<li>L’approche qui exploite toute l’information disponible est celle dite de <strong>Kaplan-Meier</strong> (<em>KM</em>).</li>
<li>Il y a autant d’intervalles que de durées où l’on observe au moins un évènement.</li>
<li>Au lieu d’utiliser des intervalles prédéterminés, l’estimateur KM va définir un intervalle entre chaque évènement enregistré.</li>
<li>La fonction de survie estimée par la méthode KM est une fonction en escalier (stairstep), d’où une méthode dite “discrète”.</li>
<li>Pour chaque intervalle, on compte le nombe d’évènements et le nombre de censures.</li>
<li>Méthode adaptée pour une mesure de la durée de type continue.</li>
</ul>
<p><strong>Définition du Risk Set (<span class="math inline">\(r_i\)</span>)</strong></p>
<p>S’il y a à la fois des évènements et des censures à une durée <span class="math inline">\(t_i\)</span>, les observations censurées sont considérées comme exposées au risque à ce moment, comme si elles étaient censurées très rapidement après. C’est la principale caractéristique de cette méthode, nommée également l’estimateur « product-limit »</p>
<p><span class="math display">\[r_i=r_{i-1}-d_{i-1}-c_{i-1}\]</span><br />
<br></p>
<p><strong>Calcul de <span class="math inline">\(q_i\)</span></strong><br />
<br> On applique la méthode de la section précédente avec:</p>
<p><span class="math display">\[q_i=\frac{d_i}{r_{i-1}-d_{i-1}-c_{i-1}}\]</span></p>
<p><strong>Récupération de la médiane</strong><br />
Il n’y a pas de méthode pour calculer directement la durée médiane (ou tout autre quantile).<br />
On va prendre la valeur de la durée qui se situe juste “en dessous” de 50% de survivant.e.s. Elle est donc définie tel que <span class="math inline">\(S(t)\leq0.5\)</span>. Pas de formule savante pour obtenir ce résultat, c’est une convention. Attention, il n’est pas impossible que le % de survivant.e.s soit bien en deçà de 50% pour obtenir cette durée médiane.</p>
<p><strong>Exemple</strong><br />
On reprend l’exemple précédent.</p>
<pre><code>Time    Total   Fail   Lost           Function     Error     [95% Conf. Int.]
-------------------------------------------------------------------------------
     1      103      1      0             0.9903    0.0097     0.9331    0.9986
     2      102      3      0             0.9612    0.0190     0.8998    0.9852
     3       99      3      0             0.9320    0.0248     0.8627    0.9670
     5       96      2      0             0.9126    0.0278     0.8388    0.9535
     6       94      2      0             0.8932    0.0304     0.8155    0.9394
     8       92      1      0             0.8835    0.0316     0.8040    0.9321
     9       91      1      0             0.8738    0.0327     0.7926    0.9247
    11       90      0      1             0.8738    0.0327     0.7926    0.9247
    12       89      1      0             0.8640    0.0338     0.7811    0.9171
    16       88      3      0             0.8345    0.0367     0.7474    0.8937
    17       85      1      0             0.8247    0.0375     0.7363    0.8857
    18       84      1      0             0.8149    0.0383     0.7253    0.8777
    21       83      2      0             0.7952    0.0399     0.7034    0.8614
    28       81      1      0             0.7854    0.0406     0.6926    0.8531
    30       80      1      0             0.7756    0.0412     0.6819    0.8448
    31       79      0      1             0.7756    0.0412     0.6819    0.8448
    32       78      1      0             0.7657    0.0419     0.6710    0.8363
    35       77      1      0             0.7557    0.0425     0.6603    0.8278
    36       76      1      0             0.7458    0.0431     0.6495    0.8192
    37       75      1      0             0.7358    0.0436     0.6388    0.8106
    39       74      1      1             0.7259    0.0442     0.6282    0.8019
    40       72      2      0             0.7057    0.0452     0.6068    0.7842
    43       70      1      0             0.6956    0.0457     0.5961    0.7752
    45       69      1      0             0.6856    0.0461     0.5855    0.7662
    50       68      1      0             0.6755    0.0465     0.5750    0.7572
    51       67      1      0             0.6654    0.0469     0.5645    0.7481
    53       66      1      0             0.6553    0.0472     0.5541    0.7390
    58       65      1      0             0.6452    0.0476     0.5437    0.7298
    61       64      1      0             0.6352    0.0479     0.5333    0.7206
    66       63      1      0             0.6251    0.0482     0.5230    0.7113
    68       62      2      0             0.6049    0.0487     0.5026    0.6926
    69       60      1      0             0.5948    0.0489     0.4924    0.6832
    72       59      2      0             0.5747    0.0493     0.4722    0.6643
    77       57      1      0             0.5646    0.0494     0.4621    0.6548
    78       56      1      0             0.5545    0.0496     0.4521    0.6453
    80       55      1      0             0.5444    0.0497     0.4422    0.6357
    81       54      1      0             0.5343    0.0498     0.4323    0.6261
    85       53      1      0             0.5243    0.0499     0.4224    0.6164
    90       52      1      0             0.5142    0.0499     0.4125    0.6067
    96       51      1      0             0.5041    0.0499     0.4027    0.5969
   100       50      1      0             0.4940    0.0499     0.3930    0.5872
   102       49      1      0             0.4839    0.0499     0.3833    0.5773
   109       48      0      1             0.4839    0.0499     0.3833    0.5773
   110       47      1      0             0.4736    0.0499     0.3733    0.5673
   131       46      0      1             0.4736    0.0499     0.3733    0.5673
   149       45      1      0             0.4631    0.0499     0.3632    0.5571
   153       44      1      0             0.4526    0.0499     0.3531    0.5468
   165       43      1      0             0.4421    0.0498     0.3430    0.5364
   180       42      0      1             0.4421    0.0498     0.3430    0.5364
   186       41      1      0             0.4313    0.0497     0.3327    0.5258
   188       40      1      0             0.4205    0.0497     0.3225    0.5152
   207       39      1      0             0.4097    0.0495     0.3123    0.5045
   219       38      1      0             0.3989    0.0494     0.3022    0.4938
   263       37      1      0             0.3881    0.0492     0.2921    0.4830
   265       36      0      1             0.3881    0.0492     0.2921    0.4830
   285       35      2      0             0.3660    0.0488     0.2714    0.4608
   308       33      1      0             0.3549    0.0486     0.2612    0.4496
   334       32      1      0             0.3438    0.0483     0.2510    0.4383
   340       31      1      1             0.3327    0.0480     0.2409    0.4270
   342       29      1      0             0.3212    0.0477     0.2305    0.4153
   370       28      0      1             0.3212    0.0477     0.2305    0.4153
   397       27      0      1             0.3212    0.0477     0.2305    0.4153
   427       26      0      1             0.3212    0.0477     0.2305    0.4153
   445       25      0      1             0.3212    0.0477     0.2305    0.4153
   482       24      0      1             0.3212    0.0477     0.2305    0.4153
   515       23      0      1             0.3212    0.0477     0.2305    0.4153
   545       22      0      1             0.3212    0.0477     0.2305    0.4153
   583       21      1      0             0.3059    0.0478     0.2156    0.4008
   596       20      0      1             0.3059    0.0478     0.2156    0.4008
   620       19      0      1             0.3059    0.0478     0.2156    0.4008
   670       18      0      1             0.3059    0.0478     0.2156    0.4008
   675       17      1      0             0.2879    0.0483     0.1976    0.3844
   733       16      1      0             0.2699    0.0485     0.1802    0.3676
   841       15      0      1             0.2699    0.0485     0.1802    0.3676
   852       14      1      0             0.2507    0.0487     0.1616    0.3497
   915       13      0      1             0.2507    0.0487     0.1616    0.3497
   941       12      0      1             0.2507    0.0487     0.1616    0.3497
   979       11      1      0             0.2279    0.0493     0.1394    0.3295
   995       10      1      0             0.2051    0.0494     0.1183    0.3085
  1032        9      1      0             0.1823    0.0489     0.0985    0.2865
  1141        8      0      1             0.1823    0.0489     0.0985    0.2865
  1321        7      0      1             0.1823    0.0489     0.0985    0.2865
  1386        6      1      0             0.1519    0.0493     0.0713    0.2606
  1400        5      0      1             0.1519    0.0493     0.0713    0.2606
  1407        4      0      1             0.1519    0.0493     0.0713    0.2606
  1571        3      0      1             0.1519    0.0493     0.0713    0.2606
  1586        2      0      1             0.1519    0.0493     0.0713    0.2606
  1799        1      0      1             0.1519    0.0493     0.0713    0.2606
-------------------------------------------------------------------------------</code></pre>
<p>Durée médiane: <span class="math inline">\(t=100\)</span> (correspond à <span class="math inline">\(S(t)=0.4940\)</span>).</p>
<p><img src="images/Image8.png" /></p>
<strong>Logiciels</strong><br />

<div class="alert alert-info">
<ul>
<li><strong>SAS</strong> : l’estimation de Kaplan-Meier est affichée par défaut par la <code>proc lifetest</code>. <strong>Attention : le tableau donné par SAS est particulièrement pénible à lire voire illisible, en particulier lorsque le nombre de censures est élevé, une ligne est ajoutée pour chaque observation censurée. Je conseille de ne pas afficher cette partie de l’output (voir section SAS)</strong>. On récupère pour le reste de l’output les valeurs de la durée pour S(t) =(.75,.5,.25) ainsi que le graphique, ce qui est suffisant.</li>
<li><strong>Stata</strong> : en mode survie (<strong><code>stset</code></strong>), le tableau des estimateurs est donné par la commande <strong><code>sts list</code></strong> et le graphique par <strong><code>sts graph</code></strong>.</li>
<li><strong>R</strong> : les estimateurs sont donnés par la fonction <strong><code>survfit</code></strong> de la librairie <code>survival</code>.</li>
<li><strong>Python</strong>: les resultats sont donnés dans la librairie <code>lifeline</code> par des fonctions dont le nom est tout bonnement interminable. Je conseille plutôt l’utilisation de la librairie <strong><code>statmodels</code></strong> (se reporter à la section dédiée à Python).</li>
</ul>
</div>
<p><strong>Exercice</strong><br />
Calculer la fonction de survie <span class="math inline">\(S\)</span> avec un tableur.</p>
<pre><code>----------------------------------------------------------------------
        t |          d           c           r           q           S
----------+-----------------------------------------------------------
        0 |          0           0                                    
        6 |          1           0                                    
       19 |          1           0                                    
       32 |          1           0                                    
       42 |          2           0                                    
       43 |          0           1                                    
       94 |          1           0                                    
      126 |          0           2                                    
      207 |          1           0                                    
      227 |          0           2                                    
      253 |          1           0                                    
      255 |          0           1                                    
----------------------------------------------------------------------</code></pre>
<p><strong>Quantités associées</strong><br />
<br></p>
<p><strong>Le risque cumulé</strong>: estimateur de Nelson AAlen<br />
Il est simplément égal à: <span class="math display">\[H(t)=\sum_{t_i\leq k}q(t_i)\]</span></p>
<p><img src="images/Image19.png" /></p>
<p><strong>Le risque instantané</strong><br />
Nécessite l’estimateur de Nelson-Aalen. Le risque est obtenu en lissant les différences - toujours positive - entre <span class="math inline">\(H(t)\)</span> par la méthode dite du <strong>kernel</strong>. Elle permet d’obtenir une fonction continue avec la durée (paramétrables sur les largeurs des fenêtres de lissage). D’autres méthodes de lissage sont maintenant possibles, et de plus en plus utilisées, en particulier celles utilisant des splines restreintes (paramétrable sur un nombre de degré de liberté – nœuds-).</p>
<p><img src="images/Image20.png" /></p>
</div>
<div id="tester-légalité-des-courbes-de-survie-méthode-km" class="section level1" number="4">
<h1><span class="header-section-number">4</span> <strong>Tester l’égalité des courbes de survie (méthode KM)</strong></h1>
<p>Les tests d’égalités des fonctions de survie entre différentes valeurs d’une covariable sont calculés à partir de la méthode de Kaplan Meier.<br />
<BR> L’utilisation du test correspond à la nécessité de déterminer si une même distribution gouverne les évènements observés dans les différentes strates ou les différents échantillons.<br />
Attention: pas de test possibles sur des variables continues. Prévoir des regroupements pour les transformer en variable ordinale.<br />
<BR> Deux méthodes sont utilisées:</p>
<ul>
<li>La plus ancienne et la plus diffusée: test sur les rangs (tests dits du <strong>log-rank</strong>).</li>
<li>Plus récente et moins difusée: comparaison des <strong>RMST</strong> (<em>Restricted Mean of Survival Time</em>). <br></li>
</ul>
<div id="tests-du-log-rank" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Tests du log-rank</h2>
<p>Il s’agit d’une série de tests qui répondent à la même logique, la seule différence réside dans le poids accordé au début ou à la fin de la période d’observation. Par ailleurs ces différents tests sont plus ou moins sensibles à la distribution des censures à droites entre les sous échantillons.<br />
<br> Ces tests entrent dans le cadre des tests du Khi2, même si formellement ils relèvent des techniques dites de rang.<br />
Il s’agira donc de comparer des effectifs observés à des effectifs espérés à chaque temps d’évènement. La principale différence réside dans le calcul de la variance de la statistique du test qui, ici, suit une loi hypergéométrique.</p>
<p><strong>Principe de calcul des effectifs - évènements - observés et espérés pour deux groupes</strong></p>
<ul>
<li><strong>Effectifs observés en <span class="math inline">\(t_i\)</span></strong>: <span class="math inline">\(o_{i1}\)</span> et <span class="math inline">\(o_{i2}\)</span> sont égaux à <span class="math inline">\(d_{i1}\)</span> et <span class="math inline">\(d_{i2}\)</span>, et leur somme pour tous les temps d’évènement à <span class="math inline">\(O_1\)</span> et <span class="math inline">\(O_2\)</span>.</li>
<li><strong>Effectifs expérés</strong> (hypothèse nulle <span class="math inline">\(H_0\)</span>): comme pour une statistique du <span class="math inline">\(\chi^2\)</span> on se base sur les marges, avec le risque set (<span class="math inline">\(R_i\)</span>) en <span class="math inline">\(t_i\)</span> pour dénombrer les effectifs, soit <span class="math inline">\(e_{i1}=R_{i1}\times\frac{d_i}{R_i}\)</span> et <span class="math inline">\(e_{i2}=R_{i2}\times\frac{d_2}{R_2}\)</span>. Leur somme pour tous les temps d’évènement est égale à <span class="math inline">\(E_1\)</span> et <span class="math inline">\(E_2\)</span>. Le principe de calcul des effectifs observés reposent donc sur l’hypothèse d’un rapport des risques toujours égal à 1 au cours du temps (<em>hypothèse fondamentale de risques proportionnels</em>).<br />
</li>
<li><strong>Statistique du log-rank</strong>: <span class="math inline">\((O_1 - E_1) = -(O_2 - E_2)\)</span>.</li>
<li><strong>Statistique de test</strong>: sous <span class="math inline">\(H_0\)</span>, <span class="math inline">\(\frac{(O_1 - E_1)^2}{\sum{v_i}}\)</span>, avec <span class="math inline">\(v_i\)</span> la variance de <span class="math inline">\((o_{i1} - e_{i2})\)</span>, suis un <span class="math inline">\(\chi^2(1)\)</span>.<br />
Si on teste la différence de <span class="math inline">\(g\)</span> fonctions de survie, la statistique de test suis un <span class="math inline">\(\chi^2(g-1)\)</span>.</li>
</ul>
<p><strong>Les principaux tests de type log-rank</strong></p>
<p>Le principe de construction des effectifs observés et espérés reste le même dans chaque test, les différences résident dans les pondérations (<span class="math inline">\(w_i\)</span>) qui prennent en compte, de manière différente, la taille de la population soumise au risque à chaque durée où au moins un évènement est observé.<br />
<br></p>
<ul>
<li><strong>Test du log-rank</strong>: <span class="math inline">\(w_i=1\)</span><br />
Il accorde le même poids à toutes les durées d’évènement. C’est le test standard, le plus utilisé.</li>
<li><strong>Test de Wilconxon-Breslow-Grehan</strong>: <span class="math inline">\(w_i=R_i\)</span><br />
Les écarts entre effectifs observés et espérés sont pondérés par la population soumise à risque en <span class="math inline">\(t_i\)</span>. Le test accorde plus de poids au début de la période analysée, et il est sensible aux différences de distributions entre les strates des observations censurées.</li>
<li><strong>Test de Tarone-Ware</strong>: <span class="math inline">\(w_i=\sqrt{R_i}\)</span><br />
Variante du test précédent, il atténue le poids accordé aux évènements au début de la période d’observation. Il est par ailleurs moins sensible au problème de la distribution des censures entre les strates.</li>
<li><strong>Test de Peto-Peto</strong> : <span class="math inline">\(w_i=S_i\)</span><br />
La pondération est une variante de la fonction de survie KM (avec <span class="math inline">\(R_i=R_i+1\)</span>). Le test n’est pas sensible au problème de distribution des censures.</li>
<li><strong>Test de Fleming-Harington</strong>: <span class="math inline">\(w_i=(S_i)^p\times(1-S_i)^{q}\)</span> avec <span class="math inline">\(0\leq{p}\leq{1}\)</span> Il permet de paramétrer le poids accordé au début où à la fin de temps d’observation. Si <span class="math inline">\(p=q=0\)</span> on retrouve le test du log-rank.</li>
</ul>
<p><br><br />
<strong>Exemple</strong> On compare ici l’effet du pontage sur le risque de décéder depuis l’inscription dans le registre de greffe. <img src="images/Image9.png" /></p>
<pre><code>Log-rank test for equality of survivor functions

        |   Events         Events
surgery |  observed       expected
--------+-------------------------
0       |        69          60.34
1       |         6          14.66
--------+-------------------------
Total   |        75          75.00

              chi2(1) =       6.59
              Pr&gt;chi2 =     0.0103


Wilcoxon (Breslow) test for equality of survivor functions

        |   Events         Events        Sum of
surgery |  observed       expected        ranks
--------+--------------------------------------
0       |        69          60.34          623
1       |         6          14.66         -623
--------+--------------------------------------
Total   |        75          75.00            0

              chi2(1) =       8.99
              Pr&gt;chi2 =     0.0027


Tarone-Ware test for equality of survivor functions

        |   Events         Events        Sum of
surgery |  observed       expected        ranks
--------+--------------------------------------
0       |        69          60.34    73.111827
1       |         6          14.66   -73.111827
--------+--------------------------------------
Total   |        75          75.00            0

              chi2(1) =       8.46
              Pr&gt;chi2 =     0.0036


Peto-Peto test for equality of survivor functions

        |   Events         Events        Sum of
surgery |  observed       expected        ranks
--------+--------------------------------------
0       |        69          60.34    6.0529913
1       |         6          14.66   -6.0529913
--------+--------------------------------------
Total   |        75          75.00            0

              chi2(1) =       8.66
              Pr&gt;chi2 =     0.0033</code></pre>
<p>Les résultats font apparaître, que l’opération permet d’allonger la durée de survie des personnes.</p>
<p><br></p>
<p><strong>Logiciels</strong></p>
<div class="alert alert-info">
<ul>
<li><strong>Sas</strong>: Le test non pondéré et la version Wilcoxon sont données avec l’option <strong><code>strata</code></strong> de la <code>proc lifetest</code>. Attention : ne jamais utiliser la version <em>LR Test</em> qui est biaisée. Pour obtenir d’autres versions du test du log-rank, on ajoute <strong><code>/test=all</code></strong> à l’option <code>strata</code>. Stata: on utilise la commande sts test avec le nom de la version du test si on ne souhaite pas récupérer toutes les variantes.</li>
<li><strong>R</strong>: on utilise la fonction <strong><code>survdiff</code></strong> de la librairie <code>survival</code>. Le résultat du test de Peto-Peto est affiché par défaut (<code>rho=1</code>). Si on souhaite utiliser le test non pondéré, on ajoute l’option <code>rho=0</code>. Pour obtenir le résultat d’un test multiple corrigé (plus d’un degré de liberté), on peut utiliser la fonction <strong><code>pairwise_survdiff</code></strong> de la librairie <strong><code>survminer</code></strong>.</li>
<li><strong>Python</strong>: Avec la librairie lifelines, on utilise la fonction logrank_test. Quatre variantes sont disponibles (Wilcoxon, Tarone-Ware, Peto-Peto et Fleming-Harrigton). On peut également utiliser la fonction duration.survdiff de statmodels (non pondéré, Wilcoxon - appelé ici Breslow- et Tarone-Ware).<br />
</li>
</ul>
</div>
<p><br></p>
<p><strong>En pratique/remarques</strong>:</p>
<ul>
<li>Les tests du log-rank sont sensibles à l’hypothèse de risques proportionnels (voir <strong>modèle semi-paramétrique de Cox</strong>). En pratique si des courbes de séjours se croisent, il est déconseillé de les utiliser. Cela ne signifie pas que si les courbes ne se croisent pas, l’hypothèse de proportionnalité des risques est respectée : des rapports de risque peuvent au cours du temps s’accentuer, se réduire ou le cas échant s’inverser (typique d’un croisement).</li>
<li>Effectuer un test global (multiple/omnibus) sur un nombre important de groupes (ou &gt;2) peut rendre le test très facilement significatif. Il peut être intéressant de tester des courbes deux à deux (idem qu’une régression avec covariable discrète), en conservant un seul degré de liberté. Des méthodes de correction du test multiple sont possibles.</li>
</ul>
<p><br></p>
</div>
<div id="comparaison-des-rmst" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Comparaison des RMST</h2>
<p><BR></p>
<p><strong>RMST</strong>: <em>Restricted Mean of Survival Time</em><br />
<br></p>
<p>La comparaison des RMST est une alternative pertinente aux tests du log-rank car elle ne repose pas sur des hypothèses contraignantes (proportionnalité des risques, distribution des censures), et permet une lecture vivante basée sur des espérances de séjour et non sur la lecture d’une simple p-value traduisant l’homogénéité ou non des fonctions de séjour. Par ailleurs les comparaisons sont souples, on peut choisir un ou plusieurs points d’horizon pour alimenter l’analyse.</p>
<p><br></p>
<p><strong>Principe</strong></p>
<ul>
<li>L’aire sous la fonction de survie représente la durée moyenne d’attente de l’évènement, soit l’espérance de survie à l’évènement. On est très proche d’une mesure en analyse démographique type « espérance de vie partielle ».</li>
<li>En présence de censure à droite, il faut borner la durée maximale <span class="math inline">\(t^*&lt;\infty\)</span>. L’espérance de survie s’interprète donc sur un horizon fini.</li>
<li><span class="math inline">\(RMST =\int_0^{t^*}S(t)dt\)</span>.</li>
<li>On peut facilement comparer les RMST de deux groupes, en termes de différence ou de ratio.</li>
<li>Par défaut on définit généralement <span class="math inline">\(t*\)</span> à partir le temps du dernier évènement observé. Il est néanmoins possible de calculer le RMST sur des intervalles plus court, ce qui lui permet une véritable souplesse au niveau de l’analyse.</li>
</ul>
<p><br> <strong>Logiciels</strong></p>
<div class="alert alert-info">
<ul>
<li><p><strong>SAS</strong> : disponible depuis la version 15.1 de SAS/Stat (fin 2018). Les estimations et le résultat du test de comparaison sont récupérables très simplement dans une <code>proc lifetest</code>. Bien que sortie tardivement par rapport aux autres applications standards, les résultats sont particulièrement complets.</p></li>
<li><p><strong>Stata</strong>: commande externe **<code>strmst2</code>*. La plus ancienne fonction proposée par les logiciels. Au final plus limitée que la solution Sas. J’ai programmé une commande, <code>diffrmst</code>, qui représente graphiquement les estimations des Rmst pour chaque temps d’évènement, leurs différences et les p-value issues des comparaisons.</p></li>
</ul>
<p><strong>R</strong> : librairie <strong><code>SurvRm2</code></strong>. Programmée par les mêmes personnes que la commande Stata, la fonction proposée n’est pas très souple.</p>
<p><strong>Python</strong> : estimation avec une fonction de la librairie <code>lifelines</code>. Pas de test de comparaison.</p>
</div>
<pre><code>Restricted Mean Survival Time (RMST) by arm
-----------------------------------------------------------
   Group |  Estimate    Std. Err.      [95% Conf. Interval]
---------+-------------------------------------------------
   arm 1 |   734.758     133.478      473.145      996.370
   arm 0 |   310.169      43.158      225.581      394.757
-----------------------------------------------------------

Between-group contrast (arm 1 versus arm 0) 
------------------------------------------------------------------------
           Contrast  |  Estimate       [95% Conf. Interval]     P&gt;|z|
---------------------+--------------------------------------------------
RMST (arm 1 - arm 0) |   424.589      149.641      699.537      0.002
RMST (arm 1 / arm 0) |     2.369        1.513        3.710      0.000
------------------------------------------------------------------------</code></pre>
<p>Ici <span class="math inline">\(t^*\)</span> est égal à 995 jours, soit la durée qui correspond au dernier décès observé lorsqu’une personne a été opérée pour un pontage (surgery=1).<br />
Sur un horizon de 995 jours, ces individus peuvent espérer vivre 735 jours en moyenne, contre 310 jours pour les autres. La durée moyenne de survie est donc deux fois plus importante pour les personnes opérées d’un pontage (rapport des Rmst = 2.3 ), soit une différence de 424 jours.</p>
<p><em>Rmst et différences de Rmst à tous les points d’évènement jusqu’à <span class="math inline">\(tmax\)</span></em></p>
<pre><code>  +--------------------------------------------------------------------------+
  | _time     _rmst1     _rmst0      _diff          _l         _u         _p |
  |--------------------------------------------------------------------------|
  |     1          1          1          0           0          0          . |
  |     2          2   1.989011    .010989     .010989    .010989          . |
  |     3          3   2.945055   .0549451   -.0196757   .1295658   .1489731 |
  |     5          5   4.791209   .2087912    .0256584   .3919241   .0254456 |
  |   5.1        5.1   4.882418   .2175824    .0240373   .4111275   .0275679 |
  |--------------------------------------------------------------------------|
  |     6          6   5.693407   .3065934    .0643487   .5488381   .0131162 |
  |     8          8   7.451648   .5483516    .1860869   .9106163   .0030096 |
  |     9          9    8.31978   .6802198    .2523926   1.108047   .0018318 |
  |    11         11   10.03407    .965934    .4072903   1.524578   .0007017 |
  |    12         12   10.89121   1.108791    .4836155   1.733967   .0005087 |
  |--------------------------------------------------------------------------|
  |    16         16   14.27525   1.724747    .8259398   2.623554   .0001692 |
  |    17         17   15.08787   1.912131    .9277063   2.896555   .0001407 |
  |    18         18   15.88935   2.110646     1.05301   3.168283   .0000918 |
  |    21         21   18.26041   2.739589    1.458002   4.021176   .0000279 |
  |    28         28   23.63703   4.362966    2.526501   6.199431   3.22e-06 |
  |--------------------------------------------------------------------------|
  |    30         30   25.15095   4.849051    2.842812    6.85529   2.17e-06 |
  |    31         31   25.89677   5.103226    3.014868   7.191583   1.67e-06 |
  |    32         32    26.6426     5.3574    3.186886   7.527915   1.31e-06 |
  |    35         35   28.84618   6.153824    3.736433   8.571216   6.06e-07 |
  |    36         36    29.5694     6.4306    3.929635   8.931564   4.67e-07 |
  |--------------------------------------------------------------------------|
  |    37         37   30.28132   6.718675    4.135427   9.301923   3.44e-07 |
  |    39         39   31.68257   7.317427    4.569757    10.0651   1.79e-07 |
  |    40         40   32.37189   7.628103    4.797789   10.45842   1.28e-07 |
  |    43         43   34.37207   8.627934    5.552385   11.70349   3.83e-08 |
  |    45         45   35.68291    9.31709     6.07508    12.5591   1.77e-08 |
  |--------------------------------------------------------------------------|
  |    50         50   38.90352   11.09648    7.431942   14.76102   2.94e-09 |
  |    51         51   39.53634   11.46366    7.711818    15.2155   2.12e-09 |
  |    53         53   40.77938   12.22061    8.298259   16.14297   1.02e-09 |
  |    58         58   43.83049   14.16951     9.81571   18.52331   1.79e-10 |
  |    61         61   45.62725   15.37275    10.75502   19.99047   6.81e-11 |
  |--------------------------------------------------------------------------|
  |    66         66   48.56535   17.43465    12.37503   22.49426   1.44e-11 |
  |    68         68   49.71799   18.28201    13.04371    23.5203   7.90e-12 |
  |    69         69   50.27171   18.72829    13.40325   24.05333   5.45e-12 |
  |    72         72   51.89897   20.10103    14.51838   25.68369   1.70e-12 |
  |    77         77   54.49805   22.50194    16.49285   28.51104   2.14e-13 |
  |--------------------------------------------------------------------------|
  |    78         78   55.00657   22.99343    16.89797   29.08889   1.43e-13 |
  |    80         80   56.00101   23.99899    17.73478   30.26321   5.97e-14 |
  |    81         81   56.48692   24.51307    18.16526   30.86089   3.77e-14 |
  |    85         85   58.38539   26.61461    19.93458   33.29464   5.77e-15 |
  |    90         90   60.70197   29.29803     22.1984   36.39766   6.66e-16 |
  |--------------------------------------------------------------------------|
  |    96         96   63.41406   32.58594    24.97681   40.19506          0 |
  |   100        100   65.17693   34.82308    26.87198   42.77418          0 |
  |   102        102   66.03575   35.96425    27.84368   44.08482          0 |
  |   109        109   68.96255   40.03745    31.32724   48.74766          0 |
  |   110        110   69.38067   40.61933    31.82339   49.41528          0 |
  |--------------------------------------------------------------------------|
  |   131        131   77.91717   53.08283    42.46146    63.7042          0 |
  |   149        149   85.23417   63.76583    51.49939   76.03227          0 |
  |   153        153   86.81235   66.18765    53.54893   78.82638          0 |
  |   165        165    91.4034    73.5966    59.87845   87.31474          0 |
  |   180   178.6364   97.14223   81.49413    51.34782   111.6404   1.17e-07 |
  |--------------------------------------------------------------------------|
  |   186   184.0909   99.43776   84.65315    53.34505   115.9613   1.16e-07 |
  |   188   185.7273   100.2029   85.52434    53.56977   117.4789   1.56e-07 |
  |   207   201.2727   107.2376    94.0351    58.18815   129.8821   2.73e-07 |
  |   219   211.0909   111.5325   99.55843    61.16676   137.9501   3.72e-07 |
  |   263   247.0909   126.7373   120.3536    72.25138   168.4559   9.40e-07 |
  |--------------------------------------------------------------------------|
  |   265   248.7273   127.4037   121.3235    72.75741   169.8897   9.77e-07 |
  |   285   265.0909   134.0682   131.0227    77.89536   184.1501   1.34e-06 |
  |   308   283.9091   141.1427   142.7664    84.36629   201.1664   1.66e-06 |
  |   334   305.1818   148.8068    156.375    91.96277   220.7872   1.95e-06 |
  |   340   310.0909   150.4986   159.5923    93.78695   225.3977   2.00e-06 |
  |--------------------------------------------------------------------------|
  |   342   311.7273   151.0369   160.6904    94.42397   226.9568   2.01e-06 |
  |   370   332.0909   158.5728   173.5181    93.67896   253.3572   .0000205 |
  |   397   351.7273   165.8396   185.8876    98.91358   272.8617    .000028 |
  |   427   373.5454   173.9138   199.6316    104.6545   294.6087   .0000379 |
  |   445   386.6364   178.7584    207.878    108.0686   307.6874   .0000446 |
  |--------------------------------------------------------------------------|
  |   482   413.5454   188.7166   224.8289    115.0297   334.6281   .0000599 |
  |   515   437.5454   197.5982   239.9472    121.1866   358.7078    .000075 |
  |   545   459.3636   205.6725   253.6912    126.7507   380.6316   .0000897 |
  |   583        487   215.8998   271.1002    133.7623    408.438   .0001093 |
  |   596   494.8788   219.3987   275.4801    134.5264   416.4339   .0001279 |
  |--------------------------------------------------------------------------|
  |   620   509.4243    225.858   283.5662    136.4692   430.6632   .0001579 |
  |   670   539.7273   239.3151   300.4122    140.0713   460.7531   .0002405 |
  |   675   542.7576   240.6608   302.0968    140.4026   463.7909   .0002504 |
  |   733   577.9091   254.9701    322.939    145.3689    500.509   .0003645 |
  |   841   643.3636   279.1928   364.1708    155.9437   572.3979   .0006085 |
  |--------------------------------------------------------------------------|
  |   852   650.0303   281.6599   368.3704    156.9483   579.7925    .000638 |
  |   915   688.2121   294.2198   393.9923    164.2457   623.7389   .0007762 |
  |   941   703.9697   299.4033   404.5664    167.1596   641.9732   .0008378 |
  |   979        727   306.9791   420.0209    171.3309   668.7109   .0009321 |
  |   995   734.7576   310.1689   424.5887    149.6407   699.5366   .0024726 |
  +--------------------------------------------------------------------------+</code></pre>
<p><img src="images/image9rmst.png" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
