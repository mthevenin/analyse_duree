<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.207">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Analyse des durées - Modèle de Cox</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./discret.html" rel="next">
<link href="./intro_mod.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Analyse des durées</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mthevenin/analyse_duree"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:marc.thevenin@ined.fr"><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Modèle de Cox</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false"><strong>Données et théorie</strong></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Donnees.html" class="sidebar-item-text sidebar-link">Les Données</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Theorie.html" class="sidebar-item-text sidebar-link">La théorie</a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false"><strong>Méthodes non paramétriques</strong></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fsurvie.html" class="sidebar-item-text sidebar-link">Les fonctions de survie</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./comp_fsurvie.html" class="sidebar-item-text sidebar-link">Tests de comparaison</a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true"><strong>Modèles à risques proportionnels</strong></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_mod.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cox.html" class="sidebar-item-text sidebar-link active">Modèle de Cox</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discret.html" class="sidebar-item-text sidebar-link">Modèle temps discret</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamiques.html" class="sidebar-item-text sidebar-link">Variables dynamiques</a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false"><strong>Compléments</strong></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./parametrique.html" class="sidebar-item-text sidebar-link">Modèles paramétriques</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./concurrent.html" class="sidebar-item-text sidebar-link">Risques concurrents</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./frailty.html" class="sidebar-item-text sidebar-link">Fragilité et immunité</a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false"><strong>Programmation</strong></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R.html" class="sidebar-item-text sidebar-link">R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Stata.html" class="sidebar-item-text sidebar-link">Stata</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Sas.html" class="sidebar-item-text sidebar-link">SAS</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Python.html" class="sidebar-item-text sidebar-link">PYTHON</a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false"><strong>Annexes</strong></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./annexes.html" class="sidebar-item-text sidebar-link">Annexes</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sections</h2>
   
  <ul>
  <li><a href="#le-modèle-semi-paramétrique-de-cox" id="toc-le-modèle-semi-paramétrique-de-cox" class="nav-link active" data-scroll-target="#le-modèle-semi-paramétrique-de-cox">Le modèle semi-paramétrique de Cox</a>
  <ul class="collapse">
  <li><a href="#la-vraisemblance-partielle-et-estimation-des-paramètres" id="toc-la-vraisemblance-partielle-et-estimation-des-paramètres" class="nav-link" data-scroll-target="#la-vraisemblance-partielle-et-estimation-des-paramètres">La vraisemblance partielle et estimation des paramètres</a></li>
  <li><a href="#estimation-des-paramètres" id="toc-estimation-des-paramètres" class="nav-link" data-scroll-target="#estimation-des-paramètres">Estimation des paramètres</a></li>
  <li><a href="#lecture-des-résultats" id="toc-lecture-des-résultats" class="nav-link" data-scroll-target="#lecture-des-résultats">Lecture des résultats</a></li>
  <li><a href="#r-stata-sas-python" id="toc-r-stata-sas-python" class="nav-link" data-scroll-target="#r-stata-sas-python">R-Stata-Sas-Python</a></li>
  </ul></li>
  <li><a href="#lhypothèse-de-constance-des-rapports-de-risque" id="toc-lhypothèse-de-constance-des-rapports-de-risque" class="nav-link" data-scroll-target="#lhypothèse-de-constance-des-rapports-de-risque">L’hypothèse de constance des rapports de risque</a>
  <ul class="collapse">
  <li><a href="#tests-sur-les-résidus-de-schoenfeld" id="toc-tests-sur-les-résidus-de-schoenfeld" class="nav-link" data-scroll-target="#tests-sur-les-résidus-de-schoenfeld">Tests sur les résidus de Schoenfeld</a></li>
  <li><a href="#intéraction-avec-la-durée" id="toc-intéraction-avec-la-durée" class="nav-link" data-scroll-target="#intéraction-avec-la-durée">Intéraction avec la durée</a></li>
  <li><a href="#que-faire" id="toc-que-faire" class="nav-link" data-scroll-target="#que-faire">Que faire</a></li>
  </ul></li>
  <li><a href="#cox-et-modèle-de-poisson" id="toc-cox-et-modèle-de-poisson" class="nav-link" data-scroll-target="#cox-et-modèle-de-poisson">Cox et modèle de poisson</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Modèle de Cox</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="le-modèle-semi-paramétrique-de-cox" class="level1">
<h1>Le modèle semi-paramétrique de Cox</h1>
<p>On peut ignorer la partie sur l’estimation du modèle. On retiendra tout de même qu’il est déconseillé de tester la méthode dite exacte pour la correction de la vraisemblance, qui ne peut matériellement fonctionner qu’avec un nombre très limité d’évènements observés simultanément, ce qui est plutôt rare avec des données à durées discrètes ou groupées, classiques dans les sciences sociales.</p>
<section id="la-vraisemblance-partielle-et-estimation-des-paramètres" class="level2">
<h2 class="anchored" data-anchor-id="la-vraisemblance-partielle-et-estimation-des-paramètres">La vraisemblance partielle et estimation des paramètres</h2>
<p>On se situe dans une situation où la durée est mesurée sur une échelle strictement continue. Il ne peut donc y avoir qu’un seul évènement observé en <span class="math inline">\(t_i\)</span> (idem si censure):</p>
<p><span class="math display">\[L_i=f(t_i)^{\delta_i}S(t_i)^{1-\delta_i}\]</span></p>
<p><br></p>
<p><strong>Vraisemblance partielle de Cox</strong></p>
<ul>
<li><span class="math inline">\(f(t_i)\)</span> est la valeur de la fonction de densité en <span class="math inline">\(t_i\)</span></li>
<li><span class="math inline">\(S(t_i)\)</span> est la valeur de la fonction de survie en <span class="math inline">\(t_i\)</span></li>
<li><span class="math inline">\(\delta_i=1\)</span> si l’évènement est observé: <span class="math inline">\(L_i=f(t_i)\)</span></li>
<li><span class="math inline">\(\delta_i=0\)</span> si l’observation est censurée: <span class="math inline">\(L_i=S(t_i)\)</span></li>
</ul>
<p><br> Comme <span class="math inline">\(f(t_i)=h(t_i)\times S(t_i)\)</span>, on obtient: <span class="math inline">\(L_i=[h(t_i)S(t_i)]^{\delta_i}S(t_i)^{1-\delta_i} = h(t_i)^{\delta_i}S(t_i)\)</span>.<br>
Pour <span class="math inline">\(i=1,2,.....,n\)</span>, la vraisemblance totale s’ecrit donc: <span class="math inline">\(L_i=\prod_{i=1}^{n}h(t_i)^{\delta_i}S(t_i)\)</span>.</p>
<p><br> On peut réécrire cette vraisemblance en la multipliant et en la divisant par: <span class="math inline">\(\sum_{j\in R_i}h(t_i)\)</span>, où <span class="math inline">\(j\in R_i\)</span> est l’ensemble des observation soumises au risque en <span class="math inline">\(t_i\)</span>.<br>
<br></p>
<p><span class="math display">\[L=\prod_{i=1}^{n}\left[h(t_i)\frac{\sum_{j\in R}h(t_i)}{\sum_{j\in R}h(t_i)}\right]^{\delta_i}S(t_i)= \prod_{i=1}^{n}\left[\frac{h(t_i)}{\sum_{j\in R_i}h(t_i)}\right]^{\delta_i}\sum_{j\in R_i}h(t_i)^{\delta_i}S(t_i)\]</span><br>
<br> La vraisemblance partielle retient seulement le premier terme de la vraisemblance, soit:</p>
<p><span class="math display">\[PL=\prod_{i=1}^{n}\left[\frac{h(t_i)}{\sum_{j\in R}h(t_i)}\right]^{\delta_i}\]</span></p>
<p>Une fois remplacée la valeur de <span class="math inline">\(h(t_i)\)</span> par son expression en tant que modèle à risques proportionnels, la vraisemblance partielle ne dépendra plus de la durée. <strong>Mais elle va dépendre de l’ordre d’arrivée des évènements, c’est à dire leur rang</strong>. <br> <em>Remarque</em>: pour les observations censurées(<span class="math inline">\(\delta_i=0\)</span>), <span class="math inline">\(PL=1\)</span>. Toutefois, ces censures à droite entrent dans l’expression <span class="math inline">\(\sum_{j\in R}h(t_i)\)</span> tant qu’elles sont soumises au risque.<br>
<br> En remplaçant donc <span class="math inline">\(h(t_i)\)</span> par l’expression <span class="math inline">\(h_0(t)e^{X_i^{'}b}\)</span>:</p>
<p><span class="math display">\[PL=\prod_{i=1}^{n}\left[\frac{h_0(t)e^{X_{i}^{'}b}}{\sum_{j\in R_i}h_0(t)e^{X_{j}^{'}b}}\right]^{\delta_i} =\prod_{i=1}^{n}\left[\frac{e^{X_i^{'}b}}{\sum_{j\in R_i}e^{X_{j}^{'}b}}\right]^{\delta_i}\]</span></p>
<p>L’expression <span class="math inline">\(\frac{e^{Xb}}{\sum_{j\in R}e^{Xb}}\)</span> est une probabilité, la vraisemblance partielle est donc bien un produit de probabilités. <strong>Il s’agit de la probabilité qu’un individu observe l’évènement en <span class="math inline">\(t_i\)</span> sachant qu’un évènement (et un seul) s’est produit</strong>.</p>
<p><br> <em>Condition nécessaire: pas d’évènement simultané</em>:<br>
On rappelle que la durée est mesuré de manière strictement continue, il ne doit pas y avoir d’évènement simultané. Sinon, l’estimation de la vraisemblance doit faire l’objet d’une correction.<br>
<br></p>
<p><em>Correction de la vraisemblance avec des évènements simultanés</em>:</p>
<ul>
<li>La <strong><em>méthode dite exacte</em></strong>: Comme il ne doit pasy avoir d’évènement simultané, on va intégrer à la vraisemblance toutes les permutations possibles des évènements observés simultanément: si en <span class="math inline">\(t_i\)</span> on observe au « même moment » l’évènement pour A et B, une échelle temporelle plus précise nous permettrait de savoir si A s’est produit avant B ou B s’est produit avant A. Comme le nombre de permutations est calculé à l’aide d’une factorielle, avec 3 évènements mesurés simultanément, il y a 6 permutations possibles (<span class="math inline">\(3\times2\times1\)</span>).<br>
Problème: le nombre de permutations pour chaque <span class="math inline">\(t_i\)</span> peut devenir très vite particulièrement élevé. Par exemple pour 10 évènements simultanés, le nombre de permutations est égal à 3.628.800. Le temps de calcul devient extrêmement long, et ce type de correction totalement inopérant.</li>
<li>La <strong><em>méthode dite de Breslow</em></strong>: il s’agit d’une approximation de la méthode exacte permettant de ne pas avoir à intégrer chaque permutation. Cette approximation est utilisée par défaut par les logiciels Sas et Stata.</li>
<li>La <strong><em>méthode dite d’Efron</em></strong>: elle corrige l’approximation de Breslow, et est jugée plus proche de la méthode exacte. C’est la méthode utilisée par défaut avec le logiciel R, et elle est disponible avec les autres applications.</li>
</ul>
</section>
<section id="estimation-des-paramètres" class="level2">
<h2 class="anchored" data-anchor-id="estimation-des-paramètres">Estimation des paramètres</h2>
<p>On utilise la méthode habituelle, à savoir la maximisation de la log-vraisemblance (ici partielle).</p>
<ul>
<li>Conditions de premier ordre: calcul des équations de score à partir des dérivées partielles. Solution: <span class="math inline">\(\frac{\partial log(PL)}{\partial{b_k}}=0\)</span>. On ne peut pas obtenir de solution numérique directe.<br>
Remarque: les équations de score sont utilisées pour tester la validité de l’hypothèse de constance des rapports de risque pour calculer les <strong>résidus de Schoenfeld</strong> (voir plus bas).</li>
<li>Conditions de second ordre: calcul des dérivées secondes qui permettent d’obtenir la matrice d’information de Fisher et la matrice des variances-covariances des paramètres.</li>
<li>Comme il n’y a pas de solution numérique directe, on utilise un algorithme d’optimisation (ex: Newton-Raphson) à partir des équations de score et de la matrice d’information de Fisher.</li>
</ul>
<p><strong>Eléments de calcul</strong><br>
<br> En logarithme (sans évènement simultané), la vraisemblance partielle s’ecrit:</p>
<p><span class="math display">\[pl(b)=\sum_{i=1}^n\delta_i\left(log(e^{X_{i}^{'}b})-log\sum_{j\in R_i}e^{X_{j}^{'}b}\right)\]</span></p>
<p><span class="math display">\[pl(b)=\sum_{i=1}^n\delta_i\left(X_{i}^{'}b-log\sum_{j\in R_i}e^{X_{j}^{'}b}\right)\]</span></p>
<p>Calcul de l’équation de score pour une covariable <span class="math inline">\(X_k\)</span>:</p>
<p><span class="math display">\[\frac{\partial pl(b)}{\partial{b_k}}=\sum_{i=1}^n\delta_i\left(X_{ik}-\sum_{j\in R_i}X_{jk}\frac{e^{X_{j}^{'}b}}{\sum_{j\in R_i}e^{X_{j}^{'}b}}\right)\]</span></p>
<p>Comme <span class="math inline">\(\frac{e^{X_{j}b}}{\sum_{j\in R}e^{X_{j}b}}\)</span> est une probabilité, et <span class="math inline">\(\sum_{j\in R}X_{ik}\times p_i\)</span> est l’espérance (la moyenne) <span class="math inline">\(E(X_k)\)</span> d’avoir la caractéristique <span class="math inline">\(X_k\)</span> lorsqu’un évènement a été observé. Au final:</p>
<p><span class="math display">\[\frac{\partial lp(b)}{\partial{b_k}}= \sum_{i=1}^n\delta_i\left(X_{ik} - E(X_{j\in R_i,k}) \right)\]</span></p>
<p>Cette expression va permettre de tester le respect ou non de l’hypothèse de risques proportionnels via les <em>résisus de Schoenfeld</em>.</p>
</section>
<section id="lecture-des-résultats" class="level2">
<h2 class="anchored" data-anchor-id="lecture-des-résultats">Lecture des résultats</h2>
<p>Comme il s’agit d’un modèle à risque proportionnel, <strong>les rapports de risques sont constants pendant toute la période d’observation</strong>. Il s’agit d’une propriété de l’estimation.<br>
<br></p>
<p><strong><em>Covariable binaire (indicatrice)</em></strong> <span class="math inline">\(X=(0,1)\)</span>: <span class="math inline">\(RR=\frac{h(t\ |\ X=1)}{h(t\ |\ X=0)}=e^b\)</span>.<br>
A chaque moment de la durée <span class="math inline">\(t\)</span>, le risque d’observer l’évènement est <span class="math inline">\(e^b\)</span> fois plus important/plus faible pour <span class="math inline">\(X=1\)</span> que pour <span class="math inline">\(X=0\)</span>.</p>
<p><br></p>
<p><strong><em>Covariable quantitative</em></strong> (mais fixe dans le temps)</p>
<p><span class="math inline">\(RR=\frac{h(t\ |\ X=a+c)}{h(t\ |\ X=a)}=e^{c \times{b}}\)</span>. On prendra pour illustrer une variable type âge au début de l’exposition au risque (a) et un delta de comparaison avec un âge inférieur c.<br>
Si <span class="math inline">\(c=1\)</span> (résultat de l’estimation): A un âge donnée en début d’exposition, le risque de connaitre l’évènement est <span class="math inline">\(e^b\)</span> fois inférieur/supérieur à celui d’une personne qui a un an de moins au début de l’exposition.</p>
<p><br></p>
<p><strong>Exemple pour les insuffisances cardiaques</strong></p>
<p><br> Estimateurs: <span class="math inline">\(b\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Cox regression <span class="sc">--</span> Efron method <span class="cf">for</span> ties</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>No. of subjects <span class="ot">=</span>          <span class="dv">103</span>                  Number of obs    <span class="ot">=</span>         <span class="dv">103</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>No. of failures <span class="ot">=</span>           <span class="dv">75</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>Time at risk    <span class="ot">=</span>        <span class="dv">31938</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                                                LR <span class="fu">chi2</span>(<span class="dv">3</span>)       <span class="ot">=</span>       <span class="fl">17.63</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>Log likelihood  <span class="ot">=</span>   <span class="sc">-</span><span class="fl">289.30639</span>                  Prob <span class="sc">&gt;</span> chi2      <span class="ot">=</span>      <span class="fl">0.0005</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>          _t <span class="sc">|</span>      Coef.   Std. Err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% Conf. Interval]</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">|</span>    <span class="sc">-</span><span class="fl">0.1196</span>     <span class="fl">0.0673</span>    <span class="sc">-</span><span class="fl">1.78</span>   <span class="fl">0.076</span>      <span class="sc">-</span><span class="fl">0.2516</span>      <span class="fl">0.0124</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>         age <span class="sc">|</span>     <span class="fl">0.0296</span>     <span class="fl">0.0135</span>     <span class="fl">2.19</span>   <span class="fl">0.029</span>       <span class="fl">0.0031</span>      <span class="fl">0.0561</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>     surgery <span class="sc">|</span>    <span class="sc">-</span><span class="fl">0.9873</span>     <span class="fl">0.4363</span>    <span class="sc">-</span><span class="fl">2.26</span>   <span class="fl">0.024</span>      <span class="sc">-</span><span class="fl">1.8424</span>     <span class="sc">-</span><span class="fl">0.1323</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rapports des risques: <span class="math inline">\(e^b\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Cox regression <span class="sc">--</span> Efron method <span class="cf">for</span> ties</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>No. of subjects <span class="ot">=</span>          <span class="dv">103</span>                  Number of obs    <span class="ot">=</span>         <span class="dv">103</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>No. of failures <span class="ot">=</span>           <span class="dv">75</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>Time at risk    <span class="ot">=</span>        <span class="dv">31938</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                                                LR <span class="fu">chi2</span>(<span class="dv">3</span>)       <span class="ot">=</span>       <span class="fl">17.63</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>Log likelihood  <span class="ot">=</span>   <span class="sc">-</span><span class="fl">289.30639</span>                  Prob <span class="sc">&gt;</span> chi2      <span class="ot">=</span>      <span class="fl">0.0005</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>          _t <span class="sc">|</span> Haz. Ratio   Std. Err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% Conf. Interval]</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">|</span>     <span class="fl">0.8872</span>     <span class="fl">0.0597</span>    <span class="sc">-</span><span class="fl">1.78</span>   <span class="fl">0.076</span>       <span class="fl">0.7775</span>      <span class="fl">1.0124</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>         age <span class="sc">|</span>     <span class="fl">1.0300</span>     <span class="fl">0.0139</span>     <span class="fl">2.19</span>   <span class="fl">0.029</span>       <span class="fl">1.0031</span>      <span class="fl">1.0577</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>     surgery <span class="sc">|</span>     <span class="fl">0.3726</span>     <span class="fl">0.1625</span>    <span class="sc">-</span><span class="fl">2.26</span>   <span class="fl">0.024</span>       <span class="fl">0.1584</span>      <span class="fl">0.8761</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On retrouve les résultats des tests non paramétriques pour l’opération, à savoir qu’un pontage réduit les risques journaliers de décès pendant la période d’observation (augmente la durée de survie).<br>
De la même manière, plus on entre à un âge élevé dans la liste d’attente plus le risque de décès augmente. La variable <em>year</em>, qui traduit des progrès en médecine, exprime une réduction relativement modérée du risque journalier de décès durant l’attente de la greffe du coeur.</p>
</section>
<section id="r-stata-sas-python" class="level2">
<h2 class="anchored" data-anchor-id="r-stata-sas-python">R-Stata-Sas-Python</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Stata</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">SAS</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Le modèle est estimé avec la fonction <strong><code>coxph</code></strong> de la librairie <strong><code>survival</code></strong>. Hors options, la syntaxe est identiques aux fonctions <code>survfit</code> et <code>survdif</code>.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Le modèle est estimé avec la commande <strong><code>stcox</code></strong>.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Le modèle est estimé avec la <strong><code>proc phreg</code></strong>.</p>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>Avec la librairie <code>lifelines</code>, le modèle est estimé avec la fonction <strong><code>CoxPHFitter</code></strong>. Avec la librairie <code>statmodels</code>, il est estimé avec la fonction <code>smf.phreg</code>.</p>
</div>
</div>
</div>
</section>
</section>
<section id="lhypothèse-de-constance-des-rapports-de-risque" class="level1">
<h1>L’hypothèse de constance des rapports de risque</h1>
<ul>
<li>Les rapports de risque (RR) estimés par le modèle sont contraints à être constant pendant toute la période d’observation. C’est une hypothèse forte.</li>
<li>Le respect de cette hypothèse doit être testé, en particulier pour un modèle de Cox où la baseline du risque est habituellement estimée à l’aide de ces rapports (méthode dite de Breslow, non traitée…mais bientôt en annexe). En post-estimation, les valeurs estimées du risque pourront présenter des valeurs aberrantes, en particulier négatives.</li>
<li>Tester cette hypothèse revient à tester une interaction entre les rapports et la durée (ou plutôt une fonction de la durée).</li>
<li>Plusieurs méthodes disponibles, celle sur les résidus de martingales, réservée aux covariables continues, et le « test » graphique réservé aux variables catégorielles ne seront pas traités. On traitera celle basée sur les <strong>résidus de Schoenfeld</strong> puis l’introduction d’une intéraction avec la durée dans le modèle. Cette dernière peut faire également office de méthode de correction lorsque l’hypothèse n’est pas respectée.<br>
</li>
<li>Si on regarde les courbes de Kaplan-Meier, leurs croisement non tardif impliquera nécessairement un problème sur cette hypothèse.</li>
</ul>
<section id="tests-sur-les-résidus-de-schoenfeld" class="level2">
<h2 class="anchored" data-anchor-id="tests-sur-les-résidus-de-schoenfeld">Tests sur les résidus de Schoenfeld</h2>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Résumé rapide: le test consiste à regarder la corrélation entre des résidus obtenus directement avec la fonction de score de la vraisemblanc partielle de Cox.</p>
<ul>
<li><strong><em>Test simplifié</em></strong>: simple corrélation obtenu par une régression linéaire par les moindres carrés ordinaires. Pour chaque covariable, la standardisation du résidu utilise la variance de l’estimateur obtenu par le modèle. Une rapide présentation est disponible <a href="https://mthevenin.github.io/analyse_duree/annexes/residusch.html">ici</a></li>
<li><strong><em>Test exact</em></strong>: corrélation obtenu par une régression linéaire par les moindres carrés généralisés. Pour chaque covariable, on calcule la variance et on utilise la variance exacte du résidu à partir de la dérivée de la fonction score (matrice d’information de fisher sur sa diagonale). Les moindres carrés généralisés corrigeront la présence d’autocorrélations des résidus, classique avec des données temporelles.</li>
</ul>
<p>A ce jour le test exact est implémenté seulement dans la v3 du package <code>survival</code> de R. Un problème de reproductibilité se pose, dans l’espace des applications et dans le temps pour R, le test simplifié n’étant plus disponible à son installation (je donne un moyen de l’exécuter tout de même).<br>
Je m’interroge par ailleurs sur la sensibilité de la version exacte en présence de durées discrètes ou groupées.</p>
</div>
</div>
<ul>
<li>Les résidus « bruts » sont directement calculés à partir des équations de scores (voir section estimation).</li>
<li>Ce résidu n’est calculé que pour les observations qui ont connues l’évènement.</li>
<li>Il est calculé au moment où l’évènement s’est produit.</li>
<li>La somme des résidus pour chaque covariable est égale à 0 (propriété de l’équation de score à l’équilibre).</li>
<li>On utilise généralement les résidus de Schoenfeld « standardisés » ou plutôt “remis à l’échelle” - par leur variance -.</li>
<li>Pour une observation dont l’évènement s’est produit en <span class="math inline">\(t_i\)</span>, le <em>résidu brut de Schoenfeld</em> pour la covariable <span class="math inline">\(X_k\)</span>, après estimation du modèle, est égal à:</li>
</ul>
<p><span class="math display">\[rs_{ik}=X_{ik}- \sum_{j\in R_i}X_{jk}\frac{e^{X_{j}^{'}b}}{\sum_{j\in R_i}e^{X_{j}^{'}b}}= X_{ik} - E(X_{j\in R_i})\]</span></p>
<ul>
<li><p>Ce résidu est formellement la contribution d’une observation ou d’un moment d’évènement au score. Il se lit comme la différence entre la valeur observée d’une covariable et sa valeur espérée au moment où un évènement se produit.</p></li>
<li><p>Si l’hypothèse de constance des risk ratios est respectée, les résidus ne doivent pas suivre une tendance précise, , en particulier à la hausse ou à la baisse.</p></li>
<li><p>Intuitivement sans censure à droite et en ne considérant que les résidus bruts: on a un RR strictement égal à 1 en début d’exposition <span class="math inline">\(R_i=100\)</span> avec 50 hommes et 50 femmes. Si l’hypothèse PH (strictement) respectée, lorsqu’il reste 90 personnes soumises au risque, on devrait avoir 45 hommes et 45 femmes. Avec <span class="math inline">\(R_i=50\)</span>, 25 hommes et 25 femmes,…….avec <span class="math inline">\(R_i=10\)</span>, 5 hommes et 5 femmes. Au final l’espérance d’avoir la caractéristique <span class="math inline">\(X\)</span> est toujours égal à 0.5 et les résidus bruts prendront toujours la valeur -.5 si <span class="math inline">\(X=0\)</span> et .5 si <span class="math inline">\(X=1\)</span>. En faisant une simple régression linéaire entre les résidus, qui alternent ces deux valeurs, et <span class="math inline">\(t\)</span>, le coefficient estimé sera non significativement différent de 0.</p></li>
<li><p>On peut tester l’hypothèse sur les résidus par une régression entre ces résidus pour chaque covariable et la durée (ou fonction dérivée de la durée, par exemple <span class="math inline">\(t\)</span> ou <span class="math inline">\(log(t)\)</span>)). Cette solution prend forme avec le test de <strong>Grambsch-Therneau</strong> sous sa forme simplifiée -OLS- (R jusqu’à v3 de <code>survival</code>, Sas, Stata, Python) ou exacte - GLS- (R depuis la V3).</p></li>
</ul>
<p>On trouvera des éléments de calcul du test simplifié <a href="https://mthevenin.github.io/analyse_duree/annexes/residusch.html">ici</a></p>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
<strong>Résultats identiques entre SAS - STATA - SURVIVAL V2 (R) - Lifelines/statmodels (Python)</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Avec <span class="math inline">\(g(t)=t\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>      Test of proportional<span class="sc">-</span>hazards assumption</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>      Time<span class="sc">:</span>  Time</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>      <span class="sc">----------------------------------------------------------------</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                  <span class="er">|</span>       rho            chi2       df       Prob<span class="sc">&gt;</span>chi2</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>      <span class="sc">------------+---------------------------------------------------</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>      year        <span class="sc">|</span>      <span class="fl">0.10162</span>         <span class="fl">0.80</span>        <span class="dv">1</span>         <span class="fl">0.3720</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>      age         <span class="sc">|</span>      <span class="fl">0.12937</span>         <span class="fl">1.61</span>        <span class="dv">1</span>         <span class="fl">0.2043</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>      surgery     <span class="sc">|</span>      <span class="fl">0.29664</span>         <span class="fl">5.54</span>        <span class="dv">1</span>         <span class="fl">0.0186</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>      <span class="sc">------------+---------------------------------------------------</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>      global test <span class="sc">|</span>                      <span class="fl">8.76</span>        <span class="dv">3</span>         <span class="fl">0.0327</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>      <span class="sc">----------------------------------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Ici l’hypothèse de proportionnalité des risques est questionnable pour la variable <em>surgery</em>. Le risque ratio pourrait ne pas constant dans le temps. Ce n’est pas peut-être pas étonnant, le premier décès pour les personnes opérées d’un pontage n’est observé qu’au bout de 165 jours.</p>
<p><strong>Remarques / à savoir</strong></p>
<ul>
<li><p><strong>Test multiple</strong>: de nouveau il convient de se méfier du résultat du test multiple. Le risque de premier espèce peut-être assez faible alors que les tests pour chaque covariables prises une à une présenteraient des valeurs élevées (&gt;.1 par exemple).<br>
Le résultat de ce test est considéré par certain.e.s comme un indicateur de l’ampleur du biais qui affecte la baseline du risque.<br>
Le résultat de ce test multiple est considéré par certain.e.s comme un indicateur de l’ampleur du biais qui affecte la baseline du risque.</p></li>
<li><p><strong>Transformations de la durée</strong>: n’importe quelle fonction de la durée peut être utilisée pour réaliser le test. On retient généralement les fonctions suivantes: <span class="math inline">\(g(t)=t\)</span> (« identity »), <span class="math inline">\(g(t)=log(t)\)</span>, <span class="math inline">\(g(t)=KM(t)\)</span> ou <span class="math inline">\(g(t)=1- KM(t\)</span>) où <span class="math inline">\(KM(t\)</span>) est l’estimateur de Kaplan-Meier. Enfin une transformation appelée « rank », est utilisée seulement pour les durées strictement continue ou suffisamment dispersées . Par exemple <span class="math inline">\(t=(0.1,0.5,1,2.6,3)\)</span> donne une transformation <span class="math inline">\(t=(1,2,3,4)\)</span>. A savoir : la fonction « identity », utilisée ici, rend le test relativement sensible aux évènements tardifs lorsque la population restant soumise est peu nombreuse (outliers).</p></li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Stata</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">SAS</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p><strong><em>Attention version exacte du test depuis le v3 de survival</em></strong>.</p>
<ul>
<li>Après avoir créer un objet à l’estimation du modèle de Cox, on utilise la fonction <strong><code>cox.zph</code></strong>. Cette fonction utilise par défaut <span class="math inline">\(g(t)=1-KM(t)\)</span> où <span class="math inline">\(KM(t)\)</span> sont les estimateurs de la courbe de Kaplan-Meier. On peut modifier cette fonction. Il est préférable de conserver cette fonction par défaut.</li>
<li>Test antérieur: j’ai récupéré le programme du test antérieur, renommé <strong><code>cox.zphold</code></strong>. On peut le charger simplement, et il est facilement exécutable.</li>
</ul>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Le test est obtenu avec la commande <strong><code>estat phtest, d</code></strong>. Par défaut Stata utilise <span class="math inline">\(g(t)=t\)</span>. On peut modifier cette fonction.</p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Le test est disponible depuis quelques années avec l’argument <strong><code>zph</code></strong> sur la ligne <code>proc lifetest</code>. Par défaut SAS utilise <span class="math inline">\(g(t)=t\)</span>. On peut modifier cette fonction.</p>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>On utilise la fonction <strong><code>proportional_hazard_test</code></strong> de la librairie <code>lifelines</code>. La fonction utilise par défaut <span class="math inline">\(g(t)=t\)</span>, mais on peut afficher les résultats pour toutes les transformations de <span class="math inline">\(t\)</span> disponibles avec l’option <code>time_transform=’all’</code>.</p>
</div>
</div>
</div>
</section>
<section id="intéraction-avec-la-durée" class="level2">
<h2 class="anchored" data-anchor-id="intéraction-avec-la-durée">Intéraction avec la durée</h2>
<p><br></p>
<p>Petit retour sur l’estimation du modèle.</p>
<p>Pour estimer le modèle de Cox, les données sont dans un premier temps splitées aux temps d’évènement. A l’exception de <em>Sas</em>, les autres logiciels disposent d’une fonction qui effectue cette opération (<em>R</em>: <code>survsplit</code> - <em>Stata</em>: <code>stsplit</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+------------------------------+</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>      <span class="er">|</span> id   surgery    d    t    t0 <span class="sc">|</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>      <span class="er">|</span><span class="sc">------------------------------</span><span class="er">|</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fl">24.</span> <span class="sc">|</span>  <span class="dv">2</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">1</span>     <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fl">25.</span> <span class="sc">|</span>  <span class="dv">2</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">2</span>     <span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.</span> <span class="sc">|</span>  <span class="dv">2</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">3</span>     <span class="dv">2</span> <span class="sc">|</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fl">27.</span> <span class="sc">|</span>  <span class="dv">2</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">5</span>     <span class="dv">3</span> <span class="sc">|</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">28.</span> <span class="sc">|</span>  <span class="dv">2</span>         <span class="dv">0</span>    <span class="dv">1</span>    <span class="dv">6</span>     <span class="dv">5</span> <span class="sc">|</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>      <span class="er">|</span><span class="sc">------------------------------</span><span class="er">|</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fl">29.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">1</span>     <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fl">30.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">2</span>     <span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fl">31.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">3</span>     <span class="dv">2</span> <span class="sc">|</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fl">32.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">5</span>     <span class="dv">3</span> <span class="sc">|</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fl">33.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">6</span>     <span class="dv">5</span> <span class="sc">|</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>      <span class="er">|</span><span class="sc">------------------------------</span><span class="er">|</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fl">34.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">8</span>     <span class="dv">6</span> <span class="sc">|</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fl">35.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">9</span>     <span class="dv">8</span> <span class="sc">|</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fl">36.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">0</span>   <span class="dv">12</span>     <span class="dv">9</span> <span class="sc">|</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fl">37.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">1</span>   <span class="dv">16</span>    <span class="dv">12</span> <span class="sc">|</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+------------------------------+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Les bornes des intervalles <span class="math inline">\([t_0 ;t]\)</span> ont des valeurs seulement lorsqu’un évènement s’est produit (principe de la vraisemblance partielle). Il n’y a donc pas de valeurs pour <span class="math inline">\(t\)</span> et <span class="math inline">\(t_0\)</span> en <span class="math inline">\(t=4\)</span> (<span class="math inline">\(id=2,3\)</span>), <span class="math inline">\(t=7,10,11,13,14,15\)</span> (<span class="math inline">\(id=3\)</span>).<br>
Les deux individus observent l’évènement en <span class="math inline">\(t=6\)</span> pour <span class="math inline">\(id=2\)</span>, et en <span class="math inline">\(t=16\)</span> pour <span class="math inline">\(id=3\)</span>. Avant ce moment la valeur de la variable évènement/censure (ici <span class="math inline">\(d\)</span>) prend toujours la valeur 0, et prend la valeur 1 le jour du décès.</p>
<p>On vérifie que les paramètres estimés sont identiques</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Cox regression with Efron method <span class="cf">for</span> ties</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>No. of subjects <span class="ot">=</span>    <span class="dv">103</span>                                Number of obs <span class="ot">=</span>  <span class="dv">3</span>,<span class="dv">573</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>No. of failures <span class="ot">=</span>     <span class="dv">75</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>Time at risk    <span class="ot">=</span> <span class="dv">31</span>,<span class="dv">938</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                                        LR <span class="fu">chi2</span>(<span class="dv">3</span>)    <span class="ot">=</span>  <span class="fl">17.63</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>Log likelihood <span class="ot">=</span> <span class="sc">-</span><span class="fl">289.30639</span>                             Prob <span class="sc">&gt;</span> chi2   <span class="ot">=</span> <span class="fl">0.0005</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>          _t <span class="sc">|</span> Haz. ratio   Std. err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% conf. interval]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">|</span>      <span class="fl">0.887</span>      <span class="fl">0.060</span>    <span class="sc">-</span><span class="fl">1.78</span>   <span class="fl">0.076</span>        <span class="fl">0.778</span>       <span class="fl">1.012</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>         age <span class="sc">|</span>      <span class="fl">1.030</span>      <span class="fl">0.014</span>     <span class="fl">2.19</span>   <span class="fl">0.029</span>        <span class="fl">1.003</span>       <span class="fl">1.058</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>     surgery <span class="sc">|</span>      <span class="fl">0.373</span>      <span class="fl">0.163</span>    <span class="sc">-</span><span class="fl">2.26</span>   <span class="fl">0.024</span>        <span class="fl">0.158</span>       <span class="fl">0.876</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Introduction d’une intéraction avec une fonction de la durée</em></p>
<p>On a une variable de durée (on prendra <span class="math inline">\(g(t)=t\)</span>) qui sera croisée avec la variable <em>surgery</em>. Le modèle va s’écrire:</p>
<p><span class="math display">\[h(t | X,t) = h_0(t)e^{b_1age + b_2year + b_3 surgery + b_4 (surgery\times t)}\]</span></p>
<p><strong>Exemple</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Cox regression with Efron method <span class="cf">for</span> ties</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>No. of subjects <span class="ot">=</span>    <span class="dv">103</span>                                Number of obs <span class="ot">=</span>    <span class="dv">103</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>No. of failures <span class="ot">=</span>     <span class="dv">75</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>Time at risk    <span class="ot">=</span> <span class="dv">31</span>,<span class="dv">938</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                                                        LR <span class="fu">chi2</span>(<span class="dv">4</span>)    <span class="ot">=</span>  <span class="fl">21.58</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>Log likelihood <span class="ot">=</span> <span class="sc">-</span><span class="fl">287.32903</span>                             Prob <span class="sc">&gt;</span> chi2   <span class="ot">=</span> <span class="fl">0.0002</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>          _t <span class="sc">|</span> Haz. ratio   Std. err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% conf. interval]</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>main         <span class="sc">|</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">|</span>      <span class="fl">0.884</span>      <span class="fl">0.059</span>    <span class="sc">-</span><span class="fl">1.84</span>   <span class="fl">0.066</span>        <span class="fl">0.776</span>       <span class="fl">1.008</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>         age <span class="sc">|</span>      <span class="fl">1.029</span>      <span class="fl">0.014</span>     <span class="fl">2.15</span>   <span class="fl">0.032</span>        <span class="fl">1.003</span>       <span class="fl">1.057</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="fu">surgery</span>(t0<span class="sc">+</span>) <span class="sc">|</span>      <span class="fl">0.173</span>      <span class="fl">0.117</span>    <span class="sc">-</span><span class="fl">2.60</span>   <span class="fl">0.009</span>        <span class="fl">0.046</span>       <span class="fl">0.649</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>Rapport de HR<span class="sc">|</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>   surgery<span class="sc">*</span>t <span class="sc">|</span>      <span class="fl">1.002</span>      <span class="fl">0.001</span>     <span class="fl">2.02</span>   <span class="fl">0.043</span>        <span class="fl">1.000</span>       <span class="fl">1.004</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On retrouve donc un résultat proche de celui obtenu à partir du test simplifié sur les résidus de Schoenfeld pour la variable <em>surgery</em> (et c’est normal). Avec <span class="math inline">\(g(t)=t\)</span>, il a le mérite de pouvoir être interprété directement. Ce qui ne veut pas dire qu’il s’agit de la meilleure solution.<br>
Donc, malgré une hypothèse plutôt forte sur la forme fonctionnelle de l’intéraction, et dans les fait surement pas pertinente, on peut dire que chaque jour le HR entre personnes opérées et personnes non opérées augmente de 0.2%. L’effet de l’opération sur la survie des individus s’estompe donc avec le temps.</p>
<p><strong>Important</strong>:</p>
<ul>
<li>Le modèle n’est plus un modèle à risque proportionnel. La variable <em>surgery</em> n’est plus une variable <strong>fixe</strong> mais une variable tronquée dynamique qui prend la valeur de <span class="math inline">\(t\)</span> pour les personnes qui ont été opérées d’un pontage avant leur entrée dans le registre de greffe.</li>
<li>L’altération des rapports de risque dépend de la forme fonctionnelle de l’intéraction choisie. Ici la modification dans le temps du rapport des risque est constante, ce qui est une hypothèse assez forte. On a, en quelques sorte, réintroduit une hypothèse de proportionnalité, ici sur le degré d’altération des écarts de risques dans le temps, qui devient lui même constant.</li>
</ul>
</section>
<section id="que-faire" class="level2">
<h2 class="anchored" data-anchor-id="que-faire">Que faire</h2>
<p><strong><em>Ne rien faire</em></strong></p>
<p>On interprète le risque ratio comme un ratio moyen pendant la durée d’observation (P.Allison). Difficilement soutenable pour l’analyse des effets cliniques, elle peut être envisagée dans d’autres domaines. Attention au nombre de variables qui ne respecte pas l’hypothèse, l’estimation de la baseline du risque pourrait être sensiblement affectée. Il convient tout de même lors de l’interprétation, de préciser les variables qui seront analysées sous cette forme « moyenne » sur la période d’observation.<br>
On peut également adapter cette stratégie du « ne rien faire » selon sens de l’altération des rapports de risque. Si aux cours du temps des différences de risque, déjà assez important en début d’observation s’accentuent, à la hausse comme à la baisse, on peut conserver cet estimateur moyen. Mais si l’effet est modéré : <span class="math inline">\(RR&gt;1\)</span> qui baisse ou <span class="math inline">\(RR&lt;1\)</span> qui augmente au cours du temps, je suis moins convaincu de la pertinence de cette option.<br>
Il faut tenir compte de l’intérêt portée par les variables qui présentent un problème par rapport à l’hypothèse. Il n’est peut-être pas nécessaire de complexifier le modèle pour des variables introduites comme simples contrôles.<br>
Mais plus problématique… On sait qu’une des causes du non respect de l’hypothèse peut provenir d’effets de sélection liées à des variables omises ou non observables. En analyse de durée ce problème prend le nom de <strong><em>frailty</em></strong> (fragilité) lorsque cette non homogénéité n’est pas observables. Des estimations, plus complexes, sont possibles dans ce cas, et sont en mesure malgré leur interprétation plutôt difficile de régler le problème. Si l’hypothèse est sensible aux problèmes d’omission, il convient donc de bien spécifier le modèle au niveau des variables de contrôle observables et disponibles.</p>
<p>Mais plus problématique [<strong>très important</strong>]… On sait qu’une des causes du non respect de l’hypothèse peut provenir d’effets de sélection liées à des variables omises ou non observables. En analyse de durée ce problème prend le nom de <strong><em>frailty</em></strong> (fragilité) lorsque cette non homogénéité n’est pas observable. Des estimations, plus complexes, sont possibles dans ce cas, et sont en mesure malgré leur interprétation plutôt difficile de régler le problème. Si l’hypothèse est sensible aux biais d’omission, il convient donc de bien spécifier le modèle au niveau des variables de contrôle observables et disponibles.<br>
Le test de <strong>Grambsch-Therneau</strong> peut-être également appréhendé comme un test qui donne un élément d’information sur de possibles biais d’omission (endogénéité)dans le modèle.</p>
<p><br></p>
<p><strong><em>Modèle de Cox stratifié</em></strong></p>
<p>Utiliser la méthode dite de « Cox stratifiée » (non traitée). Utile si l’objectif est de présenter des fonctions de survie prédites ajustées, et si une seule covariable (binaire) présente un problème. Les RR ne seront pas estimés pour la variable qui ne respecte pas l’hypothèse.<br>
[<em>Je pense faire un courté entrée dessuis dans la section annexe en 2023</em>].</p>
<p><strong><em>Intéraction</em></strong></p>
<p>Introduire une interaction avec la durée, ce qui a été fait juste haut dessus. Cela peut permettre d’enrichir le modèle au niveau de l’interprétation. Valable si peu de covariables présentent des problèmes de stabilité des rapports de risque, dans l’idéal une seule variable. Attention tout de même à la forme de la fonction, dans l’exemple on a contraint l’effet d’interaction à être strictement linéaire, ce qui est une hypothèse plutôt forte…. on introduit de nouveau une contrainte de proportionalité dans le modèle.</p>
<p><strong><em>Modèles alternatifs</em></strong></p>
<p>Utiliser un modèle alternatif: modèles paramétriques à risques proportionnels si la distribution du risque s’ajuste bien, le modèle paramétrique « flexible » de Parmar-Royston (<strong><em>ajout prévu pour 2023</em></strong>) ou un modèle à temps discret. Pour la dernière solution, on peut également corriger la non proportionalité avec l’introduction d’une intéraction. Si on ne le fait pas, les risques prédits, par définition sous forme de probabilités conditionnelles, resteront toujours dans les bornes contrairement au modèle de Cox.<br>
Utiliser un modèle non paramétrique additif dit d’Aalen ou une de ses variantes (non traité). Mais ces modèles, dont les résultats sont présentés par des graphiques, se commentent assez difficilement.</p>
<p><strong>Forêt aléatoire</strong><br>
Autre méthode : les forêts aléatoires [<em>à présenter un jour tout de même</em>]. L.Breiman a dès le départ proposé une estimation des modèles de survie par cette méthode. Par définition, pas sensible à l’hypothèse PH. Mais cela reste des méthodes à finalité prédictive, moins riche en interprétation.</p>
<p><br><br></p>
</section>
</section>
<section id="cox-et-modèle-de-poisson" class="level1">
<h1>Cox et modèle de poisson</h1>
<p>Juste une courte remarque.</p>
<p>Le modèle a été estimé par la méthode de la vraisemblance partielle. On peut montrer que le modèle de Cox est estimable à partir d’un simple modèle de Poisson. Cette estimation est appelée «<strong><em>Constant Piecewise Exponential PH model</em></strong>».</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Poisson regression                              Number of obs     <span class="ot">=</span>      <span class="dv">3</span>,<span class="dv">573</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                                                LR <span class="fu">chi2</span>(<span class="dv">90</span>)       <span class="ot">=</span>     <span class="fl">122.42</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                                                Prob <span class="sc">&gt;</span> chi2       <span class="ot">=</span>     <span class="fl">0.0131</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>Log likelihood <span class="ot">=</span> <span class="sc">-</span><span class="fl">344.95318</span>                     Pseudo R2         <span class="ot">=</span>     <span class="fl">0.1507</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>          _d <span class="sc">|</span>      Coef.   Std. Err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% Conf. Interval]</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">1195204</span>    .<span class="dv">067374</span>    <span class="sc">-</span><span class="fl">1.77</span>   <span class="fl">0.076</span>     <span class="sc">-</span>.<span class="dv">251571</span>    .<span class="dv">0125302</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>         age <span class="sc">|</span>   .<span class="dv">0295531</span>    .<span class="dv">013535</span>     <span class="fl">2.18</span>   <span class="fl">0.029</span>      .<span class="dv">003025</span>    .<span class="dv">0560811</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>     surgery <span class="sc">|</span>    <span class="sc">-</span>.<span class="dv">98486</span>   .<span class="dv">4363162</span>    <span class="sc">-</span><span class="fl">2.26</span>   <span class="fl">0.024</span>    <span class="sc">-</span><span class="fl">1.840024</span>   <span class="sc">-</span>.<span class="dv">1296961</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>             <span class="sc">|</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>       stime <span class="sc">|</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>          <span class="dv">2</span>  <span class="sc">|</span>   .<span class="dv">4223592</span>   <span class="fl">1.154708</span>     <span class="fl">0.37</span>   <span class="fl">0.715</span>    <span class="sc">-</span><span class="fl">1.840826</span>    <span class="fl">2.685544</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>          <span class="dv">3</span>  <span class="sc">|</span>   .<span class="dv">0495983</span>   <span class="fl">1.154704</span>     <span class="fl">0.04</span>   <span class="fl">0.966</span>     <span class="sc">-</span><span class="fl">2.21358</span>    <span class="fl">2.312776</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>          <span class="dv">5</span>  <span class="sc">|</span>   <span class="sc">-</span>.<span class="dv">828855</span>   <span class="fl">1.224781</span>    <span class="sc">-</span><span class="fl">0.68</span>   <span class="fl">0.499</span>    <span class="sc">-</span><span class="fl">3.229383</span>    <span class="fl">1.571673</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>          <span class="dv">6</span>  <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">9922643</span>   <span class="fl">1.224779</span>    <span class="sc">-</span><span class="fl">0.81</span>   <span class="fl">0.418</span>    <span class="sc">-</span><span class="fl">3.392786</span>    <span class="fl">1.408258</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>          <span class="dv">8</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">1.940546</span>   <span class="fl">1.414215</span>    <span class="sc">-</span><span class="fl">1.37</span>   <span class="fl">0.170</span>    <span class="sc">-</span><span class="fl">4.712356</span>    .<span class="dv">8312648</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>          <span class="dv">9</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">2.03868</span>   <span class="fl">1.414233</span>    <span class="sc">-</span><span class="fl">1.44</span>   <span class="fl">0.149</span>    <span class="sc">-</span><span class="fl">4.810526</span>    .<span class="dv">7331649</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>         <span class="dv">11</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">12.59255</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.995</span>     <span class="sc">-</span><span class="fl">4285.23</span>    <span class="fl">4260.045</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>         <span class="dv">12</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">2.30438</span>   <span class="fl">1.414226</span>    <span class="sc">-</span><span class="fl">1.63</span>   <span class="fl">0.103</span>    <span class="sc">-</span><span class="fl">5.076213</span>    .<span class="dv">4674526</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>         <span class="dv">16</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">1.481512</span>   <span class="fl">1.154713</span>    <span class="sc">-</span><span class="fl">1.28</span>   <span class="fl">0.199</span>    <span class="sc">-</span><span class="fl">3.744708</span>    .<span class="dv">7816839</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>         <span class="dv">17</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">2.591968</span>    <span class="fl">1.41426</span>    <span class="sc">-</span><span class="fl">1.83</span>   <span class="fl">0.067</span>    <span class="sc">-</span><span class="fl">5.363868</span>    .<span class="dv">1799312</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>         <span class="dv">18</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">2.642535</span>   <span class="fl">1.414254</span>    <span class="sc">-</span><span class="fl">1.87</span>   <span class="fl">0.062</span>    <span class="sc">-</span><span class="fl">5.414421</span>    .<span class="dv">1293516</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>         <span class="dv">21</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">2.095489</span>   <span class="fl">1.224819</span>    <span class="sc">-</span><span class="fl">1.71</span>   <span class="fl">0.087</span>    <span class="sc">-</span><span class="fl">4.496091</span>    .<span class="dv">3051133</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>         <span class="dv">28</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.055745</span>   <span class="fl">1.414246</span>    <span class="sc">-</span><span class="fl">2.16</span>   <span class="fl">0.031</span>    <span class="sc">-</span><span class="fl">5.827616</span>   <span class="sc">-</span>.<span class="dv">2838729</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>         <span class="dv">30</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.103495</span>    <span class="fl">1.41426</span>    <span class="sc">-</span><span class="fl">2.19</span>   <span class="fl">0.028</span>    <span class="sc">-</span><span class="fl">5.875395</span>   <span class="sc">-</span>.<span class="dv">3315961</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>         <span class="dv">31</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">13.89462</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.995</span>    <span class="sc">-</span><span class="fl">4286.532</span>    <span class="fl">4258.743</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>         <span class="dv">32</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.144133</span>   <span class="fl">1.414253</span>    <span class="sc">-</span><span class="fl">2.22</span>   <span class="fl">0.026</span>    <span class="sc">-</span><span class="fl">5.916018</span>   <span class="sc">-</span>.<span class="dv">3722474</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>         <span class="dv">35</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.219157</span>   <span class="fl">1.414258</span>    <span class="sc">-</span><span class="fl">2.28</span>   <span class="fl">0.023</span>    <span class="sc">-</span><span class="fl">5.991053</span>    <span class="sc">-</span>.<span class="dv">447262</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>         <span class="dv">36</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.227893</span>   <span class="fl">1.414267</span>    <span class="sc">-</span><span class="fl">2.28</span>   <span class="fl">0.022</span>    <span class="sc">-</span><span class="fl">5.999806</span>   <span class="sc">-</span>.<span class="dv">4559796</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>         <span class="dv">37</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.246139</span>   <span class="fl">1.414263</span>    <span class="sc">-</span><span class="fl">2.30</span>   <span class="fl">0.022</span>    <span class="sc">-</span><span class="fl">6.018042</span>   <span class="sc">-</span>.<span class="dv">4742351</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>         <span class="dv">39</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">3.26923</span>   <span class="fl">1.414303</span>    <span class="sc">-</span><span class="fl">2.31</span>   <span class="fl">0.021</span>    <span class="sc">-</span><span class="fl">6.041213</span>   <span class="sc">-</span>.<span class="dv">4972472</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>         <span class="dv">40</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">2.581465</span>   <span class="fl">1.224839</span>    <span class="sc">-</span><span class="fl">2.11</span>   <span class="fl">0.035</span>    <span class="sc">-</span><span class="fl">4.982106</span>   <span class="sc">-</span>.<span class="dv">1808239</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>         <span class="dv">43</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.311454</span>   <span class="fl">1.414341</span>    <span class="sc">-</span><span class="fl">2.34</span>   <span class="fl">0.019</span>    <span class="sc">-</span><span class="fl">6.083512</span>   <span class="sc">-</span>.<span class="dv">5393966</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>         <span class="dv">45</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.327473</span>   <span class="fl">1.414407</span>    <span class="sc">-</span><span class="fl">2.35</span>   <span class="fl">0.019</span>    <span class="sc">-</span><span class="fl">6.099661</span>   <span class="sc">-</span>.<span class="dv">5552857</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>         <span class="dv">50</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.421206</span>   <span class="fl">1.414399</span>    <span class="sc">-</span><span class="fl">2.42</span>   <span class="fl">0.016</span>    <span class="sc">-</span><span class="fl">6.193377</span>   <span class="sc">-</span>.<span class="dv">6490357</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>         <span class="dv">51</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.425081</span>   <span class="fl">1.414444</span>    <span class="sc">-</span><span class="fl">2.42</span>   <span class="fl">0.015</span>    <span class="sc">-</span><span class="fl">6.197341</span>   <span class="sc">-</span>.<span class="dv">6528208</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>         <span class="dv">53</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">3.44536</span>   <span class="fl">1.414475</span>    <span class="sc">-</span><span class="fl">2.44</span>   <span class="fl">0.015</span>     <span class="sc">-</span><span class="fl">6.21768</span>    <span class="sc">-</span>.<span class="dv">673039</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>         <span class="dv">58</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.514664</span>   <span class="fl">1.414489</span>    <span class="sc">-</span><span class="fl">2.48</span>   <span class="fl">0.013</span>    <span class="sc">-</span><span class="fl">6.287011</span>   <span class="sc">-</span>.<span class="dv">7423175</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>         <span class="dv">61</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.543748</span>   <span class="fl">1.414557</span>    <span class="sc">-</span><span class="fl">2.51</span>   <span class="fl">0.012</span>    <span class="sc">-</span><span class="fl">6.316229</span>   <span class="sc">-</span>.<span class="dv">7712681</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>         <span class="dv">66</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.602062</span>   <span class="fl">1.414546</span>    <span class="sc">-</span><span class="fl">2.55</span>   <span class="fl">0.011</span>    <span class="sc">-</span><span class="fl">6.374522</span>   <span class="sc">-</span>.<span class="dv">8296028</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>         <span class="dv">68</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">2.90779</span>   <span class="fl">1.225106</span>    <span class="sc">-</span><span class="fl">2.37</span>   <span class="fl">0.018</span>    <span class="sc">-</span><span class="fl">5.308954</span>   <span class="sc">-</span>.<span class="dv">5066257</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>         <span class="dv">69</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.580111</span>   <span class="fl">1.414549</span>    <span class="sc">-</span><span class="fl">2.53</span>   <span class="fl">0.011</span>    <span class="sc">-</span><span class="fl">6.352577</span>   <span class="sc">-</span>.<span class="dv">8076461</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>         <span class="dv">72</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">2.914206</span>    <span class="fl">1.22505</span>    <span class="sc">-</span><span class="fl">2.38</span>   <span class="fl">0.017</span>     <span class="sc">-</span><span class="fl">5.31526</span>   <span class="sc">-</span>.<span class="dv">5131524</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>         <span class="dv">77</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.624716</span>   <span class="fl">1.414601</span>    <span class="sc">-</span><span class="fl">2.56</span>   <span class="fl">0.010</span>    <span class="sc">-</span><span class="fl">6.397284</span>   <span class="sc">-</span>.<span class="dv">8521489</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>         <span class="dv">78</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.593983</span>   <span class="fl">1.414779</span>    <span class="sc">-</span><span class="fl">2.54</span>   <span class="fl">0.011</span>    <span class="sc">-</span><span class="fl">6.366898</span>   <span class="sc">-</span>.<span class="dv">8210686</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>         <span class="dv">80</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.597845</span>   <span class="fl">1.414765</span>    <span class="sc">-</span><span class="fl">2.54</span>   <span class="fl">0.011</span>    <span class="sc">-</span><span class="fl">6.370734</span>   <span class="sc">-</span>.<span class="dv">8249558</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>         <span class="dv">81</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.589639</span>   <span class="fl">1.414745</span>    <span class="sc">-</span><span class="fl">2.54</span>   <span class="fl">0.011</span>    <span class="sc">-</span><span class="fl">6.362489</span>   <span class="sc">-</span>.<span class="dv">8167895</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>         <span class="dv">85</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.598044</span>   <span class="fl">1.414948</span>    <span class="sc">-</span><span class="fl">2.54</span>   <span class="fl">0.011</span>    <span class="sc">-</span><span class="fl">6.371291</span>    <span class="sc">-</span>.<span class="dv">824798</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>         <span class="dv">90</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">3.62163</span>   <span class="fl">1.415099</span>    <span class="sc">-</span><span class="fl">2.56</span>   <span class="fl">0.010</span>    <span class="sc">-</span><span class="fl">6.395173</span>   <span class="sc">-</span>.<span class="dv">8480873</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>         <span class="dv">96</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.658159</span>   <span class="fl">1.415134</span>    <span class="sc">-</span><span class="fl">2.59</span>   <span class="fl">0.010</span>     <span class="sc">-</span><span class="fl">6.43177</span>    <span class="sc">-</span>.<span class="dv">884548</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>        <span class="dv">100</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.672641</span>   <span class="fl">1.415162</span>    <span class="sc">-</span><span class="fl">2.60</span>   <span class="fl">0.009</span>    <span class="sc">-</span><span class="fl">6.446308</span>   <span class="sc">-</span>.<span class="dv">8989739</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>        <span class="dv">102</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.662767</span>   <span class="fl">1.415232</span>    <span class="sc">-</span><span class="fl">2.59</span>   <span class="fl">0.010</span>    <span class="sc">-</span><span class="fl">6.436571</span>   <span class="sc">-</span>.<span class="dv">8889631</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>        <span class="dv">109</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">14.65089</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.995</span>    <span class="sc">-</span><span class="fl">4287.288</span>    <span class="fl">4257.986</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>        <span class="dv">110</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.704316</span>   <span class="fl">1.415125</span>    <span class="sc">-</span><span class="fl">2.62</span>   <span class="fl">0.009</span>     <span class="sc">-</span><span class="fl">6.47791</span>   <span class="sc">-</span>.<span class="dv">9307209</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>        <span class="dv">131</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">14.68697</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.995</span>    <span class="sc">-</span><span class="fl">4287.324</span>     <span class="fl">4257.95</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>        <span class="dv">149</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.976368</span>   <span class="fl">1.415012</span>    <span class="sc">-</span><span class="fl">2.81</span>   <span class="fl">0.005</span>    <span class="sc">-</span><span class="fl">6.749742</span>   <span class="sc">-</span><span class="fl">1.202995</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>        <span class="dv">153</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">3.97938</span>   <span class="fl">1.414995</span>    <span class="sc">-</span><span class="fl">2.81</span>   <span class="fl">0.005</span>    <span class="sc">-</span><span class="fl">6.752718</span>   <span class="sc">-</span><span class="fl">1.206041</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>        <span class="dv">165</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.013449</span>   <span class="fl">1.415156</span>    <span class="sc">-</span><span class="fl">2.84</span>   <span class="fl">0.005</span>    <span class="sc">-</span><span class="fl">6.787104</span>   <span class="sc">-</span><span class="fl">1.239793</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>        <span class="dv">180</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">15.09339</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4287.731</span>    <span class="fl">4257.544</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>        <span class="dv">186</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.112806</span>   <span class="fl">1.414994</span>    <span class="sc">-</span><span class="fl">2.91</span>   <span class="fl">0.004</span>    <span class="sc">-</span><span class="fl">6.886144</span>   <span class="sc">-</span><span class="fl">1.339468</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>        <span class="dv">188</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">4.11316</span>   <span class="fl">1.414915</span>    <span class="sc">-</span><span class="fl">2.91</span>   <span class="fl">0.004</span>    <span class="sc">-</span><span class="fl">6.886342</span>   <span class="sc">-</span><span class="fl">1.339978</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>        <span class="dv">207</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.178467</span>   <span class="fl">1.414929</span>    <span class="sc">-</span><span class="fl">2.95</span>   <span class="fl">0.003</span>    <span class="sc">-</span><span class="fl">6.951678</span>   <span class="sc">-</span><span class="fl">1.405256</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>        <span class="dv">219</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.206547</span>    <span class="fl">1.41493</span>    <span class="sc">-</span><span class="fl">2.97</span>   <span class="fl">0.003</span>     <span class="sc">-</span><span class="fl">6.97976</span>   <span class="sc">-</span><span class="fl">1.433334</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>        <span class="dv">263</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.342286</span>   <span class="fl">1.415099</span>    <span class="sc">-</span><span class="fl">3.07</span>   <span class="fl">0.002</span>     <span class="sc">-</span><span class="fl">7.11583</span>   <span class="sc">-</span><span class="fl">1.568742</span></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>        <span class="dv">265</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">16.10078</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4288.738</span>    <span class="fl">4256.536</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>        <span class="dv">285</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.688074</span>   <span class="fl">1.225534</span>    <span class="sc">-</span><span class="fl">3.01</span>   <span class="fl">0.003</span>    <span class="sc">-</span><span class="fl">6.090076</span>   <span class="sc">-</span><span class="fl">1.286072</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>        <span class="dv">308</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.409256</span>   <span class="fl">1.414925</span>    <span class="sc">-</span><span class="fl">3.12</span>   <span class="fl">0.002</span>    <span class="sc">-</span><span class="fl">7.182459</span>   <span class="sc">-</span><span class="fl">1.636054</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>        <span class="dv">334</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.432237</span>   <span class="fl">1.415143</span>    <span class="sc">-</span><span class="fl">3.13</span>   <span class="fl">0.002</span>    <span class="sc">-</span><span class="fl">7.205866</span>   <span class="sc">-</span><span class="fl">1.658607</span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>        <span class="dv">340</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.422918</span>   <span class="fl">1.415095</span>    <span class="sc">-</span><span class="fl">3.13</span>   <span class="fl">0.002</span>    <span class="sc">-</span><span class="fl">7.196453</span>   <span class="sc">-</span><span class="fl">1.649383</span></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>        <span class="dv">342</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.365805</span>    <span class="fl">1.41511</span>    <span class="sc">-</span><span class="fl">3.09</span>   <span class="fl">0.002</span>     <span class="sc">-</span><span class="fl">7.13937</span>   <span class="sc">-</span><span class="fl">1.592239</span></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>        <span class="dv">370</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">16.64142</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.279</span>    <span class="fl">4255.996</span></span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>        <span class="dv">397</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">16.53454</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.172</span>    <span class="fl">4256.103</span></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>        <span class="dv">427</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">16.28492</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4288.922</span>    <span class="fl">4256.352</span></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>        <span class="dv">445</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">16.76689</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.404</span>     <span class="fl">4255.87</span></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>        <span class="dv">482</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">15.8041</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4288.441</span>    <span class="fl">4256.833</span></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>        <span class="dv">515</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">16.91429</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.552</span>    <span class="fl">4255.723</span></span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>        <span class="dv">545</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">16.10426</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4288.742</span>    <span class="fl">4256.533</span></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>        <span class="dv">583</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.641434</span>   <span class="fl">1.415524</span>    <span class="sc">-</span><span class="fl">3.28</span>   <span class="fl">0.001</span>     <span class="sc">-</span><span class="fl">7.41581</span>   <span class="sc">-</span><span class="fl">1.867057</span></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>        <span class="dv">596</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">16.41019</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.047</span>    <span class="fl">4256.227</span></span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>        <span class="dv">620</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">17.07029</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.708</span>    <span class="fl">4255.567</span></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>        <span class="dv">670</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">17.14785</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.785</span>    <span class="fl">4255.489</span></span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>        <span class="dv">675</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.631958</span>   <span class="fl">1.416377</span>    <span class="sc">-</span><span class="fl">3.27</span>   <span class="fl">0.001</span>    <span class="sc">-</span><span class="fl">7.408006</span>   <span class="sc">-</span><span class="fl">1.855911</span></span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>        <span class="dv">733</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">4.60698</span>   <span class="fl">1.416405</span>    <span class="sc">-</span><span class="fl">3.25</span>   <span class="fl">0.001</span>    <span class="sc">-</span><span class="fl">7.383082</span>   <span class="sc">-</span><span class="fl">1.830878</span></span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>        <span class="dv">841</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">17.05138</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.689</span>    <span class="fl">4255.586</span></span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>        <span class="dv">852</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.566243</span>   <span class="fl">1.417712</span>    <span class="sc">-</span><span class="fl">3.22</span>   <span class="fl">0.001</span>    <span class="sc">-</span><span class="fl">7.344907</span>   <span class="sc">-</span><span class="fl">1.787579</span></span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>        <span class="dv">915</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">17.40169</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4290.039</span>    <span class="fl">4255.236</span></span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>        <span class="dv">941</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">17.34105</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.978</span>    <span class="fl">4255.296</span></span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>        <span class="dv">979</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.426862</span>   <span class="fl">1.419414</span>    <span class="sc">-</span><span class="fl">3.12</span>   <span class="fl">0.002</span>    <span class="sc">-</span><span class="fl">7.208862</span>   <span class="sc">-</span><span class="fl">1.644862</span></span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>        <span class="dv">995</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.401387</span>   <span class="fl">1.418922</span>    <span class="sc">-</span><span class="fl">3.10</span>   <span class="fl">0.002</span>    <span class="sc">-</span><span class="fl">7.182422</span>   <span class="sc">-</span><span class="fl">1.620352</span></span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1032</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.390393</span>   <span class="fl">1.418666</span>    <span class="sc">-</span><span class="fl">3.09</span>   <span class="fl">0.002</span>    <span class="sc">-</span><span class="fl">7.170928</span>   <span class="sc">-</span><span class="fl">1.609859</span></span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1141</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">16.4898</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.127</span>    <span class="fl">4256.148</span></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1321</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">17.02179</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.659</span>    <span class="fl">4255.616</span></span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1386</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.427898</span>    <span class="fl">1.41857</span>    <span class="sc">-</span><span class="fl">3.12</span>   <span class="fl">0.002</span>    <span class="sc">-</span><span class="fl">7.208243</span>   <span class="sc">-</span><span class="fl">1.647553</span></span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1400</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">17.74095</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4290.378</span>    <span class="fl">4254.896</span></span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1407</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">17.17352</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.811</span>    <span class="fl">4255.464</span></span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1571</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">18.15173</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.993</span>    <span class="sc">-</span><span class="fl">4290.789</span>    <span class="fl">4254.486</span></span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1586</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">18.39765</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.993</span>    <span class="sc">-</span><span class="fl">4291.035</span>     <span class="fl">4254.24</span></span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1799</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">18.08037</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.993</span>    <span class="sc">-</span><span class="fl">4290.718</span>    <span class="fl">4254.557</span></span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>             <span class="sc">|</span></span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>       _cons <span class="sc">|</span>   <span class="fl">2.482922</span>   <span class="fl">4.946271</span>     <span class="fl">0.50</span>   <span class="fl">0.616</span>    <span class="sc">-</span><span class="fl">7.211591</span>    <span class="fl">12.17744</span></span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ln</span>(stime) <span class="sc">|</span>          <span class="dv">1</span>  (exposure)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./intro_mod.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Introduction</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./discret.html" class="pagination-link">
        <span class="nav-page-text">Modèle temps discret</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb8" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Modèle de Cox"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu"># Le modèle semi-paramétrique de Cox</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>On peut ignorer la partie sur l’estimation du modèle. On retiendra tout de même qu'il est déconseillé de tester la méthode dite exacte pour la correction de la vraisemblance, qui ne peut matériellement fonctionner qu’avec un nombre très limité d’évènements observés simultanément, ce qui est plutôt rare avec des données à durées discrètes ou groupées, classiques dans les sciences sociales.</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">## La vraisemblance partielle et estimation des paramètres </span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>On se situe dans une situation où la durée est mesurée sur une échelle strictement continue. Il ne peut donc y avoir qu'un seul évènement observé en $t_i$ (idem si censure): </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>$$L_i=f(t_i)^{\delta_i}S(t_i)^{1-\delta_i}$$  </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>**Vraisemblance partielle de Cox**  </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$f(t_i)$ est la valeur de la fonction de densité en $t_i$ </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$S(t_i)$ est la valeur de la fonction de survie en $t_i$ </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\delta_i=1$ si l'évènement est observé: $L_i=f(t_i)$ </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\delta_i=0$ si l'observation est censurée: $L_i=S(t_i)$                                                                            </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>Comme $f(t_i)=h(t_i)\times S(t_i)$, on obtient:  $L_i=<span class="co">[</span><span class="ot">h(t_i)S(t_i)</span><span class="co">]</span>^{\delta_i}S(t_i)^{1-\delta_i} = h(t_i)^{\delta_i}S(t_i)$.  </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>Pour $i=1,2,.....,n$, la vraisemblance totale s'ecrit donc:  $L_i=\prod_{i=1}^{n}h(t_i)^{\delta_i}S(t_i)$.  </span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>On peut réécrire cette vraisemblance en la multipliant et en la divisant par: $\sum_{j\in R_i}h(t_i)$, où $j\in R_i$ est l'ensemble des observation soumises au risque en $t_i$.  </span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>$$L=\prod_{i=1}^{n}\left<span class="co">[</span><span class="ot">h(t_i)\frac{\sum_{j\in R}h(t_i)}{\sum_{j\in R}h(t_i)}\right</span><span class="co">]</span>^{\delta_i}S(t_i)= \prod_{i=1}^{n}\left<span class="co">[</span><span class="ot">\frac{h(t_i)}{\sum_{j\in R_i}h(t_i)}\right</span><span class="co">]</span>^{\delta_i}\sum_{j\in R_i}h(t_i)^{\delta_i}S(t_i)$$  </span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>La vraisemblance partielle retient seulement le premier terme de la vraisemblance, soit:   </span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>$$PL=\prod_{i=1}^{n}\left<span class="co">[</span><span class="ot">\frac{h(t_i)}{\sum_{j\in R}h(t_i)}\right</span><span class="co">]</span>^{\delta_i}$$  </span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>Une fois remplacée la valeur de $h(t_i)$ par son expression en tant que modèle à risques proportionnels, la vraisemblance partielle ne dépendra plus de la durée. **Mais elle va dépendre de l'ordre d'arrivée des évènements, c'est à dire leur rang**. </span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>*Remarque*: pour les observations censurées($\delta_i=0$), $PL=1$. Toutefois, ces censures à droite entrent dans l'expression $\sum_{j\in R}h(t_i)$ tant qu'elles sont soumises au risque.  </span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>En remplaçant donc $h(t_i)$ par l'expression $h_0(t)e^{X_i^{'}b}$:  </span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>$$PL=\prod_{i=1}^{n}\left<span class="co">[</span><span class="ot">\frac{h_0(t)e^{X_{i}^{'}b}}{\sum_{j\in R_i}h_0(t)e^{X_{j}^{'}b}}\right</span><span class="co">]</span>^{\delta_i} =\prod_{i=1}^{n}\left<span class="co">[</span><span class="ot">\frac{e^{X_i^{'}b}}{\sum_{j\in R_i}e^{X_{j}^{'}b}}\right</span><span class="co">]</span>^{\delta_i}$$</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>L'expression $\frac{e^{Xb}}{\sum_{j\in R}e^{Xb}}$ est une probabilité, la vraisemblance partielle est donc bien un produit de probabilités. **Il s'agit de la probabilité qu'un individu observe l'évènement en $t_i$ sachant qu'un évènement (et un seul) s'est produit**.    </span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>*Condition nécessaire: pas d'évènement simultané*:  </span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>On rappelle que la durée est mesuré de manière strictement continue, il ne doit pas y avoir d'évènement simultané. Sinon, l’estimation de la vraisemblance doit faire l'objet d'une correction.   </span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>*Correction de la vraisemblance avec des évènements simultanés*:    </span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>La ***méthode dite exacte***: Comme il ne doit pasy avoir d’évènement simultané, on va intégrer à la vraisemblance toutes les permutations possibles des évènements observés simultanément: si en $t_i$ on observe au « même moment » l’évènement pour A et B, une échelle temporelle plus précise nous permettrait de savoir si A s'est produit avant B ou B s'est produit avant A. Comme le nombre de permutations est calculé à l'aide d'une factorielle, avec 3 évènements  mesurés simultanément, il y a 6 permutations possibles ($3\times2\times1$).  </span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>Problème: le nombre de permutations pour chaque $t_i$ peut devenir très vite particulièrement élevé. Par exemple pour 10 évènements simultanés, le nombre de permutations est égal à 3.628.800. Le temps de calcul devient extrêmement long, et ce type de correction totalement inopérant. </span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>La ***méthode dite de Breslow***: il s'agit d'une approximation de la méthode exacte permettant de ne pas avoir à intégrer chaque permutation. Cette approximation est utilisée par défaut par les logiciels Sas et Stata. </span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>La ***méthode dite  d'Efron***: elle corrige l'approximation de Breslow, et est jugée plus proche de la méthode exacte. C'est la méthode utilisée par défaut avec le logiciel R, et elle est disponible avec les autres applications.  </span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimation des paramètres</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>On utilise la méthode habituelle, à savoir la maximisation de la log-vraisemblance (ici partielle).  </span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Conditions de premier ordre: calcul des équations de score à partir des dérivées partielles. Solution: $\frac{\partial log(PL)}{\partial{b_k}}=0$. On ne peut pas obtenir de solution numérique directe.  </span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>Remarque: les équations de score sont utilisées pour tester la validité de l'hypothèse de constance des rapports de risque pour calculer les **résidus de Schoenfeld** (voir plus bas). </span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Conditions de second ordre: calcul des dérivées secondes qui permettent d'obtenir la matrice d'information de Fisher et la matrice des variances-covariances des paramètres. </span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Comme il n'y a pas de solution numérique directe, on utilise un algorithme d'optimisation (ex: Newton-Raphson) à partir des équations de score et de la matrice d'information de Fisher.  </span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>**Eléments de calcul**  </span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>En logarithme (sans évènement simultané), la vraisemblance partielle s'ecrit:  </span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>$$pl(b)=\sum_{i=1}^n\delta_i\left(log(e^{X_{i}^{'}b})-log\sum_{j\in R_i}e^{X_{j}^{'}b}\right)$$</span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>$$pl(b)=\sum_{i=1}^n\delta_i\left(X_{i}^{'}b-log\sum_{j\in R_i}e^{X_{j}^{'}b}\right)$$</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>Calcul de l'équation de score pour une covariable $X_k$:  </span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>$$\frac{\partial pl(b)}{\partial{b_k}}=\sum_{i=1}^n\delta_i\left(X_{ik}-\sum_{j\in R_i}X_{jk}\frac{e^{X_{j}^{'}b}}{\sum_{j\in R_i}e^{X_{j}^{'}b}}\right)$$</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>Comme $\frac{e^{X_{j}b}}{\sum_{j\in R}e^{X_{j}b}}$ est une probabilité, et  $\sum_{j\in R}X_{ik}\times p_i$ est l'espérance (la moyenne) $E(X_k)$ d'avoir la caractéristique $X_k$ lorsqu'un évènement a été observé. Au final:  </span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>$$\frac{\partial lp(b)}{\partial{b_k}}= \sum_{i=1}^n\delta_i\left(X_{ik} - E(X_{j\in R_i,k}) \right)$$</span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>Cette expression va permettre de tester le respect ou non de l’hypothèse de risques proportionnels via les *résisus de Schoenfeld*. </span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lecture des résultats</span></span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>Comme il s'agit d'un modèle à risque proportionnel, **les rapports de risques sont constants pendant toute la période d'observation**. Il s'agit d'une propriété de l'estimation.  </span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>***Covariable binaire (indicatrice)*** </span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>$X=(0,1)$: $RR=\frac{h(t\ |\ X=1)}{h(t\ |\ X=0)}=e^b$.  </span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>A chaque moment de la durée $t$, le risque d'observer l'évènement est $e^b$ fois plus important/plus faible pour $X=1$ que pour $X=0$.  </span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>***Covariable quantitative*** (mais fixe dans le temps) </span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a>$RR=\frac{h(t\ |\ X=a+c)}{h(t\ |\ X=a)}=e^{c \times{b}}$. </span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a>On prendra pour illustrer une variable type âge au début de l’exposition au risque (a)  et un delta de comparaison avec un âge inférieur c.  </span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>Si $c=1$ (résultat de l'estimation): A un âge donnée en début d'exposition, le risque de connaitre l'évènement est $e^b$ fois inférieur/supérieur à celui d'une personne qui a un an de moins au début de l'exposition. </span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a>**Exemple pour les insuffisances cardiaques**  </span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a>Estimateurs: $b$</span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a>Cox regression <span class="sc">--</span> Efron method <span class="cf">for</span> ties</span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a>No. of subjects <span class="ot">=</span>          <span class="dv">103</span>                  Number of obs    <span class="ot">=</span>         <span class="dv">103</span></span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a>No. of failures <span class="ot">=</span>           <span class="dv">75</span></span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a>Time at risk    <span class="ot">=</span>        <span class="dv">31938</span></span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a>                                                LR <span class="fu">chi2</span>(<span class="dv">3</span>)       <span class="ot">=</span>       <span class="fl">17.63</span></span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a>Log likelihood  <span class="ot">=</span>   <span class="sc">-</span><span class="fl">289.30639</span>                  Prob <span class="sc">&gt;</span> chi2      <span class="ot">=</span>      <span class="fl">0.0005</span></span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a>          _t <span class="sc">|</span>      Coef.   Std. Err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% Conf. Interval]</span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">|</span>    <span class="sc">-</span><span class="fl">0.1196</span>     <span class="fl">0.0673</span>    <span class="sc">-</span><span class="fl">1.78</span>   <span class="fl">0.076</span>      <span class="sc">-</span><span class="fl">0.2516</span>      <span class="fl">0.0124</span></span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true" tabindex="-1"></a>         age <span class="sc">|</span>     <span class="fl">0.0296</span>     <span class="fl">0.0135</span>     <span class="fl">2.19</span>   <span class="fl">0.029</span>       <span class="fl">0.0031</span>      <span class="fl">0.0561</span></span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true" tabindex="-1"></a>     surgery <span class="sc">|</span>    <span class="sc">-</span><span class="fl">0.9873</span>     <span class="fl">0.4363</span>    <span class="sc">-</span><span class="fl">2.26</span>   <span class="fl">0.024</span>      <span class="sc">-</span><span class="fl">1.8424</span>     <span class="sc">-</span><span class="fl">0.1323</span></span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-137"><a href="#cb8-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true" tabindex="-1"></a>Rapports des risques: $e^b$ </span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb8-141"><a href="#cb8-141" aria-hidden="true" tabindex="-1"></a>Cox regression <span class="sc">--</span> Efron method <span class="cf">for</span> ties</span>
<span id="cb8-142"><a href="#cb8-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-143"><a href="#cb8-143" aria-hidden="true" tabindex="-1"></a>No. of subjects <span class="ot">=</span>          <span class="dv">103</span>                  Number of obs    <span class="ot">=</span>         <span class="dv">103</span></span>
<span id="cb8-144"><a href="#cb8-144" aria-hidden="true" tabindex="-1"></a>No. of failures <span class="ot">=</span>           <span class="dv">75</span></span>
<span id="cb8-145"><a href="#cb8-145" aria-hidden="true" tabindex="-1"></a>Time at risk    <span class="ot">=</span>        <span class="dv">31938</span></span>
<span id="cb8-146"><a href="#cb8-146" aria-hidden="true" tabindex="-1"></a>                                                LR <span class="fu">chi2</span>(<span class="dv">3</span>)       <span class="ot">=</span>       <span class="fl">17.63</span></span>
<span id="cb8-147"><a href="#cb8-147" aria-hidden="true" tabindex="-1"></a>Log likelihood  <span class="ot">=</span>   <span class="sc">-</span><span class="fl">289.30639</span>                  Prob <span class="sc">&gt;</span> chi2      <span class="ot">=</span>      <span class="fl">0.0005</span></span>
<span id="cb8-148"><a href="#cb8-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-149"><a href="#cb8-149" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb8-150"><a href="#cb8-150" aria-hidden="true" tabindex="-1"></a>          _t <span class="sc">|</span> Haz. Ratio   Std. Err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% Conf. Interval]</span>
<span id="cb8-151"><a href="#cb8-151" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb8-152"><a href="#cb8-152" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">|</span>     <span class="fl">0.8872</span>     <span class="fl">0.0597</span>    <span class="sc">-</span><span class="fl">1.78</span>   <span class="fl">0.076</span>       <span class="fl">0.7775</span>      <span class="fl">1.0124</span></span>
<span id="cb8-153"><a href="#cb8-153" aria-hidden="true" tabindex="-1"></a>         age <span class="sc">|</span>     <span class="fl">1.0300</span>     <span class="fl">0.0139</span>     <span class="fl">2.19</span>   <span class="fl">0.029</span>       <span class="fl">1.0031</span>      <span class="fl">1.0577</span></span>
<span id="cb8-154"><a href="#cb8-154" aria-hidden="true" tabindex="-1"></a>     surgery <span class="sc">|</span>     <span class="fl">0.3726</span>     <span class="fl">0.1625</span>    <span class="sc">-</span><span class="fl">2.26</span>   <span class="fl">0.024</span>       <span class="fl">0.1584</span>      <span class="fl">0.8761</span></span>
<span id="cb8-155"><a href="#cb8-155" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb8-156"><a href="#cb8-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-157"><a href="#cb8-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-158"><a href="#cb8-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-159"><a href="#cb8-159" aria-hidden="true" tabindex="-1"></a>On retrouve les résultats des tests non paramétriques pour l'opération, à savoir qu’un pontage réduit les risques journaliers de décès pendant la période d’observation (augmente la durée de survie).     </span>
<span id="cb8-160"><a href="#cb8-160" aria-hidden="true" tabindex="-1"></a>De la même manière, plus on entre à un âge élevé dans la liste d'attente plus le risque de décès augmente. La variable *year*, qui traduit des progrès en médecine, exprime une réduction relativement modérée du risque journalier de décès durant l'attente de la greffe du coeur.   </span>
<span id="cb8-161"><a href="#cb8-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-162"><a href="#cb8-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-163"><a href="#cb8-163" aria-hidden="true" tabindex="-1"></a><span class="fu">## R-Stata-Sas-Python   </span></span>
<span id="cb8-164"><a href="#cb8-164" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-165"><a href="#cb8-165" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb8-166"><a href="#cb8-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-167"><a href="#cb8-167" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb8-168"><a href="#cb8-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-169"><a href="#cb8-169" aria-hidden="true" tabindex="-1"></a>Le modèle est  estimé avec la fonction **`coxph`** de la librairie **`survival`**.  Hors options, la syntaxe est identiques aux fonctions <span class="in">`survfit`</span> et <span class="in">`survdif`</span>.</span>
<span id="cb8-170"><a href="#cb8-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-171"><a href="#cb8-171" aria-hidden="true" tabindex="-1"></a><span class="fu">### Stata</span></span>
<span id="cb8-172"><a href="#cb8-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-173"><a href="#cb8-173" aria-hidden="true" tabindex="-1"></a>Le modèle est estimé avec la commande **`stcox`**.</span>
<span id="cb8-174"><a href="#cb8-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-175"><a href="#cb8-175" aria-hidden="true" tabindex="-1"></a><span class="fu">### SAS</span></span>
<span id="cb8-176"><a href="#cb8-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-177"><a href="#cb8-177" aria-hidden="true" tabindex="-1"></a>Le modèle est estimé avec la **`proc phreg`**.</span>
<span id="cb8-178"><a href="#cb8-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-179"><a href="#cb8-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-180"><a href="#cb8-180" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python</span></span>
<span id="cb8-181"><a href="#cb8-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-182"><a href="#cb8-182" aria-hidden="true" tabindex="-1"></a>Avec la librairie <span class="in">`lifelines`</span>, le modèle est estimé avec la fonction **`CoxPHFitter`**. Avec la librairie <span class="in">`statmodels`</span>, il est estimé avec la fonction <span class="in">`smf.phreg`</span>.</span>
<span id="cb8-183"><a href="#cb8-183" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb8-184"><a href="#cb8-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-185"><a href="#cb8-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-186"><a href="#cb8-186" aria-hidden="true" tabindex="-1"></a><span class="fu"># L'hypothèse de constance des rapports de risque</span></span>
<span id="cb8-187"><a href="#cb8-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-188"><a href="#cb8-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-189"><a href="#cb8-189" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Les rapports de risque (RR) estimés par le modèle sont contraints à être constant pendant toute la période d’observation. C’est une hypothèse forte.</span>
<span id="cb8-190"><a href="#cb8-190" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Le respect de cette hypothèse doit être testé, en particulier pour un modèle de Cox où la baseline du risque est habituellement estimée à l’aide de ces rapports (méthode dite de Breslow, non traitée...mais bientôt en annexe). En post-estimation, les valeurs estimées du risque pourront présenter des valeurs aberrantes, en particulier négatives.</span>
<span id="cb8-191"><a href="#cb8-191" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Tester cette hypothèse revient à tester une interaction entre les rapports et la durée (ou plutôt une fonction de la durée).</span>
<span id="cb8-192"><a href="#cb8-192" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Plusieurs méthodes disponibles, celle sur les résidus de martingales, réservée aux covariables continues, et le « test » graphique réservé aux variables catégorielles ne seront pas traités. On traitera celle basée sur les **résidus de Schoenfeld** puis l'introduction d'une intéraction avec la durée dans le modèle. Cette dernière peut faire également office de méthode de correction lorsque l'hypothèse n'est pas respectée.  </span>
<span id="cb8-193"><a href="#cb8-193" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Si on regarde les courbes de Kaplan-Meier, leurs croisement non tardif impliquera nécessairement un problème sur cette hypothèse. </span>
<span id="cb8-194"><a href="#cb8-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-195"><a href="#cb8-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-196"><a href="#cb8-196" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tests sur les résidus de Schoenfeld</span></span>
<span id="cb8-197"><a href="#cb8-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-198"><a href="#cb8-198" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb8-199"><a href="#cb8-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-200"><a href="#cb8-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-201"><a href="#cb8-201" aria-hidden="true" tabindex="-1"></a>Résumé rapide: le test consiste à regarder la corrélation entre des résidus obtenus directement avec la fonction de score de la vraisemblanc partielle de Cox.  </span>
<span id="cb8-202"><a href="#cb8-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-203"><a href="#cb8-203" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>***Test simplifié***: simple corrélation obtenu par une régression linéaire par les moindres carrés ordinaires. Pour chaque covariable, la standardisation du résidu utilise la variance de l'estimateur obtenu par le modèle. Une rapide présentation est disponible  <span class="co">[</span><span class="ot">ici</span><span class="co">](https://mthevenin.github.io/analyse_duree/annexes/residusch.html)</span></span>
<span id="cb8-204"><a href="#cb8-204" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>***Test exact***:  corrélation obtenu par une régression linéaire par les moindres carrés généralisés. Pour chaque covariable, on calcule la variance et on utilise la variance exacte du résidu à partir de la dérivée de la fonction score (matrice d'information de fisher sur sa diagonale). Les moindres carrés généralisés corrigeront la présence d'autocorrélations des résidus, classique avec des données temporelles.   </span>
<span id="cb8-205"><a href="#cb8-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-206"><a href="#cb8-206" aria-hidden="true" tabindex="-1"></a>A ce jour le test exact est implémenté seulement dans la v3 du package <span class="in">`survival`</span> de R. Un problème de reproductibilité se pose, dans l'espace des applications et dans le temps pour R, le test simplifié n'étant plus disponible à son installation (je donne un moyen de l'exécuter tout de même).  </span>
<span id="cb8-207"><a href="#cb8-207" aria-hidden="true" tabindex="-1"></a>Je m'interroge par ailleurs sur la sensibilité de la version exacte en présence de durées discrètes ou groupées.</span>
<span id="cb8-208"><a href="#cb8-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-209"><a href="#cb8-209" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb8-210"><a href="#cb8-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-211"><a href="#cb8-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-212"><a href="#cb8-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-213"><a href="#cb8-213" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Les résidus « bruts » sont directement calculés à partir des équations de scores (voir section estimation).</span>
<span id="cb8-214"><a href="#cb8-214" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Ce résidu n’est calculé que pour les observations qui ont connues l’évènement.</span>
<span id="cb8-215"><a href="#cb8-215" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Il est calculé au moment où l’évènement s’est produit.</span>
<span id="cb8-216"><a href="#cb8-216" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>La somme des résidus pour chaque covariable est égale à 0 (propriété de l’équation de score à l’équilibre).</span>
<span id="cb8-217"><a href="#cb8-217" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>On utilise généralement les résidus de Schoenfeld « standardisés » ou plutôt "remis à l'échelle" - par leur variance -.</span>
<span id="cb8-218"><a href="#cb8-218" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Pour une observation dont l’évènement s’est produit en $t_i$, le *résidu brut de Schoenfeld* pour la covariable $X_k$, après estimation du modèle, est égal à:</span>
<span id="cb8-219"><a href="#cb8-219" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-220"><a href="#cb8-220" aria-hidden="true" tabindex="-1"></a>$$rs_{ik}=X_{ik}- \sum_{j\in R_i}X_{jk}\frac{e^{X_{j}^{'}b}}{\sum_{j\in R_i}e^{X_{j}^{'}b}}= X_{ik} - E(X_{j\in R_i})$$</span>
<span id="cb8-221"><a href="#cb8-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-222"><a href="#cb8-222" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Ce résidu est formellement la contribution d'une observation ou d'un moment d'évènement au score. Il se lit comme la différence entre la valeur observée d'une covariable  et sa valeur espérée au moment où un évènement se produit. </span>
<span id="cb8-223"><a href="#cb8-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-224"><a href="#cb8-224" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Si l'hypothèse de constance des risk ratios est respectée, les résidus ne doivent pas suivre une tendance précise, , en particulier à la hausse ou à la baisse.  </span>
<span id="cb8-225"><a href="#cb8-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-226"><a href="#cb8-226" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Intuitivement sans censure à droite et en ne considérant que les résidus bruts: on a un RR strictement égal à 1 en début d'exposition $R_i=100$ avec 50 hommes et 50 femmes. Si l'hypothèse PH (strictement) respectée, lorsqu'il reste 90 personnes soumises au risque, on devrait avoir 45 hommes et 45 femmes. Avec $R_i=50$, 25 hommes et 25 femmes,.......avec $R_i=10$, 5 hommes et 5 femmes.   Au final l'espérance d'avoir la caractéristique $X$ est toujours égal à 0.5 et les résidus bruts prendront toujours la valeur -.5 si $X=0$ et .5 si $X=1$. En faisant une simple régression linéaire entre les résidus, qui alternent ces deux valeurs, et $t$, le coefficient estimé sera non significativement différent de 0. </span>
<span id="cb8-227"><a href="#cb8-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-228"><a href="#cb8-228" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>On peut tester l'hypothèse sur les résidus par une régression entre</span>
<span id="cb8-229"><a href="#cb8-229" aria-hidden="true" tabindex="-1"></a>    ces résidus pour chaque covariable et la durée (ou fonction dérivée</span>
<span id="cb8-230"><a href="#cb8-230" aria-hidden="true" tabindex="-1"></a>    de la durée, par exemple $t$ ou $log(t)$)). Cette solution prend forme avec le</span>
<span id="cb8-231"><a href="#cb8-231" aria-hidden="true" tabindex="-1"></a>     test de **Grambsch-Therneau** sous sa forme simplifiée -OLS- (R jusqu'à v3 de <span class="in">`survival`</span>, Sas, Stata, Python) ou exacte - GLS- (R depuis la V3).   </span>
<span id="cb8-232"><a href="#cb8-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-233"><a href="#cb8-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-234"><a href="#cb8-234" aria-hidden="true" tabindex="-1"></a>On trouvera des éléments de calcul du test simplifié <span class="co">[</span><span class="ot">ici</span><span class="co">](https://mthevenin.github.io/analyse_duree/annexes/residusch.html)</span> </span>
<span id="cb8-235"><a href="#cb8-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-236"><a href="#cb8-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-237"><a href="#cb8-237" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning} </span>
<span id="cb8-238"><a href="#cb8-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-239"><a href="#cb8-239" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Résultats identiques entre SAS - STATA - SURVIVAL V2 (R) - Lifelines/statmodels (Python)**  </span></span>
<span id="cb8-240"><a href="#cb8-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-241"><a href="#cb8-241" aria-hidden="true" tabindex="-1"></a>Avec $g(t)=t$:  </span>
<span id="cb8-242"><a href="#cb8-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-243"><a href="#cb8-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb8-244"><a href="#cb8-244" aria-hidden="true" tabindex="-1"></a>      Test of proportional<span class="sc">-</span>hazards assumption</span>
<span id="cb8-245"><a href="#cb8-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-246"><a href="#cb8-246" aria-hidden="true" tabindex="-1"></a>      Time<span class="sc">:</span>  Time</span>
<span id="cb8-247"><a href="#cb8-247" aria-hidden="true" tabindex="-1"></a>      <span class="sc">----------------------------------------------------------------</span></span>
<span id="cb8-248"><a href="#cb8-248" aria-hidden="true" tabindex="-1"></a>                  <span class="er">|</span>       rho            chi2       df       Prob<span class="sc">&gt;</span>chi2</span>
<span id="cb8-249"><a href="#cb8-249" aria-hidden="true" tabindex="-1"></a>      <span class="sc">------------+---------------------------------------------------</span></span>
<span id="cb8-250"><a href="#cb8-250" aria-hidden="true" tabindex="-1"></a>      year        <span class="sc">|</span>      <span class="fl">0.10162</span>         <span class="fl">0.80</span>        <span class="dv">1</span>         <span class="fl">0.3720</span></span>
<span id="cb8-251"><a href="#cb8-251" aria-hidden="true" tabindex="-1"></a>      age         <span class="sc">|</span>      <span class="fl">0.12937</span>         <span class="fl">1.61</span>        <span class="dv">1</span>         <span class="fl">0.2043</span></span>
<span id="cb8-252"><a href="#cb8-252" aria-hidden="true" tabindex="-1"></a>      surgery     <span class="sc">|</span>      <span class="fl">0.29664</span>         <span class="fl">5.54</span>        <span class="dv">1</span>         <span class="fl">0.0186</span></span>
<span id="cb8-253"><a href="#cb8-253" aria-hidden="true" tabindex="-1"></a>      <span class="sc">------------+---------------------------------------------------</span></span>
<span id="cb8-254"><a href="#cb8-254" aria-hidden="true" tabindex="-1"></a>      global test <span class="sc">|</span>                      <span class="fl">8.76</span>        <span class="dv">3</span>         <span class="fl">0.0327</span></span>
<span id="cb8-255"><a href="#cb8-255" aria-hidden="true" tabindex="-1"></a>      <span class="sc">----------------------------------------------------------------</span></span>
<span id="cb8-256"><a href="#cb8-256" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-257"><a href="#cb8-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-258"><a href="#cb8-258" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb8-259"><a href="#cb8-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-260"><a href="#cb8-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-261"><a href="#cb8-261" aria-hidden="true" tabindex="-1"></a>Ici l'hypothèse de proportionnalité des risques est questionnable pour la variable *surgery*. Le risque ratio  pourrait ne pas constant dans le temps.  Ce n'est pas peut-être pas étonnant,  le premier décès pour les personnes opérées d'un pontage n'est observé qu'au bout de 165 jours.</span>
<span id="cb8-262"><a href="#cb8-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-263"><a href="#cb8-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-264"><a href="#cb8-264" aria-hidden="true" tabindex="-1"></a>**Remarques / à savoir**  </span>
<span id="cb8-265"><a href="#cb8-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-266"><a href="#cb8-266" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Test multiple**: de nouveau il convient de se méfier du résultat du test multiple. Le risque de premier espèce peut-être assez faible alors que les tests pour chaque covariables prises une à une présenteraient des valeurs élevées (&gt;.1 par exemple).     </span>
<span id="cb8-267"><a href="#cb8-267" aria-hidden="true" tabindex="-1"></a>Le résultat de ce test est considéré par certain.e.s comme un indicateur de l’ampleur du biais qui affecte la baseline du risque.  </span>
<span id="cb8-268"><a href="#cb8-268" aria-hidden="true" tabindex="-1"></a>Le résultat de ce test multiple est considéré par certain.e.s comme un indicateur de l’ampleur du biais qui affecte la baseline du risque.</span>
<span id="cb8-269"><a href="#cb8-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-270"><a href="#cb8-270" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Transformations de la durée**: n’importe quelle fonction de la durée peut être utilisée pour réaliser le test. On retient généralement les fonctions suivantes: $g(t)=t$ (« identity »), $g(t)=log(t)$, $g(t)=KM(t)$ ou $g(t)=1- KM(t$) où $KM(t$) est l’estimateur de Kaplan-Meier. Enfin une transformation appelée « rank », est  utilisée seulement pour les durées strictement continue ou suffisamment dispersées . Par exemple $t=(0.1,0.5,1,2.6,3)$ donne une transformation $t=(1,2,3,4)$. A savoir : la fonction « identity », utilisée ici, rend le test relativement sensible aux évènements tardifs lorsque la population restant soumise est peu nombreuse (outliers).</span>
<span id="cb8-271"><a href="#cb8-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-272"><a href="#cb8-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-273"><a href="#cb8-273" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb8-274"><a href="#cb8-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-275"><a href="#cb8-275" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb8-276"><a href="#cb8-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-277"><a href="#cb8-277" aria-hidden="true" tabindex="-1"></a>***Attention version exacte du test depuis le v3 de survival***.</span>
<span id="cb8-278"><a href="#cb8-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-279"><a href="#cb8-279" aria-hidden="true" tabindex="-1"></a><span class="ss">*  </span>Après avoir créer un objet  à l’estimation du modèle de Cox, on utilise la fonction **`cox.zph`**. Cette fonction utilise par défaut $g(t)=1-KM(t)$ où $KM(t)$ sont les estimateurs de la courbe de Kaplan-Meier. On peut modifier cette fonction. Il est préférable de conserver cette fonction par défaut.</span>
<span id="cb8-280"><a href="#cb8-280" aria-hidden="true" tabindex="-1"></a><span class="ss">*  </span>Test antérieur: j’ai récupéré le programme du test antérieur, renommé **`cox.zphold`**. On peut le charger simplement, et il est facilement exécutable.</span>
<span id="cb8-281"><a href="#cb8-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-282"><a href="#cb8-282" aria-hidden="true" tabindex="-1"></a><span class="fu">### Stata</span></span>
<span id="cb8-283"><a href="#cb8-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-284"><a href="#cb8-284" aria-hidden="true" tabindex="-1"></a>Le test est obtenu avec la commande **`estat phtest, d`**. Par défaut Stata utilise $g(t)=t$. On peut modifier cette fonction.</span>
<span id="cb8-285"><a href="#cb8-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-286"><a href="#cb8-286" aria-hidden="true" tabindex="-1"></a><span class="fu">### SAS</span></span>
<span id="cb8-287"><a href="#cb8-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-288"><a href="#cb8-288" aria-hidden="true" tabindex="-1"></a>Le test est disponible depuis quelques années avec l’argument **`zph`** sur la ligne <span class="in">`proc lifetest`</span>. Par défaut SAS utilise $g(t)=t$. On peut modifier cette fonction.</span>
<span id="cb8-289"><a href="#cb8-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-290"><a href="#cb8-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-291"><a href="#cb8-291" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python</span></span>
<span id="cb8-292"><a href="#cb8-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-293"><a href="#cb8-293" aria-hidden="true" tabindex="-1"></a>On utilise la fonction **`proportional_hazard_test`** de la librairie <span class="in">`lifelines`</span>. La fonction utilise par défaut $g(t)=t$, mais on peut afficher les résultats pour toutes les transformations de $t$ disponibles avec l’option <span class="in">`time_transform=’all’`</span>. </span>
<span id="cb8-294"><a href="#cb8-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-295"><a href="#cb8-295" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb8-296"><a href="#cb8-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-297"><a href="#cb8-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-298"><a href="#cb8-298" aria-hidden="true" tabindex="-1"></a><span class="fu">## Intéraction avec la durée</span></span>
<span id="cb8-299"><a href="#cb8-299" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb8-300"><a href="#cb8-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-301"><a href="#cb8-301" aria-hidden="true" tabindex="-1"></a>Petit retour sur l'estimation du modèle.  </span>
<span id="cb8-302"><a href="#cb8-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-303"><a href="#cb8-303" aria-hidden="true" tabindex="-1"></a>Pour estimer le modèle de Cox, les données sont dans un premier temps splitées aux temps d'évènement. A l’exception de *Sas*,  les autres logiciels disposent d'une fonction qui effectue cette opération (*R*: `survsplit` - *Stata*: <span class="in">`stsplit`</span>).</span>
<span id="cb8-304"><a href="#cb8-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-305"><a href="#cb8-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb8-306"><a href="#cb8-306" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+------------------------------+</span></span>
<span id="cb8-307"><a href="#cb8-307" aria-hidden="true" tabindex="-1"></a>      <span class="er">|</span> id   surgery    d    t    t0 <span class="sc">|</span></span>
<span id="cb8-308"><a href="#cb8-308" aria-hidden="true" tabindex="-1"></a>      <span class="er">|</span><span class="sc">------------------------------</span><span class="er">|</span></span>
<span id="cb8-309"><a href="#cb8-309" aria-hidden="true" tabindex="-1"></a>  <span class="fl">24.</span> <span class="sc">|</span>  <span class="dv">2</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">1</span>     <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb8-310"><a href="#cb8-310" aria-hidden="true" tabindex="-1"></a>  <span class="fl">25.</span> <span class="sc">|</span>  <span class="dv">2</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">2</span>     <span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb8-311"><a href="#cb8-311" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.</span> <span class="sc">|</span>  <span class="dv">2</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">3</span>     <span class="dv">2</span> <span class="sc">|</span></span>
<span id="cb8-312"><a href="#cb8-312" aria-hidden="true" tabindex="-1"></a>  <span class="fl">27.</span> <span class="sc">|</span>  <span class="dv">2</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">5</span>     <span class="dv">3</span> <span class="sc">|</span></span>
<span id="cb8-313"><a href="#cb8-313" aria-hidden="true" tabindex="-1"></a>  <span class="fl">28.</span> <span class="sc">|</span>  <span class="dv">2</span>         <span class="dv">0</span>    <span class="dv">1</span>    <span class="dv">6</span>     <span class="dv">5</span> <span class="sc">|</span></span>
<span id="cb8-314"><a href="#cb8-314" aria-hidden="true" tabindex="-1"></a>      <span class="er">|</span><span class="sc">------------------------------</span><span class="er">|</span></span>
<span id="cb8-315"><a href="#cb8-315" aria-hidden="true" tabindex="-1"></a>  <span class="fl">29.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">1</span>     <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb8-316"><a href="#cb8-316" aria-hidden="true" tabindex="-1"></a>  <span class="fl">30.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">2</span>     <span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb8-317"><a href="#cb8-317" aria-hidden="true" tabindex="-1"></a>  <span class="fl">31.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">3</span>     <span class="dv">2</span> <span class="sc">|</span></span>
<span id="cb8-318"><a href="#cb8-318" aria-hidden="true" tabindex="-1"></a>  <span class="fl">32.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">5</span>     <span class="dv">3</span> <span class="sc">|</span></span>
<span id="cb8-319"><a href="#cb8-319" aria-hidden="true" tabindex="-1"></a>  <span class="fl">33.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">6</span>     <span class="dv">5</span> <span class="sc">|</span></span>
<span id="cb8-320"><a href="#cb8-320" aria-hidden="true" tabindex="-1"></a>      <span class="er">|</span><span class="sc">------------------------------</span><span class="er">|</span></span>
<span id="cb8-321"><a href="#cb8-321" aria-hidden="true" tabindex="-1"></a>  <span class="fl">34.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">8</span>     <span class="dv">6</span> <span class="sc">|</span></span>
<span id="cb8-322"><a href="#cb8-322" aria-hidden="true" tabindex="-1"></a>  <span class="fl">35.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">9</span>     <span class="dv">8</span> <span class="sc">|</span></span>
<span id="cb8-323"><a href="#cb8-323" aria-hidden="true" tabindex="-1"></a>  <span class="fl">36.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">0</span>   <span class="dv">12</span>     <span class="dv">9</span> <span class="sc">|</span></span>
<span id="cb8-324"><a href="#cb8-324" aria-hidden="true" tabindex="-1"></a>  <span class="fl">37.</span> <span class="sc">|</span>  <span class="dv">3</span>         <span class="dv">0</span>    <span class="dv">1</span>   <span class="dv">16</span>    <span class="dv">12</span> <span class="sc">|</span></span>
<span id="cb8-325"><a href="#cb8-325" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+------------------------------+</span></span>
<span id="cb8-326"><a href="#cb8-326" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-327"><a href="#cb8-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-328"><a href="#cb8-328" aria-hidden="true" tabindex="-1"></a>Les bornes des intervalles $<span class="co">[</span><span class="ot">t_0 ;t</span><span class="co">]</span>$ ont des valeurs seulement lorsqu'un évènement s'est produit (principe de la vraisemblance partielle). Il n'y a donc pas de valeurs pour $t$ et $t_0$ en $t=4$ ($id=2,3$), $t=7,10,11,13,14,15$ ($id=3$).  </span>
<span id="cb8-329"><a href="#cb8-329" aria-hidden="true" tabindex="-1"></a>Les deux individus observent l'évènement en $t=6$ pour $id=2$, et en $t=16$ pour $id=3$. Avant ce moment la valeur de la variable évènement/censure (ici $d$) prend toujours la valeur 0, et prend la valeur 1 le jour du décès.  </span>
<span id="cb8-330"><a href="#cb8-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-331"><a href="#cb8-331" aria-hidden="true" tabindex="-1"></a>On vérifie que les paramètres estimés sont identiques</span>
<span id="cb8-332"><a href="#cb8-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-333"><a href="#cb8-333" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb8-334"><a href="#cb8-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-335"><a href="#cb8-335" aria-hidden="true" tabindex="-1"></a>Cox regression with Efron method <span class="cf">for</span> ties</span>
<span id="cb8-336"><a href="#cb8-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-337"><a href="#cb8-337" aria-hidden="true" tabindex="-1"></a>No. of subjects <span class="ot">=</span>    <span class="dv">103</span>                                Number of obs <span class="ot">=</span>  <span class="dv">3</span>,<span class="dv">573</span></span>
<span id="cb8-338"><a href="#cb8-338" aria-hidden="true" tabindex="-1"></a>No. of failures <span class="ot">=</span>     <span class="dv">75</span></span>
<span id="cb8-339"><a href="#cb8-339" aria-hidden="true" tabindex="-1"></a>Time at risk    <span class="ot">=</span> <span class="dv">31</span>,<span class="dv">938</span></span>
<span id="cb8-340"><a href="#cb8-340" aria-hidden="true" tabindex="-1"></a>                                                        LR <span class="fu">chi2</span>(<span class="dv">3</span>)    <span class="ot">=</span>  <span class="fl">17.63</span></span>
<span id="cb8-341"><a href="#cb8-341" aria-hidden="true" tabindex="-1"></a>Log likelihood <span class="ot">=</span> <span class="sc">-</span><span class="fl">289.30639</span>                             Prob <span class="sc">&gt;</span> chi2   <span class="ot">=</span> <span class="fl">0.0005</span></span>
<span id="cb8-342"><a href="#cb8-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-343"><a href="#cb8-343" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb8-344"><a href="#cb8-344" aria-hidden="true" tabindex="-1"></a>          _t <span class="sc">|</span> Haz. ratio   Std. err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% conf. interval]</span>
<span id="cb8-345"><a href="#cb8-345" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb8-346"><a href="#cb8-346" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">|</span>      <span class="fl">0.887</span>      <span class="fl">0.060</span>    <span class="sc">-</span><span class="fl">1.78</span>   <span class="fl">0.076</span>        <span class="fl">0.778</span>       <span class="fl">1.012</span></span>
<span id="cb8-347"><a href="#cb8-347" aria-hidden="true" tabindex="-1"></a>         age <span class="sc">|</span>      <span class="fl">1.030</span>      <span class="fl">0.014</span>     <span class="fl">2.19</span>   <span class="fl">0.029</span>        <span class="fl">1.003</span>       <span class="fl">1.058</span></span>
<span id="cb8-348"><a href="#cb8-348" aria-hidden="true" tabindex="-1"></a>     surgery <span class="sc">|</span>      <span class="fl">0.373</span>      <span class="fl">0.163</span>    <span class="sc">-</span><span class="fl">2.26</span>   <span class="fl">0.024</span>        <span class="fl">0.158</span>       <span class="fl">0.876</span></span>
<span id="cb8-349"><a href="#cb8-349" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb8-350"><a href="#cb8-350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-351"><a href="#cb8-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-352"><a href="#cb8-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-353"><a href="#cb8-353" aria-hidden="true" tabindex="-1"></a>*Introduction d'une intéraction avec une fonction de la durée*  </span>
<span id="cb8-354"><a href="#cb8-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-355"><a href="#cb8-355" aria-hidden="true" tabindex="-1"></a>On a une variable de durée (on prendra $g(t)=t$) qui sera croisée avec la variable *surgery*. Le modèle va s'écrire:      </span>
<span id="cb8-356"><a href="#cb8-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-357"><a href="#cb8-357" aria-hidden="true" tabindex="-1"></a>$$h(t | X,t) = h_0(t)e^{b_1age + b_2year + b_3 surgery + b_4 (surgery\times t)}$$</span>
<span id="cb8-358"><a href="#cb8-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-359"><a href="#cb8-359" aria-hidden="true" tabindex="-1"></a>**Exemple**   </span>
<span id="cb8-360"><a href="#cb8-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-361"><a href="#cb8-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb8-362"><a href="#cb8-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-363"><a href="#cb8-363" aria-hidden="true" tabindex="-1"></a>Cox regression with Efron method <span class="cf">for</span> ties</span>
<span id="cb8-364"><a href="#cb8-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-365"><a href="#cb8-365" aria-hidden="true" tabindex="-1"></a>No. of subjects <span class="ot">=</span>    <span class="dv">103</span>                                Number of obs <span class="ot">=</span>    <span class="dv">103</span></span>
<span id="cb8-366"><a href="#cb8-366" aria-hidden="true" tabindex="-1"></a>No. of failures <span class="ot">=</span>     <span class="dv">75</span></span>
<span id="cb8-367"><a href="#cb8-367" aria-hidden="true" tabindex="-1"></a>Time at risk    <span class="ot">=</span> <span class="dv">31</span>,<span class="dv">938</span></span>
<span id="cb8-368"><a href="#cb8-368" aria-hidden="true" tabindex="-1"></a>                                                        LR <span class="fu">chi2</span>(<span class="dv">4</span>)    <span class="ot">=</span>  <span class="fl">21.58</span></span>
<span id="cb8-369"><a href="#cb8-369" aria-hidden="true" tabindex="-1"></a>Log likelihood <span class="ot">=</span> <span class="sc">-</span><span class="fl">287.32903</span>                             Prob <span class="sc">&gt;</span> chi2   <span class="ot">=</span> <span class="fl">0.0002</span></span>
<span id="cb8-370"><a href="#cb8-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-371"><a href="#cb8-371" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb8-372"><a href="#cb8-372" aria-hidden="true" tabindex="-1"></a>          _t <span class="sc">|</span> Haz. ratio   Std. err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% conf. interval]</span>
<span id="cb8-373"><a href="#cb8-373" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb8-374"><a href="#cb8-374" aria-hidden="true" tabindex="-1"></a>main         <span class="sc">|</span></span>
<span id="cb8-375"><a href="#cb8-375" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">|</span>      <span class="fl">0.884</span>      <span class="fl">0.059</span>    <span class="sc">-</span><span class="fl">1.84</span>   <span class="fl">0.066</span>        <span class="fl">0.776</span>       <span class="fl">1.008</span></span>
<span id="cb8-376"><a href="#cb8-376" aria-hidden="true" tabindex="-1"></a>         age <span class="sc">|</span>      <span class="fl">1.029</span>      <span class="fl">0.014</span>     <span class="fl">2.15</span>   <span class="fl">0.032</span>        <span class="fl">1.003</span>       <span class="fl">1.057</span></span>
<span id="cb8-377"><a href="#cb8-377" aria-hidden="true" tabindex="-1"></a><span class="fu">surgery</span>(t0<span class="sc">+</span>) <span class="sc">|</span>      <span class="fl">0.173</span>      <span class="fl">0.117</span>    <span class="sc">-</span><span class="fl">2.60</span>   <span class="fl">0.009</span>        <span class="fl">0.046</span>       <span class="fl">0.649</span></span>
<span id="cb8-378"><a href="#cb8-378" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb8-379"><a href="#cb8-379" aria-hidden="true" tabindex="-1"></a>Rapport de HR<span class="sc">|</span></span>
<span id="cb8-380"><a href="#cb8-380" aria-hidden="true" tabindex="-1"></a>   surgery<span class="sc">*</span>t <span class="sc">|</span>      <span class="fl">1.002</span>      <span class="fl">0.001</span>     <span class="fl">2.02</span>   <span class="fl">0.043</span>        <span class="fl">1.000</span>       <span class="fl">1.004</span></span>
<span id="cb8-381"><a href="#cb8-381" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb8-382"><a href="#cb8-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-383"><a href="#cb8-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-384"><a href="#cb8-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-385"><a href="#cb8-385" aria-hidden="true" tabindex="-1"></a>On retrouve donc un résultat proche de celui obtenu à partir du test simplifié sur les résidus de Schoenfeld pour la variable *surgery* (et c'est normal). Avec $g(t)=t$, il a le mérite de pouvoir être interprété directement. Ce qui ne veut pas dire qu'il s'agit de la meilleure solution.    </span>
<span id="cb8-386"><a href="#cb8-386" aria-hidden="true" tabindex="-1"></a>Donc, malgré  une hypothèse plutôt forte sur la forme fonctionnelle de l'intéraction, et dans les fait surement pas pertinente, on peut dire  que chaque jour le HR entre personnes opérées et personnes non opérées augmente de 0.2%. L'effet de l'opération sur la survie des individus s'estompe donc avec le temps.</span>
<span id="cb8-387"><a href="#cb8-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-388"><a href="#cb8-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-389"><a href="#cb8-389" aria-hidden="true" tabindex="-1"></a>**Important**:  </span>
<span id="cb8-390"><a href="#cb8-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-391"><a href="#cb8-391" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Le modèle n'est plus un modèle à risque proportionnel. La variable *surgery* n'est plus une variable **fixe** mais une variable tronquée dynamique qui prend la valeur de $t$ pour les personnes qui ont été opérées d'un pontage avant leur entrée dans le registre de greffe.</span>
<span id="cb8-392"><a href="#cb8-392" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>L'altération des rapports de risque dépend de la forme fonctionnelle de l'intéraction choisie. Ici la modification dans le temps du rapport des risque est constante, ce qui est une hypothèse assez forte. On a, en quelques sorte, réintroduit une hypothèse de proportionnalité, ici sur le degré d'altération des écarts de risques dans le temps, qui devient lui même constant.</span>
<span id="cb8-393"><a href="#cb8-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-394"><a href="#cb8-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-395"><a href="#cb8-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-396"><a href="#cb8-396" aria-hidden="true" tabindex="-1"></a><span class="fu">##  Que faire </span></span>
<span id="cb8-397"><a href="#cb8-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-398"><a href="#cb8-398" aria-hidden="true" tabindex="-1"></a>***Ne rien faire***   </span>
<span id="cb8-399"><a href="#cb8-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-400"><a href="#cb8-400" aria-hidden="true" tabindex="-1"></a>On interprète le risque ratio comme un ratio moyen pendant la durée d’observation (P.Allison). Difficilement soutenable pour l’analyse des effets cliniques, elle peut être envisagée dans d’autres domaines. Attention au nombre de variables qui ne respecte pas l’hypothèse, l’estimation de la baseline du risque pourrait être sensiblement affectée. Il convient tout de même lors de l’interprétation, de préciser les variables qui seront analysées sous cette forme « moyenne » sur la période d’observation.  </span>
<span id="cb8-401"><a href="#cb8-401" aria-hidden="true" tabindex="-1"></a>On peut également adapter cette stratégie du « ne rien faire » selon sens de l’altération des rapports de risque. Si aux cours du temps des différences de risque, déjà assez important en début d’observation s’accentuent, à la hausse comme à la baisse, on peut conserver cet estimateur moyen. Mais si l’effet est modéré : $RR&gt;1$ qui baisse ou $RR&lt;1$ qui augmente au cours du temps, je suis moins convaincu de la pertinence de cette option.  </span>
<span id="cb8-402"><a href="#cb8-402" aria-hidden="true" tabindex="-1"></a>Il faut tenir compte de l’intérêt portée par les variables qui présentent un problème par rapport à l’hypothèse. Il n’est peut-être pas nécessaire de complexifier le modèle pour des variables introduites comme simples contrôles.        </span>
<span id="cb8-403"><a href="#cb8-403" aria-hidden="true" tabindex="-1"></a>Mais plus problématique… On sait qu’une des causes du non respect de l’hypothèse peut provenir d’effets de sélection liées à des variables omises ou non observables. En analyse de durée ce problème prend le nom de ***frailty*** (fragilité) lorsque cette non homogénéité n’est pas observables. Des estimations, plus complexes, sont possibles dans ce cas, et sont en mesure malgré leur interprétation plutôt difficile de régler le problème. Si l’hypothèse est sensible aux problèmes d’omission, il convient donc de bien spécifier le modèle au niveau des variables de contrôle observables et disponibles.   </span>
<span id="cb8-404"><a href="#cb8-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-405"><a href="#cb8-405" aria-hidden="true" tabindex="-1"></a>Mais plus problématique <span class="co">[</span><span class="ot">**très important**</span><span class="co">]</span>… On sait qu’une des causes du non respect de l’hypothèse peut provenir d’effets de sélection liées à des variables omises ou non observables. En analyse de durée ce problème prend le nom de ***frailty*** (fragilité) lorsque cette non homogénéité n’est pas observable. Des estimations, plus complexes, sont possibles dans ce cas, et sont en mesure malgré leur interprétation plutôt difficile de régler le problème. Si l’hypothèse est sensible aux biais d’omission, il convient donc de bien spécifier le modèle au niveau des variables de contrôle observables et disponibles.  </span>
<span id="cb8-406"><a href="#cb8-406" aria-hidden="true" tabindex="-1"></a>Le test de **Grambsch-Therneau** peut-être également appréhendé comme un test qui donne un élément d'information sur de possibles biais d'omission (endogénéité)dans le modèle.   </span>
<span id="cb8-407"><a href="#cb8-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-408"><a href="#cb8-408" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb8-409"><a href="#cb8-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-410"><a href="#cb8-410" aria-hidden="true" tabindex="-1"></a>***Modèle de Cox stratifié***   </span>
<span id="cb8-411"><a href="#cb8-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-412"><a href="#cb8-412" aria-hidden="true" tabindex="-1"></a>Utiliser la méthode dite de « Cox stratifiée » (non traitée). Utile si l’objectif est de présenter des fonctions de survie prédites ajustées, et si une seule covariable (binaire) présente un problème. Les RR ne seront pas estimés pour la variable qui ne respecte pas l'hypothèse.    </span>
<span id="cb8-413"><a href="#cb8-413" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">*Je pense faire un courté entrée dessuis dans la section annexe en 2023*</span><span class="co">]</span>.</span>
<span id="cb8-414"><a href="#cb8-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-415"><a href="#cb8-415" aria-hidden="true" tabindex="-1"></a>***Intéraction***    </span>
<span id="cb8-416"><a href="#cb8-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-417"><a href="#cb8-417" aria-hidden="true" tabindex="-1"></a>Introduire une interaction avec la durée, ce qui a été fait juste haut dessus. Cela peut permettre d’enrichir le modèle au niveau de l’interprétation. Valable si peu de covariables présentent des problèmes de stabilité des rapports de risque, dans l'idéal une seule variable. Attention tout de même à la forme de la fonction, dans l’exemple on a contraint l’effet d’interaction à être strictement linéaire, ce qui est une hypothèse plutôt forte....  on introduit de nouveau une contrainte de proportionalité dans le modèle.  </span>
<span id="cb8-418"><a href="#cb8-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-419"><a href="#cb8-419" aria-hidden="true" tabindex="-1"></a>***Modèles alternatifs***  </span>
<span id="cb8-420"><a href="#cb8-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-421"><a href="#cb8-421" aria-hidden="true" tabindex="-1"></a>Utiliser un modèle alternatif: modèles paramétriques à risques proportionnels si la distribution du risque s’ajuste bien, le modèle paramétrique « flexible » de Parmar-Royston (***ajout prévu pour 2023***) ou un modèle à temps discret. Pour la dernière solution, on peut également corriger la non proportionalité avec l'introduction  d'une intéraction. Si on ne le fait pas, les risques prédits, par définition sous forme de probabilités conditionnelles, resteront toujours dans les bornes contrairement au modèle de Cox.      </span>
<span id="cb8-422"><a href="#cb8-422" aria-hidden="true" tabindex="-1"></a>Utiliser un modèle non paramétrique additif dit d’Aalen ou une de ses variantes (non traité). Mais ces modèles, dont les résultats sont présentés par des graphiques, se commentent assez difficilement.  </span>
<span id="cb8-423"><a href="#cb8-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-424"><a href="#cb8-424" aria-hidden="true" tabindex="-1"></a>**Forêt aléatoire**    </span>
<span id="cb8-425"><a href="#cb8-425" aria-hidden="true" tabindex="-1"></a>Autre méthode : les forêts aléatoires <span class="co">[</span><span class="ot">*à présenter un jour tout de même*</span><span class="co">]</span>. L.Breiman a dès le départ proposé une estimation des modèles de survie par cette méthode. Par définition, pas sensible à l’hypothèse PH. Mais cela reste des méthodes à finalité prédictive, moins riche en interprétation. </span>
<span id="cb8-426"><a href="#cb8-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-427"><a href="#cb8-427" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;&lt;br&gt;</span></span>
<span id="cb8-428"><a href="#cb8-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-429"><a href="#cb8-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-430"><a href="#cb8-430" aria-hidden="true" tabindex="-1"></a><span class="fu"># Cox et modèle de poisson  </span></span>
<span id="cb8-431"><a href="#cb8-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-432"><a href="#cb8-432" aria-hidden="true" tabindex="-1"></a>Juste une courte remarque.  </span>
<span id="cb8-433"><a href="#cb8-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-434"><a href="#cb8-434" aria-hidden="true" tabindex="-1"></a>Le modèle a été estimé par la méthode de la vraisemblance partielle. On peut montrer que le modèle de Cox est estimable à partir d’un simple modèle de Poisson. Cette estimation est appelée «***Constant Piecewise Exponential PH model***». </span>
<span id="cb8-435"><a href="#cb8-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-436"><a href="#cb8-436" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb8-437"><a href="#cb8-437" aria-hidden="true" tabindex="-1"></a>Poisson regression                              Number of obs     <span class="ot">=</span>      <span class="dv">3</span>,<span class="dv">573</span></span>
<span id="cb8-438"><a href="#cb8-438" aria-hidden="true" tabindex="-1"></a>                                                LR <span class="fu">chi2</span>(<span class="dv">90</span>)       <span class="ot">=</span>     <span class="fl">122.42</span></span>
<span id="cb8-439"><a href="#cb8-439" aria-hidden="true" tabindex="-1"></a>                                                Prob <span class="sc">&gt;</span> chi2       <span class="ot">=</span>     <span class="fl">0.0131</span></span>
<span id="cb8-440"><a href="#cb8-440" aria-hidden="true" tabindex="-1"></a>Log likelihood <span class="ot">=</span> <span class="sc">-</span><span class="fl">344.95318</span>                     Pseudo R2         <span class="ot">=</span>     <span class="fl">0.1507</span></span>
<span id="cb8-441"><a href="#cb8-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-442"><a href="#cb8-442" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb8-443"><a href="#cb8-443" aria-hidden="true" tabindex="-1"></a>          _d <span class="sc">|</span>      Coef.   Std. Err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% Conf. Interval]</span>
<span id="cb8-444"><a href="#cb8-444" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb8-445"><a href="#cb8-445" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">1195204</span>    .<span class="dv">067374</span>    <span class="sc">-</span><span class="fl">1.77</span>   <span class="fl">0.076</span>     <span class="sc">-</span>.<span class="dv">251571</span>    .<span class="dv">0125302</span></span>
<span id="cb8-446"><a href="#cb8-446" aria-hidden="true" tabindex="-1"></a>         age <span class="sc">|</span>   .<span class="dv">0295531</span>    .<span class="dv">013535</span>     <span class="fl">2.18</span>   <span class="fl">0.029</span>      .<span class="dv">003025</span>    .<span class="dv">0560811</span></span>
<span id="cb8-447"><a href="#cb8-447" aria-hidden="true" tabindex="-1"></a>     surgery <span class="sc">|</span>    <span class="sc">-</span>.<span class="dv">98486</span>   .<span class="dv">4363162</span>    <span class="sc">-</span><span class="fl">2.26</span>   <span class="fl">0.024</span>    <span class="sc">-</span><span class="fl">1.840024</span>   <span class="sc">-</span>.<span class="dv">1296961</span></span>
<span id="cb8-448"><a href="#cb8-448" aria-hidden="true" tabindex="-1"></a>             <span class="sc">|</span></span>
<span id="cb8-449"><a href="#cb8-449" aria-hidden="true" tabindex="-1"></a>       stime <span class="sc">|</span></span>
<span id="cb8-450"><a href="#cb8-450" aria-hidden="true" tabindex="-1"></a>          <span class="dv">2</span>  <span class="sc">|</span>   .<span class="dv">4223592</span>   <span class="fl">1.154708</span>     <span class="fl">0.37</span>   <span class="fl">0.715</span>    <span class="sc">-</span><span class="fl">1.840826</span>    <span class="fl">2.685544</span></span>
<span id="cb8-451"><a href="#cb8-451" aria-hidden="true" tabindex="-1"></a>          <span class="dv">3</span>  <span class="sc">|</span>   .<span class="dv">0495983</span>   <span class="fl">1.154704</span>     <span class="fl">0.04</span>   <span class="fl">0.966</span>     <span class="sc">-</span><span class="fl">2.21358</span>    <span class="fl">2.312776</span></span>
<span id="cb8-452"><a href="#cb8-452" aria-hidden="true" tabindex="-1"></a>          <span class="dv">5</span>  <span class="sc">|</span>   <span class="sc">-</span>.<span class="dv">828855</span>   <span class="fl">1.224781</span>    <span class="sc">-</span><span class="fl">0.68</span>   <span class="fl">0.499</span>    <span class="sc">-</span><span class="fl">3.229383</span>    <span class="fl">1.571673</span></span>
<span id="cb8-453"><a href="#cb8-453" aria-hidden="true" tabindex="-1"></a>          <span class="dv">6</span>  <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">9922643</span>   <span class="fl">1.224779</span>    <span class="sc">-</span><span class="fl">0.81</span>   <span class="fl">0.418</span>    <span class="sc">-</span><span class="fl">3.392786</span>    <span class="fl">1.408258</span></span>
<span id="cb8-454"><a href="#cb8-454" aria-hidden="true" tabindex="-1"></a>          <span class="dv">8</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">1.940546</span>   <span class="fl">1.414215</span>    <span class="sc">-</span><span class="fl">1.37</span>   <span class="fl">0.170</span>    <span class="sc">-</span><span class="fl">4.712356</span>    .<span class="dv">8312648</span></span>
<span id="cb8-455"><a href="#cb8-455" aria-hidden="true" tabindex="-1"></a>          <span class="dv">9</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">2.03868</span>   <span class="fl">1.414233</span>    <span class="sc">-</span><span class="fl">1.44</span>   <span class="fl">0.149</span>    <span class="sc">-</span><span class="fl">4.810526</span>    .<span class="dv">7331649</span></span>
<span id="cb8-456"><a href="#cb8-456" aria-hidden="true" tabindex="-1"></a>         <span class="dv">11</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">12.59255</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.995</span>     <span class="sc">-</span><span class="fl">4285.23</span>    <span class="fl">4260.045</span></span>
<span id="cb8-457"><a href="#cb8-457" aria-hidden="true" tabindex="-1"></a>         <span class="dv">12</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">2.30438</span>   <span class="fl">1.414226</span>    <span class="sc">-</span><span class="fl">1.63</span>   <span class="fl">0.103</span>    <span class="sc">-</span><span class="fl">5.076213</span>    .<span class="dv">4674526</span></span>
<span id="cb8-458"><a href="#cb8-458" aria-hidden="true" tabindex="-1"></a>         <span class="dv">16</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">1.481512</span>   <span class="fl">1.154713</span>    <span class="sc">-</span><span class="fl">1.28</span>   <span class="fl">0.199</span>    <span class="sc">-</span><span class="fl">3.744708</span>    .<span class="dv">7816839</span></span>
<span id="cb8-459"><a href="#cb8-459" aria-hidden="true" tabindex="-1"></a>         <span class="dv">17</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">2.591968</span>    <span class="fl">1.41426</span>    <span class="sc">-</span><span class="fl">1.83</span>   <span class="fl">0.067</span>    <span class="sc">-</span><span class="fl">5.363868</span>    .<span class="dv">1799312</span></span>
<span id="cb8-460"><a href="#cb8-460" aria-hidden="true" tabindex="-1"></a>         <span class="dv">18</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">2.642535</span>   <span class="fl">1.414254</span>    <span class="sc">-</span><span class="fl">1.87</span>   <span class="fl">0.062</span>    <span class="sc">-</span><span class="fl">5.414421</span>    .<span class="dv">1293516</span></span>
<span id="cb8-461"><a href="#cb8-461" aria-hidden="true" tabindex="-1"></a>         <span class="dv">21</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">2.095489</span>   <span class="fl">1.224819</span>    <span class="sc">-</span><span class="fl">1.71</span>   <span class="fl">0.087</span>    <span class="sc">-</span><span class="fl">4.496091</span>    .<span class="dv">3051133</span></span>
<span id="cb8-462"><a href="#cb8-462" aria-hidden="true" tabindex="-1"></a>         <span class="dv">28</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.055745</span>   <span class="fl">1.414246</span>    <span class="sc">-</span><span class="fl">2.16</span>   <span class="fl">0.031</span>    <span class="sc">-</span><span class="fl">5.827616</span>   <span class="sc">-</span>.<span class="dv">2838729</span></span>
<span id="cb8-463"><a href="#cb8-463" aria-hidden="true" tabindex="-1"></a>         <span class="dv">30</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.103495</span>    <span class="fl">1.41426</span>    <span class="sc">-</span><span class="fl">2.19</span>   <span class="fl">0.028</span>    <span class="sc">-</span><span class="fl">5.875395</span>   <span class="sc">-</span>.<span class="dv">3315961</span></span>
<span id="cb8-464"><a href="#cb8-464" aria-hidden="true" tabindex="-1"></a>         <span class="dv">31</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">13.89462</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.995</span>    <span class="sc">-</span><span class="fl">4286.532</span>    <span class="fl">4258.743</span></span>
<span id="cb8-465"><a href="#cb8-465" aria-hidden="true" tabindex="-1"></a>         <span class="dv">32</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.144133</span>   <span class="fl">1.414253</span>    <span class="sc">-</span><span class="fl">2.22</span>   <span class="fl">0.026</span>    <span class="sc">-</span><span class="fl">5.916018</span>   <span class="sc">-</span>.<span class="dv">3722474</span></span>
<span id="cb8-466"><a href="#cb8-466" aria-hidden="true" tabindex="-1"></a>         <span class="dv">35</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.219157</span>   <span class="fl">1.414258</span>    <span class="sc">-</span><span class="fl">2.28</span>   <span class="fl">0.023</span>    <span class="sc">-</span><span class="fl">5.991053</span>    <span class="sc">-</span>.<span class="dv">447262</span></span>
<span id="cb8-467"><a href="#cb8-467" aria-hidden="true" tabindex="-1"></a>         <span class="dv">36</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.227893</span>   <span class="fl">1.414267</span>    <span class="sc">-</span><span class="fl">2.28</span>   <span class="fl">0.022</span>    <span class="sc">-</span><span class="fl">5.999806</span>   <span class="sc">-</span>.<span class="dv">4559796</span></span>
<span id="cb8-468"><a href="#cb8-468" aria-hidden="true" tabindex="-1"></a>         <span class="dv">37</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.246139</span>   <span class="fl">1.414263</span>    <span class="sc">-</span><span class="fl">2.30</span>   <span class="fl">0.022</span>    <span class="sc">-</span><span class="fl">6.018042</span>   <span class="sc">-</span>.<span class="dv">4742351</span></span>
<span id="cb8-469"><a href="#cb8-469" aria-hidden="true" tabindex="-1"></a>         <span class="dv">39</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">3.26923</span>   <span class="fl">1.414303</span>    <span class="sc">-</span><span class="fl">2.31</span>   <span class="fl">0.021</span>    <span class="sc">-</span><span class="fl">6.041213</span>   <span class="sc">-</span>.<span class="dv">4972472</span></span>
<span id="cb8-470"><a href="#cb8-470" aria-hidden="true" tabindex="-1"></a>         <span class="dv">40</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">2.581465</span>   <span class="fl">1.224839</span>    <span class="sc">-</span><span class="fl">2.11</span>   <span class="fl">0.035</span>    <span class="sc">-</span><span class="fl">4.982106</span>   <span class="sc">-</span>.<span class="dv">1808239</span></span>
<span id="cb8-471"><a href="#cb8-471" aria-hidden="true" tabindex="-1"></a>         <span class="dv">43</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.311454</span>   <span class="fl">1.414341</span>    <span class="sc">-</span><span class="fl">2.34</span>   <span class="fl">0.019</span>    <span class="sc">-</span><span class="fl">6.083512</span>   <span class="sc">-</span>.<span class="dv">5393966</span></span>
<span id="cb8-472"><a href="#cb8-472" aria-hidden="true" tabindex="-1"></a>         <span class="dv">45</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.327473</span>   <span class="fl">1.414407</span>    <span class="sc">-</span><span class="fl">2.35</span>   <span class="fl">0.019</span>    <span class="sc">-</span><span class="fl">6.099661</span>   <span class="sc">-</span>.<span class="dv">5552857</span></span>
<span id="cb8-473"><a href="#cb8-473" aria-hidden="true" tabindex="-1"></a>         <span class="dv">50</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.421206</span>   <span class="fl">1.414399</span>    <span class="sc">-</span><span class="fl">2.42</span>   <span class="fl">0.016</span>    <span class="sc">-</span><span class="fl">6.193377</span>   <span class="sc">-</span>.<span class="dv">6490357</span></span>
<span id="cb8-474"><a href="#cb8-474" aria-hidden="true" tabindex="-1"></a>         <span class="dv">51</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.425081</span>   <span class="fl">1.414444</span>    <span class="sc">-</span><span class="fl">2.42</span>   <span class="fl">0.015</span>    <span class="sc">-</span><span class="fl">6.197341</span>   <span class="sc">-</span>.<span class="dv">6528208</span></span>
<span id="cb8-475"><a href="#cb8-475" aria-hidden="true" tabindex="-1"></a>         <span class="dv">53</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">3.44536</span>   <span class="fl">1.414475</span>    <span class="sc">-</span><span class="fl">2.44</span>   <span class="fl">0.015</span>     <span class="sc">-</span><span class="fl">6.21768</span>    <span class="sc">-</span>.<span class="dv">673039</span></span>
<span id="cb8-476"><a href="#cb8-476" aria-hidden="true" tabindex="-1"></a>         <span class="dv">58</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.514664</span>   <span class="fl">1.414489</span>    <span class="sc">-</span><span class="fl">2.48</span>   <span class="fl">0.013</span>    <span class="sc">-</span><span class="fl">6.287011</span>   <span class="sc">-</span>.<span class="dv">7423175</span></span>
<span id="cb8-477"><a href="#cb8-477" aria-hidden="true" tabindex="-1"></a>         <span class="dv">61</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.543748</span>   <span class="fl">1.414557</span>    <span class="sc">-</span><span class="fl">2.51</span>   <span class="fl">0.012</span>    <span class="sc">-</span><span class="fl">6.316229</span>   <span class="sc">-</span>.<span class="dv">7712681</span></span>
<span id="cb8-478"><a href="#cb8-478" aria-hidden="true" tabindex="-1"></a>         <span class="dv">66</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.602062</span>   <span class="fl">1.414546</span>    <span class="sc">-</span><span class="fl">2.55</span>   <span class="fl">0.011</span>    <span class="sc">-</span><span class="fl">6.374522</span>   <span class="sc">-</span>.<span class="dv">8296028</span></span>
<span id="cb8-479"><a href="#cb8-479" aria-hidden="true" tabindex="-1"></a>         <span class="dv">68</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">2.90779</span>   <span class="fl">1.225106</span>    <span class="sc">-</span><span class="fl">2.37</span>   <span class="fl">0.018</span>    <span class="sc">-</span><span class="fl">5.308954</span>   <span class="sc">-</span>.<span class="dv">5066257</span></span>
<span id="cb8-480"><a href="#cb8-480" aria-hidden="true" tabindex="-1"></a>         <span class="dv">69</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.580111</span>   <span class="fl">1.414549</span>    <span class="sc">-</span><span class="fl">2.53</span>   <span class="fl">0.011</span>    <span class="sc">-</span><span class="fl">6.352577</span>   <span class="sc">-</span>.<span class="dv">8076461</span></span>
<span id="cb8-481"><a href="#cb8-481" aria-hidden="true" tabindex="-1"></a>         <span class="dv">72</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">2.914206</span>    <span class="fl">1.22505</span>    <span class="sc">-</span><span class="fl">2.38</span>   <span class="fl">0.017</span>     <span class="sc">-</span><span class="fl">5.31526</span>   <span class="sc">-</span>.<span class="dv">5131524</span></span>
<span id="cb8-482"><a href="#cb8-482" aria-hidden="true" tabindex="-1"></a>         <span class="dv">77</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.624716</span>   <span class="fl">1.414601</span>    <span class="sc">-</span><span class="fl">2.56</span>   <span class="fl">0.010</span>    <span class="sc">-</span><span class="fl">6.397284</span>   <span class="sc">-</span>.<span class="dv">8521489</span></span>
<span id="cb8-483"><a href="#cb8-483" aria-hidden="true" tabindex="-1"></a>         <span class="dv">78</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.593983</span>   <span class="fl">1.414779</span>    <span class="sc">-</span><span class="fl">2.54</span>   <span class="fl">0.011</span>    <span class="sc">-</span><span class="fl">6.366898</span>   <span class="sc">-</span>.<span class="dv">8210686</span></span>
<span id="cb8-484"><a href="#cb8-484" aria-hidden="true" tabindex="-1"></a>         <span class="dv">80</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.597845</span>   <span class="fl">1.414765</span>    <span class="sc">-</span><span class="fl">2.54</span>   <span class="fl">0.011</span>    <span class="sc">-</span><span class="fl">6.370734</span>   <span class="sc">-</span>.<span class="dv">8249558</span></span>
<span id="cb8-485"><a href="#cb8-485" aria-hidden="true" tabindex="-1"></a>         <span class="dv">81</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.589639</span>   <span class="fl">1.414745</span>    <span class="sc">-</span><span class="fl">2.54</span>   <span class="fl">0.011</span>    <span class="sc">-</span><span class="fl">6.362489</span>   <span class="sc">-</span>.<span class="dv">8167895</span></span>
<span id="cb8-486"><a href="#cb8-486" aria-hidden="true" tabindex="-1"></a>         <span class="dv">85</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.598044</span>   <span class="fl">1.414948</span>    <span class="sc">-</span><span class="fl">2.54</span>   <span class="fl">0.011</span>    <span class="sc">-</span><span class="fl">6.371291</span>    <span class="sc">-</span>.<span class="dv">824798</span></span>
<span id="cb8-487"><a href="#cb8-487" aria-hidden="true" tabindex="-1"></a>         <span class="dv">90</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">3.62163</span>   <span class="fl">1.415099</span>    <span class="sc">-</span><span class="fl">2.56</span>   <span class="fl">0.010</span>    <span class="sc">-</span><span class="fl">6.395173</span>   <span class="sc">-</span>.<span class="dv">8480873</span></span>
<span id="cb8-488"><a href="#cb8-488" aria-hidden="true" tabindex="-1"></a>         <span class="dv">96</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.658159</span>   <span class="fl">1.415134</span>    <span class="sc">-</span><span class="fl">2.59</span>   <span class="fl">0.010</span>     <span class="sc">-</span><span class="fl">6.43177</span>    <span class="sc">-</span>.<span class="dv">884548</span></span>
<span id="cb8-489"><a href="#cb8-489" aria-hidden="true" tabindex="-1"></a>        <span class="dv">100</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.672641</span>   <span class="fl">1.415162</span>    <span class="sc">-</span><span class="fl">2.60</span>   <span class="fl">0.009</span>    <span class="sc">-</span><span class="fl">6.446308</span>   <span class="sc">-</span>.<span class="dv">8989739</span></span>
<span id="cb8-490"><a href="#cb8-490" aria-hidden="true" tabindex="-1"></a>        <span class="dv">102</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.662767</span>   <span class="fl">1.415232</span>    <span class="sc">-</span><span class="fl">2.59</span>   <span class="fl">0.010</span>    <span class="sc">-</span><span class="fl">6.436571</span>   <span class="sc">-</span>.<span class="dv">8889631</span></span>
<span id="cb8-491"><a href="#cb8-491" aria-hidden="true" tabindex="-1"></a>        <span class="dv">109</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">14.65089</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.995</span>    <span class="sc">-</span><span class="fl">4287.288</span>    <span class="fl">4257.986</span></span>
<span id="cb8-492"><a href="#cb8-492" aria-hidden="true" tabindex="-1"></a>        <span class="dv">110</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.704316</span>   <span class="fl">1.415125</span>    <span class="sc">-</span><span class="fl">2.62</span>   <span class="fl">0.009</span>     <span class="sc">-</span><span class="fl">6.47791</span>   <span class="sc">-</span>.<span class="dv">9307209</span></span>
<span id="cb8-493"><a href="#cb8-493" aria-hidden="true" tabindex="-1"></a>        <span class="dv">131</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">14.68697</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.995</span>    <span class="sc">-</span><span class="fl">4287.324</span>     <span class="fl">4257.95</span></span>
<span id="cb8-494"><a href="#cb8-494" aria-hidden="true" tabindex="-1"></a>        <span class="dv">149</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.976368</span>   <span class="fl">1.415012</span>    <span class="sc">-</span><span class="fl">2.81</span>   <span class="fl">0.005</span>    <span class="sc">-</span><span class="fl">6.749742</span>   <span class="sc">-</span><span class="fl">1.202995</span></span>
<span id="cb8-495"><a href="#cb8-495" aria-hidden="true" tabindex="-1"></a>        <span class="dv">153</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">3.97938</span>   <span class="fl">1.414995</span>    <span class="sc">-</span><span class="fl">2.81</span>   <span class="fl">0.005</span>    <span class="sc">-</span><span class="fl">6.752718</span>   <span class="sc">-</span><span class="fl">1.206041</span></span>
<span id="cb8-496"><a href="#cb8-496" aria-hidden="true" tabindex="-1"></a>        <span class="dv">165</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.013449</span>   <span class="fl">1.415156</span>    <span class="sc">-</span><span class="fl">2.84</span>   <span class="fl">0.005</span>    <span class="sc">-</span><span class="fl">6.787104</span>   <span class="sc">-</span><span class="fl">1.239793</span></span>
<span id="cb8-497"><a href="#cb8-497" aria-hidden="true" tabindex="-1"></a>        <span class="dv">180</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">15.09339</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4287.731</span>    <span class="fl">4257.544</span></span>
<span id="cb8-498"><a href="#cb8-498" aria-hidden="true" tabindex="-1"></a>        <span class="dv">186</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.112806</span>   <span class="fl">1.414994</span>    <span class="sc">-</span><span class="fl">2.91</span>   <span class="fl">0.004</span>    <span class="sc">-</span><span class="fl">6.886144</span>   <span class="sc">-</span><span class="fl">1.339468</span></span>
<span id="cb8-499"><a href="#cb8-499" aria-hidden="true" tabindex="-1"></a>        <span class="dv">188</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">4.11316</span>   <span class="fl">1.414915</span>    <span class="sc">-</span><span class="fl">2.91</span>   <span class="fl">0.004</span>    <span class="sc">-</span><span class="fl">6.886342</span>   <span class="sc">-</span><span class="fl">1.339978</span></span>
<span id="cb8-500"><a href="#cb8-500" aria-hidden="true" tabindex="-1"></a>        <span class="dv">207</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.178467</span>   <span class="fl">1.414929</span>    <span class="sc">-</span><span class="fl">2.95</span>   <span class="fl">0.003</span>    <span class="sc">-</span><span class="fl">6.951678</span>   <span class="sc">-</span><span class="fl">1.405256</span></span>
<span id="cb8-501"><a href="#cb8-501" aria-hidden="true" tabindex="-1"></a>        <span class="dv">219</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.206547</span>    <span class="fl">1.41493</span>    <span class="sc">-</span><span class="fl">2.97</span>   <span class="fl">0.003</span>     <span class="sc">-</span><span class="fl">6.97976</span>   <span class="sc">-</span><span class="fl">1.433334</span></span>
<span id="cb8-502"><a href="#cb8-502" aria-hidden="true" tabindex="-1"></a>        <span class="dv">263</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.342286</span>   <span class="fl">1.415099</span>    <span class="sc">-</span><span class="fl">3.07</span>   <span class="fl">0.002</span>     <span class="sc">-</span><span class="fl">7.11583</span>   <span class="sc">-</span><span class="fl">1.568742</span></span>
<span id="cb8-503"><a href="#cb8-503" aria-hidden="true" tabindex="-1"></a>        <span class="dv">265</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">16.10078</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4288.738</span>    <span class="fl">4256.536</span></span>
<span id="cb8-504"><a href="#cb8-504" aria-hidden="true" tabindex="-1"></a>        <span class="dv">285</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">3.688074</span>   <span class="fl">1.225534</span>    <span class="sc">-</span><span class="fl">3.01</span>   <span class="fl">0.003</span>    <span class="sc">-</span><span class="fl">6.090076</span>   <span class="sc">-</span><span class="fl">1.286072</span></span>
<span id="cb8-505"><a href="#cb8-505" aria-hidden="true" tabindex="-1"></a>        <span class="dv">308</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.409256</span>   <span class="fl">1.414925</span>    <span class="sc">-</span><span class="fl">3.12</span>   <span class="fl">0.002</span>    <span class="sc">-</span><span class="fl">7.182459</span>   <span class="sc">-</span><span class="fl">1.636054</span></span>
<span id="cb8-506"><a href="#cb8-506" aria-hidden="true" tabindex="-1"></a>        <span class="dv">334</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.432237</span>   <span class="fl">1.415143</span>    <span class="sc">-</span><span class="fl">3.13</span>   <span class="fl">0.002</span>    <span class="sc">-</span><span class="fl">7.205866</span>   <span class="sc">-</span><span class="fl">1.658607</span></span>
<span id="cb8-507"><a href="#cb8-507" aria-hidden="true" tabindex="-1"></a>        <span class="dv">340</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.422918</span>   <span class="fl">1.415095</span>    <span class="sc">-</span><span class="fl">3.13</span>   <span class="fl">0.002</span>    <span class="sc">-</span><span class="fl">7.196453</span>   <span class="sc">-</span><span class="fl">1.649383</span></span>
<span id="cb8-508"><a href="#cb8-508" aria-hidden="true" tabindex="-1"></a>        <span class="dv">342</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.365805</span>    <span class="fl">1.41511</span>    <span class="sc">-</span><span class="fl">3.09</span>   <span class="fl">0.002</span>     <span class="sc">-</span><span class="fl">7.13937</span>   <span class="sc">-</span><span class="fl">1.592239</span></span>
<span id="cb8-509"><a href="#cb8-509" aria-hidden="true" tabindex="-1"></a>        <span class="dv">370</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">16.64142</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.279</span>    <span class="fl">4255.996</span></span>
<span id="cb8-510"><a href="#cb8-510" aria-hidden="true" tabindex="-1"></a>        <span class="dv">397</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">16.53454</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.172</span>    <span class="fl">4256.103</span></span>
<span id="cb8-511"><a href="#cb8-511" aria-hidden="true" tabindex="-1"></a>        <span class="dv">427</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">16.28492</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4288.922</span>    <span class="fl">4256.352</span></span>
<span id="cb8-512"><a href="#cb8-512" aria-hidden="true" tabindex="-1"></a>        <span class="dv">445</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">16.76689</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.404</span>     <span class="fl">4255.87</span></span>
<span id="cb8-513"><a href="#cb8-513" aria-hidden="true" tabindex="-1"></a>        <span class="dv">482</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">15.8041</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4288.441</span>    <span class="fl">4256.833</span></span>
<span id="cb8-514"><a href="#cb8-514" aria-hidden="true" tabindex="-1"></a>        <span class="dv">515</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">16.91429</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.552</span>    <span class="fl">4255.723</span></span>
<span id="cb8-515"><a href="#cb8-515" aria-hidden="true" tabindex="-1"></a>        <span class="dv">545</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">16.10426</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4288.742</span>    <span class="fl">4256.533</span></span>
<span id="cb8-516"><a href="#cb8-516" aria-hidden="true" tabindex="-1"></a>        <span class="dv">583</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.641434</span>   <span class="fl">1.415524</span>    <span class="sc">-</span><span class="fl">3.28</span>   <span class="fl">0.001</span>     <span class="sc">-</span><span class="fl">7.41581</span>   <span class="sc">-</span><span class="fl">1.867057</span></span>
<span id="cb8-517"><a href="#cb8-517" aria-hidden="true" tabindex="-1"></a>        <span class="dv">596</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">16.41019</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.047</span>    <span class="fl">4256.227</span></span>
<span id="cb8-518"><a href="#cb8-518" aria-hidden="true" tabindex="-1"></a>        <span class="dv">620</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">17.07029</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.708</span>    <span class="fl">4255.567</span></span>
<span id="cb8-519"><a href="#cb8-519" aria-hidden="true" tabindex="-1"></a>        <span class="dv">670</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">17.14785</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.785</span>    <span class="fl">4255.489</span></span>
<span id="cb8-520"><a href="#cb8-520" aria-hidden="true" tabindex="-1"></a>        <span class="dv">675</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.631958</span>   <span class="fl">1.416377</span>    <span class="sc">-</span><span class="fl">3.27</span>   <span class="fl">0.001</span>    <span class="sc">-</span><span class="fl">7.408006</span>   <span class="sc">-</span><span class="fl">1.855911</span></span>
<span id="cb8-521"><a href="#cb8-521" aria-hidden="true" tabindex="-1"></a>        <span class="dv">733</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">4.60698</span>   <span class="fl">1.416405</span>    <span class="sc">-</span><span class="fl">3.25</span>   <span class="fl">0.001</span>    <span class="sc">-</span><span class="fl">7.383082</span>   <span class="sc">-</span><span class="fl">1.830878</span></span>
<span id="cb8-522"><a href="#cb8-522" aria-hidden="true" tabindex="-1"></a>        <span class="dv">841</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">17.05138</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.689</span>    <span class="fl">4255.586</span></span>
<span id="cb8-523"><a href="#cb8-523" aria-hidden="true" tabindex="-1"></a>        <span class="dv">852</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.566243</span>   <span class="fl">1.417712</span>    <span class="sc">-</span><span class="fl">3.22</span>   <span class="fl">0.001</span>    <span class="sc">-</span><span class="fl">7.344907</span>   <span class="sc">-</span><span class="fl">1.787579</span></span>
<span id="cb8-524"><a href="#cb8-524" aria-hidden="true" tabindex="-1"></a>        <span class="dv">915</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">17.40169</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4290.039</span>    <span class="fl">4255.236</span></span>
<span id="cb8-525"><a href="#cb8-525" aria-hidden="true" tabindex="-1"></a>        <span class="dv">941</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">17.34105</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.978</span>    <span class="fl">4255.296</span></span>
<span id="cb8-526"><a href="#cb8-526" aria-hidden="true" tabindex="-1"></a>        <span class="dv">979</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.426862</span>   <span class="fl">1.419414</span>    <span class="sc">-</span><span class="fl">3.12</span>   <span class="fl">0.002</span>    <span class="sc">-</span><span class="fl">7.208862</span>   <span class="sc">-</span><span class="fl">1.644862</span></span>
<span id="cb8-527"><a href="#cb8-527" aria-hidden="true" tabindex="-1"></a>        <span class="dv">995</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.401387</span>   <span class="fl">1.418922</span>    <span class="sc">-</span><span class="fl">3.10</span>   <span class="fl">0.002</span>    <span class="sc">-</span><span class="fl">7.182422</span>   <span class="sc">-</span><span class="fl">1.620352</span></span>
<span id="cb8-528"><a href="#cb8-528" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1032</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.390393</span>   <span class="fl">1.418666</span>    <span class="sc">-</span><span class="fl">3.09</span>   <span class="fl">0.002</span>    <span class="sc">-</span><span class="fl">7.170928</span>   <span class="sc">-</span><span class="fl">1.609859</span></span>
<span id="cb8-529"><a href="#cb8-529" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1141</span>  <span class="sc">|</span>   <span class="sc">-</span><span class="fl">16.4898</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.127</span>    <span class="fl">4256.148</span></span>
<span id="cb8-530"><a href="#cb8-530" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1321</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">17.02179</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.659</span>    <span class="fl">4255.616</span></span>
<span id="cb8-531"><a href="#cb8-531" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1386</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">4.427898</span>    <span class="fl">1.41857</span>    <span class="sc">-</span><span class="fl">3.12</span>   <span class="fl">0.002</span>    <span class="sc">-</span><span class="fl">7.208243</span>   <span class="sc">-</span><span class="fl">1.647553</span></span>
<span id="cb8-532"><a href="#cb8-532" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1400</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">17.74095</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4290.378</span>    <span class="fl">4254.896</span></span>
<span id="cb8-533"><a href="#cb8-533" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1407</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">17.17352</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.994</span>    <span class="sc">-</span><span class="fl">4289.811</span>    <span class="fl">4255.464</span></span>
<span id="cb8-534"><a href="#cb8-534" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1571</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">18.15173</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.993</span>    <span class="sc">-</span><span class="fl">4290.789</span>    <span class="fl">4254.486</span></span>
<span id="cb8-535"><a href="#cb8-535" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1586</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">18.39765</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.993</span>    <span class="sc">-</span><span class="fl">4291.035</span>     <span class="fl">4254.24</span></span>
<span id="cb8-536"><a href="#cb8-536" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1799</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">18.08037</span>   <span class="fl">2179.957</span>    <span class="sc">-</span><span class="fl">0.01</span>   <span class="fl">0.993</span>    <span class="sc">-</span><span class="fl">4290.718</span>    <span class="fl">4254.557</span></span>
<span id="cb8-537"><a href="#cb8-537" aria-hidden="true" tabindex="-1"></a>             <span class="sc">|</span></span>
<span id="cb8-538"><a href="#cb8-538" aria-hidden="true" tabindex="-1"></a>       _cons <span class="sc">|</span>   <span class="fl">2.482922</span>   <span class="fl">4.946271</span>     <span class="fl">0.50</span>   <span class="fl">0.616</span>    <span class="sc">-</span><span class="fl">7.211591</span>    <span class="fl">12.17744</span></span>
<span id="cb8-539"><a href="#cb8-539" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ln</span>(stime) <span class="sc">|</span>          <span class="dv">1</span>  (exposure)</span>
<span id="cb8-540"><a href="#cb8-540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Marc Thévenin - Ined-Sms - Octobre 2022</div>
  </div>
</footer>



</body></html>