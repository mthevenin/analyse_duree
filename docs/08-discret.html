<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction à l’analyse biographique des durées - 9&nbsp; Modèle à durée discrète</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./09-tvc.html" rel="next">
<link href="./07-cox.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./06-intro_mod.html">Modèles à risques proportionnels</a></li><li class="breadcrumb-item"><a href="./08-discret.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">**Modèle à durée discrète**</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction à l’analyse biographique des durées</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/mthevenin/analyse_duree" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./introduction_bio_durees.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title"><strong>Présentation - Bibliographie - Outils</strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-presentation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title"><strong>L’analyse biographique des durées</strong></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Données et théorie</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-donnees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title"><strong>Les Données</strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title"><strong>La théorie</strong></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Méthodes non paramétrique</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-fsurvie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title"><strong>Estimations des fonctions de survie</strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-fsurvie_comp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title"><strong>Tests de comparaison</strong></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Modèles à risques proportionnels</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-intro_mod.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title"><strong>Introduction</strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-cox.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title"><strong>Le modèle de Cox</strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-discret.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title"><strong>Modèle à durée discrète</strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-tvc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title"><strong>Variables dynamiques</strong></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">Compléments</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-manipulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title"><strong>Eléments de mise en forme des données</strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-concurrent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title"><strong>Risques concurrents</strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-parametrique.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title"><strong>Modèles paramétriques</strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-annexe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title"><strong>Annexes</strong></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Programmation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title"><strong>R</strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-Stata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title"><strong>Stata</strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-Sas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title"><strong>SAS</strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-Python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title"><strong>Python</strong></span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sections</h2>
   
  <ul>
  <li><a href="#organisation-des-données" id="toc-organisation-des-données" class="nav-link active" data-scroll-target="#organisation-des-données"><span class="header-section-number">9.1</span> Organisation des données</a></li>
  <li><a href="#ajustement-de-la-durée" id="toc-ajustement-de-la-durée" class="nav-link" data-scroll-target="#ajustement-de-la-durée"><span class="header-section-number">9.2</span> Ajustement de la durée</a>
  <ul class="collapse">
  <li><a href="#ajustement-avec-une-durée-en-continu" id="toc-ajustement-avec-une-durée-en-continu" class="nav-link" data-scroll-target="#ajustement-avec-une-durée-en-continu"><span class="header-section-number">9.2.1</span> Ajustement avec une durée en continu</a></li>
  <li><a href="#ajustement-discret" id="toc-ajustement-discret" class="nav-link" data-scroll-target="#ajustement-discret"><span class="header-section-number">9.2.2</span> Ajustement discret</a></li>
  </ul></li>
  <li><a href="#proportionnalité-des-risques" id="toc-proportionnalité-des-risques" class="nav-link" data-scroll-target="#proportionnalité-des-risques"><span class="header-section-number">9.3</span> Proportionnalité des risques</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/mthevenin/analyse_duree/edit/main/08-discret.qmd" class="toc-action">Modifier cette page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title"><strong>Modèle à durée discrète</strong></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>On va principalement traiter du <strong><em>modèle logistique à durée discrète</em></strong>.</p>
<ul>
<li>Par définition ce n’est pas un modèle à risques proportionnels, mais à <strong>Odds proportionnels</strong>. Toutefois en situation de rareté (p&lt;10%), l’Odds converge vers une probabilité, qui est une mesure du risque.</li>
<li>Le modèle à durée discrète est de type pleinement paramétrique, il est moins contraignant que le modèle de Cox si l’hypothèse de proportionnalité n’est pas respectée, car le modèle est ajusté par une fonction de la durée.</li>
<li>Pour être estimé, la base de données doit être transformée en format long: aux durées d’observation ou sur des intervalles de durée choisis. C’est une des principales différences avec le modèle de Cox qui est une estimation aux moments d’évènement. Néanmoins avec une bonne forme fonctionnelle de la durée traitée comme une variable quantitative, et si le nombre de points d’observation est suffisamment grand, les deux modèles aboutissent à des résultats quasiment identiques.</li>
<li>Ce modèle permet d’introduire de manière plutôt souple un ensemble de covariables no fixes.</li>
</ul>
<p>Avec un lien logistique, le modèle à durée discrète, avec seulement des covariables fixes, peut s’écrire:</p>
<p><span class="math display">\[log\left[\frac{P(Y=1\ |\ t_p,X_k)}{1-P(Y=1\ |\ t_p,X_k)}\right]= a_0 + \sum_{p}a_pf(t_p)+\sum_{k}b_kX_k\]</span></p>
<section id="organisation-des-données" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="organisation-des-données"><span class="header-section-number">9.1</span> Organisation des données</h2>
<p><strong>Format long</strong></p>
<p>Les données doivent être en format long: pour chaque individu on a une ligne par durée observée ou par intevalle de durées jusqu’à l’évènement ou la censure. On retrouve le <em>split</em> des données du modèle de Cox, mais généralisé à des intervalles où aucun évènement n’est observé. Avec des données de type discrètes ou groupées, phénomène classique en sciences sociales, il y a souvent peu de différence entre un allongement aux temps d’évènement et aux temps d’observation.<br>
<br></p>
<p><strong>Durée</strong></p>
<p>La durée est dans un premier temps construite sous forme d’un simple compteur, par exemple <span class="math inline">\(t=1,2,3,4,5...\)</span> (des valeurs non entières sont possibles). Le choix de la forme fonctionnelle de la durée sera présentée plus tard.</p>
<p><strong>Variable évènement/censure</strong></p>
<p>Si l’individu a connu l’évènement, elle prend la valeur 0 avant celui-ci. Au moment de l’évènement sa valeur est égale à 1. Pour les observations censurées, la variable prend toujours la valeur 0.</p>
<p><strong>Application</strong><br>
On reprend les données de la base <em>transplantation</em>, mais les durées ont été regroupées par période de 30 jours. Il n’y a pas de durée mesurée comme nulle, on a considéré que les 30 premiers jours représentaient, le premier mois d’exposition. Cette variable de durée se nomme <em>mois</em>.</p>
<p><strong>Format d’origine</strong></p>
<table class="table">
<caption>Durée discrète: données en format d’origine</caption>
<thead>
<tr class="header">
<th>id</th>
<th>year</th>
<th>age</th>
<th>surgery</th>
<th>mois</th>
<th>died</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>67</td>
<td>30</td>
<td>0</td>
<td>2</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>La personne décède lors du deuxième intervalle de 30 jours</p>
<p><strong>Format long et variables pour l’analyse</strong></p>
<table class="table">
<caption>Durée discrète: données en format long</caption>
<thead>
<tr class="header">
<th>id</th>
<th>year</th>
<th>age</th>
<th>surgery</th>
<th>mois</th>
<th>died</th>
<th>t</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>67</td>
<td>30</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>1</td>
<td>67</td>
<td>30</td>
<td>0</td>
<td>2</td>
<td>1</td>
<td>2</td>
</tr>
</tbody>
</table>
</section>
<section id="ajustement-de-la-durée" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="ajustement-de-la-durée"><span class="header-section-number">9.2</span> Ajustement de la durée</h2>
<p>Un des principaux enjeux réside dans la paramétrisation de la durée:</p>
<ul>
<li>Elle peut-être modélisée sous forme de fonction d’une variable de type quantitative/continue.</li>
<li>Elle peut-être modélisée comme variable discrète, de type indicatrice <span class="math inline">\({0;1}\)</span>, sur tous les points d’observation, ou sous forme de regroupements. Il doit y avoir au moins un évènement observé dans chaque intervalle.</li>
</ul>
<section id="ajustement-avec-une-durée-en-continu" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="ajustement-avec-une-durée-en-continu"><span class="header-section-number">9.2.1</span> Ajustement avec une durée en continu</h3>
<p>Le modèle étant paramétrique, on doit trouver une fonction qui ajuste le mieux les données. Toutes transformations de la variable est possible: <span class="math inline">\(f(t)=a\times t\)</span>, <span class="math inline">\(f(t)=a\times ln(t)\)</span>……formes quadratiques. Les ajustements sous forme de <strong>splines</strong> (cubiques) tendent à se développer ces dernières années.</p>
<p>Pour sélectionner cette fonction, on peut tester différents modèles sans covariable additionnelle, et sélectionner la forme dont le critère d’information de type <strong>AIC</strong> (vraisemblance pénalisée) est le plus faible.</p>
<p>Exemple:<br>
On va tester les paramétrisations suivante:s une forme linéraire stricte <span class="math inline">\(f(t)=a\times t\)</span> et des effets quadratiques d’ordres 2 et 3: <span class="math inline">\(f(t)=a_1\times t + a_2\times t^{2}\)</span> et <span class="math inline">\(f(t)=a_1\times t + a_2\times t^{2} + a_3\times t^{3}\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Image11.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Probabilité de décéder avec 3 ajustements de la durée"><img src="images/Image11.png" class="img-fluid figure-img" style="width:70.0%"></a></p>
<figcaption class="figure-caption">Probabilité de décéder avec 3 ajustements de la durée</figcaption>
</figure>
</div>
<p><strong>Critères AIC</strong></p>
<table class="table">
<thead>
<tr class="header">
<th><span class="math inline">\(f(t)\)</span></th>
<th>AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(a\times t\)</span></td>
<td>504</td>
</tr>
<tr class="even">
<td><span class="math inline">\(a_1\times t + a_2\times t^{2}\)</span></td>
<td>492</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(a_1\times t + a_2\times t^{2} + a_3\times t^{3}\)</span></td>
<td>486</td>
</tr>
</tbody>
</table>
<p>On peut utiliser la troisième forme à savoir <span class="math inline">\(a_1\times t + a_2\times t^{2} + a_3\times t^{3}\)</span>.</p>
<p><strong>Estimation du modèle avec toutes les covariables</strong></p>
<table class="table">
<caption>Modèle logistique à durée discrète (<span class="math inline">\(f(t)\)</span> continue)</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Variables</th>
<th>OR - RR</th>
<th>Std. err</th>
<th>z</th>
<th>P&gt;|z|</th>
<th>95% IC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(t\)</span></td>
<td>0.678</td>
<td>0.057</td>
<td>-4.52</td>
<td>0.000</td>
<td>0.587 ; 0.810</td>
</tr>
<tr class="even">
<td><span class="math inline">\(t^2\)</span></td>
<td>1.014</td>
<td>0.005</td>
<td>+2.83</td>
<td>0.005</td>
<td>1.004 ; 1.024</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(t^3\)</span></td>
<td>1.000</td>
<td>0.000</td>
<td>-2.11</td>
<td>0.035</td>
<td>1.000 ; 1.000</td>
</tr>
<tr class="even">
<td><span class="math inline">\(year\)</span></td>
<td>0.876</td>
<td>0.015</td>
<td>-1.80</td>
<td>0.072</td>
<td>0.758 ; 1.012</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(age\)</span></td>
<td>1.034</td>
<td>0.163</td>
<td>+2.27</td>
<td>0.023</td>
<td>1.005 ; 1.064</td>
</tr>
<tr class="even">
<td><span class="math inline">\(surgery\)</span></td>
<td>0.364</td>
<td>0.110</td>
<td>-2.25</td>
<td>0.024</td>
<td>0.151 ; 0.877</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><em>Constante</em></td>
<td><em>0.440</em></td>
<td><em>0.110</em></td>
<td><em>-3.29</em></td>
<td><em>0.001</em></td>
<td><em>0.270 ; 0.718</em></td>
</tr>
</tbody>
</table>
<p><em>Remarque</em>: les variables <em>year</em> et <em>age</em> ont été centrée sur leur moyenne pour rendre la constante interprétable. La constante reporte donc l’Odds de décéder lors des 30 premiers jours d’une personne dont l’âge et l’année à l’entrée dans le registre est égal à l’âge et à l’année moyenne et qui n’a pas été opéré préalablement.</p>
<p>Si maintenant on estime un modèle de Cox sur ces données journalières groupées, on remarque que les résultats obtenus sont très proches</p>
<table class="table">
<caption>Modèle de Cox</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Variables</th>
<th>OR - RR</th>
<th>Std. err</th>
<th>z</th>
<th>P&gt;|z|</th>
<th>95% IC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(year\)</span></td>
<td>0.878</td>
<td>0.059</td>
<td>-1.93</td>
<td>0.053</td>
<td>0.769 ; 1.002</td>
</tr>
<tr class="even">
<td><span class="math inline">\(age\)</span></td>
<td>1.029</td>
<td>0.014</td>
<td>+2.13</td>
<td>0.033</td>
<td>1.002 ; 1.057</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(surgery\)</span></td>
<td>0.379</td>
<td>0.165</td>
<td>-2.22</td>
<td>0.026</td>
<td>0.111 ; 0.892</td>
</tr>
</tbody>
</table>
</section>
<section id="ajustement-discret" class="level3" data-number="9.2.2">
<h3 data-number="9.2.2" class="anchored" data-anchor-id="ajustement-discret"><span class="header-section-number">9.2.2</span> Ajustement discret</h3>
<ul>
<li>Il s’agit d’introduire la variable de durée dans le modèle comme une variable catégorielle (indicatrices).</li>
<li>Démarche pas conseillé si on a beaucoup de points d’observation, ce qui est le cas ici.</li>
<li>A l’inverse, si peu de points d’observation la paramétrisation avec une durée continue n’est pas conseillé.</li>
<li>La correction de la non proportionnalité peut être plus compliquée à mettre en oeuvre.</li>
</ul>
<p>On va supposer que l’on ne dispose que de 4 intervalles d’observation. Pour l’exemple, on va créer ces points à partir des quartiles de la durée, et conserver pour chaque personne une seule observation par intervalle.</p>
<ul>
<li><span class="math inline">\(t=1\)</span>: Entre le début de l’exposition et 4 mois.</li>
<li><span class="math inline">\(t=2\)</span>: Entre 5 mois et 11 mois .</li>
<li><span class="math inline">\(t=3\)</span>: Entre 12 mois et 23 mois.</li>
<li><span class="math inline">\(t=4\)</span>: 24 mois et plus.</li>
</ul>
<p>On va estimer le risque globalement sur l’intervalle. La base sera plus courte que la précédente (197 observations pour 103 individus). Il ne sera plus possible ici d’interpréter les résultats en termes de rapport de probabilité, l’évènement devenant trop fréquent à l’intérieur de chaque intervalle.</p>
<table class="table">
<caption>Modèle logistique à durée discrète (<span class="math inline">\(f(t)\)</span> indicatrices)</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Variables</th>
<th>OR - RR</th>
<th>Std. err</th>
<th>z</th>
<th>P&gt;|z|</th>
<th>95% IC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(0-4 mois\)</span></td>
<td>2.811</td>
<td>1.177</td>
<td>+2.47</td>
<td>0.014</td>
<td>1.237 ; 6.387</td>
</tr>
<tr class="even">
<td><span class="math inline">\(5-11 mois\)</span></td>
<td>ref</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(12-23 mois\)</span></td>
<td>0.559</td>
<td>0.346</td>
<td>-0.94</td>
<td>0.347</td>
<td>0.166 ; 1.881</td>
</tr>
<tr class="even">
<td><span class="math inline">\(24-46 mois\)</span></td>
<td>1.741</td>
<td>1.159</td>
<td>+0.83</td>
<td>0.405</td>
<td>0.472 ; 6.417</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(year\)</span></td>
<td>0.816</td>
<td>0.076</td>
<td>-2.18</td>
<td>0.029</td>
<td>0.680 ; 0.980</td>
</tr>
<tr class="even">
<td><span class="math inline">\(age\)</span></td>
<td>1.048</td>
<td>0.019</td>
<td>+2.53</td>
<td>0.011</td>
<td>1.011 ; 1.087</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(surgery\)</span></td>
<td>0.330</td>
<td>0.166</td>
<td>-2.21</td>
<td>0.027</td>
<td>0.123 ; 0.882</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><em>Constante</em></td>
<td><em>0.407</em></td>
<td><em>0.151</em></td>
<td><em>2.43</em></td>
<td><em>0.015</em></td>
<td><em>0.198 ; 0.840</em></td>
</tr>
</tbody>
</table>
<p>On trouve des résultats proches de ceux éstimés avec un ajustement continu de la durée. C’est normal, la dirée fait office de variable d’ajustement peu ou pas corrélée avec les autres variables introduites.</p>
<table class="table">
<thead>
<tr class="header">
<th>Variables</th>
<th>Ajustement discret</th>
<th>Ajustement continu</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(year\)</span></td>
<td>0.816</td>
<td>0.876</td>
</tr>
<tr class="even">
<td><span class="math inline">\(age\)</span></td>
<td>1.048</td>
<td>1.034</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(surgery\)</span></td>
<td>0.330</td>
<td>0.364</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Lien avec des modèles usuels à durée continue
</div>
</div>
<div class="callout-body-container callout-body">
<p>Si la durée discrète/groupé sous tend une durée continue (ce qui est le cas ici):</p>
<ul>
<li>L’ajustement avec des indicatrices correspond au modèle à durée discrète défini par Cox, et le plus proche du modèle semi-paramétrique. Il est également assimilable à un modèle de type <em>exponential piecewice constant</em> (cf modèle de poisson)</li>
<li>Si l’ajustement se fait en utilisation une transformation de la durée par une fonction:
<ul>
<li><span class="math inline">\(f(t)= log(t)\)</span> correspond à un modèle de Weibull de type <em>risque proportionnel</em> <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</li>
</ul></li>
<li>Si l’ajustement se fait avec des splines cubiques, le modèle à durée discrète correspond à un modèle de type <em>Parmar-Royston</em>. Si on utilise une forme quadratique standard et bien ajustée, on obtient également cette correspondance.</li>
</ul>
</div>
</div>
</section>
</section>
<section id="proportionnalité-des-risques" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="proportionnalité-des-risques"><span class="header-section-number">9.3</span> Proportionnalité des risques</h2>
<ul>
<li><p>Formellement un modèle logistique à temps discret repose sur une hypothèse d’Odds proportionnel [Odds ratios constants pendant la durée d’observation]. Contrairement au modèle de Cox, l’estimation des probabilités (risque) n’est pas biaisée si l’hypothèse PH n’est pas respectée, les paramètres estimés sont considérés au pire comme des approximation.</p></li>
<li><p>Comme pour le modèle de Cox, la correction de la non proportionnalité peut se faire en intégrant une interaction avec la durée dans le modèle.</p></li>
</ul>
<p>Avec un ajustement continue, on remarque de nouveau que le résultat du modèle est de nouveau très proche de celui estimé avec un modèle de Cox.</p>
<table class="table">
<caption>Modèle logistique à durée discrète avec correction de la non proportionnalité</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th>Variables</th>
<th>OR - RR</th>
<th>Std. err</th>
<th>z</th>
<th>P&gt;|z|</th>
<th>95% CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(t\)</span></td>
<td>0.702</td>
<td>0.059</td>
<td>-4.2</td>
<td>0.000</td>
<td>0.595 ; 0.828</td>
</tr>
<tr class="even">
<td><span class="math inline">\(surgery(t=0)\)</span></td>
<td>0.155</td>
<td>0.108</td>
<td>-2.67</td>
<td>0.008</td>
<td>0.039 ; 0.609</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(surgery\times t\)</span></td>
<td>1.072</td>
<td>0.036</td>
<td>2.08</td>
<td>0.037</td>
<td>1.004 ; 1.145</td>
</tr>
<tr class="even">
<td><span class="math inline">\(t^2\)</span></td>
<td>1.013</td>
<td>0.005</td>
<td>2.37</td>
<td>0.018</td>
<td>1.002 ; 1.023</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(t^3\)</span></td>
<td>1.00</td>
<td>0.000</td>
<td>-1.71</td>
<td>0.086</td>
<td>1.000 ; 1.000</td>
</tr>
<tr class="even">
<td><span class="math inline">\(year\)</span></td>
<td>0.872</td>
<td>0.064</td>
<td>-1.86</td>
<td>0.062</td>
<td>0.755 ; 1.007</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(age\)</span></td>
<td>1.033</td>
<td>0.015</td>
<td>2.23</td>
<td>0.026</td>
<td>1.004 ; 1.063</td>
</tr>
<tr class="even">
<td><span class="math inline">\(constante\)</span></td>
<td><em>0.445</em></td>
<td><em>0.112</em></td>
<td><em>-3.22</em></td>
<td><em>0.001</em></td>
<td><em>0.272 ; 0.728</em></td>
</tr>
</tbody>
</table>
<p>Si on avait omis les variables <em>year</em> et <em>age</em> du modèle:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Image13.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Probabilité de décéder après correction de la non proportionnalité pour la variable surgery"><img src="images/Image13.png" class="img-fluid figure-img" style="width:70.0%"></a></p>
<figcaption class="figure-caption">Probabilité de décéder après correction de la non proportionnalité pour la variable surgery</figcaption>
</figure>
</div>


<!-- -->

</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>voir la courte section sur les modèle paramétriques usuels<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./07-cox.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title"><strong>Le modèle de Cox</strong></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./09-tvc.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title"><strong>Variables dynamiques</strong></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Code source</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb1" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#title: "**Modèle à durée discrète**"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="an">filters:</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">  - lightbox</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="an">lightbox:</span><span class="co"> auto</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu"># **Modèle à durée discrète**</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>On va principalement traiter du ***modèle logistique à durée discrète***.   </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Par définition ce n’est pas un modèle à risques proportionnels, mais à **Odds proportionnels**. Toutefois en situation de rareté (p&lt;10%), l’Odds converge vers une probabilité, qui est une mesure du risque.</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Le modèle à durée discrète est de type pleinement paramétrique, il est moins contraignant que le modèle de Cox si l’hypothèse de proportionnalité n’est pas respectée, car le modèle est ajusté par une fonction de la durée.</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Pour être estimé, la base de données doit être transformée en format long: aux durées d’observation ou sur des intervalles de durée  choisis. C’est une des principales différences avec le modèle de Cox qui est une estimation aux moments d’évènement. Néanmoins avec une bonne forme fonctionnelle de la durée traitée comme une variable quantitative, et si le nombre de points d'observation est suffisamment grand, les deux modèles aboutissent à des résultats quasiment identiques.</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Ce modèle permet d’introduire de manière plutôt souple un ensemble de covariables no fixes.</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>Avec un lien logistique, le modèle à durée discrète, avec seulement des covariables fixes, peut s'écrire:   </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>$$log\left<span class="co">[</span><span class="ot">\frac{P(Y=1\ |\ t_p,X_k)}{1-P(Y=1\ |\ t_p,X_k)}\right</span><span class="co">]</span>= a_0 + \sum_{p}a_pf(t_p)+\sum_{k}b_kX_k$$</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">## Organisation des données</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>**Format long**   </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>Les données doivent être en format long: pour chaque individu on a une ligne par durée observée ou par intevalle de durées jusqu'à l'évènement ou la censure. On retrouve le  *split* des données du modèle de Cox, mais généralisé à des intervalles où aucun évènement n'est observé. Avec des données de type discrètes ou groupées, phénomène classique en sciences sociales, il y a souvent peu de différence entre un allongement aux temps d'évènement et aux temps d'observation.  </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>**Durée**  </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>La durée est dans un premier temps construite sous forme d'un simple compteur, par exemple $t=1,2,3,4,5...$ (des valeurs non entières sont possibles). Le choix de la forme fonctionnelle de la durée sera présentée plus tard.  </span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>**Variable évènement/censure**  </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>Si l'individu a connu l'évènement, elle prend la valeur 0 avant celui-ci. Au moment de l'évènement sa valeur est égale à 1. Pour les observations censurées, la variable prend toujours la valeur 0.</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>**Application**  </span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>On reprend les données de la base *transplantation*, mais les durées ont été regroupées par période de 30 jours. Il n’y a pas de durée mesurée comme nulle, on a considéré que les 30 premiers jours représentaient, le premier mois d’exposition. Cette variable de durée se nomme *mois*.</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>**Format d'origine**</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>| id  | year | age | surgery | mois | died |</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>|-----|------|-----|---------|------|------|</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>| 1   | 67   | 30  | 0       | 2    | 1    |</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>: Durée discrète: données en format d'origine</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>La personne décède lors du deuxième intervalle de 30 jours</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>**Format long et variables pour l'analyse**</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>| id  | year | age | surgery | mois | died | t |</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>|-----|------|-----|---------|------|------|---|</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>| 1   | 67   | 30  | 0       | 2    | 0    | 1 |</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>| 1   | 67   | 30  | 0       | 2    | 1    | 2 |</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>: Durée discrète: données en format long</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ajustement de la durée</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>Un des principaux enjeux réside dans la paramétrisation de la durée:  </span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Elle peut-être modélisée sous forme de fonction d’une variable de type quantitative/continue.</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Elle peut-être modélisée comme variable discrète, de type indicatrice ${0;1}$, sur tous les points d'observation, ou sous forme de regroupements. Il doit y avoir au moins un évènement observé dans chaque intervalle.  </span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ajustement avec une durée en continu</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>Le modèle étant paramétrique, on doit trouver une fonction qui ajuste le mieux les données. Toutes transformations de la variable est possible: $f(t)=a\times t$, $f(t)=a\times ln(t)$......formes quadratiques. Les ajustements sous forme de **splines** (cubiques) tendent à se développer ces dernières années. </span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>Pour sélectionner cette  fonction, on peut tester différents modèles sans covariable additionnelle, et sélectionner la forme dont le critère d'information de type **AIC**  (vraisemblance pénalisée) est le plus faible.   </span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>Exemple:  </span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>On va tester les paramétrisations suivante:s une forme linéraire stricte  $f(t)=a\times t$ et des effets quadratiques d'ordres 2 et 3: $f(t)=a_1\times t + a_2\times t^{2}$ et $f(t)=a_1\times t + a_2\times t^{2} + a_3\times t^{3}$.  </span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a><span class="al">![Probabilité de décéder avec 3 ajustements de la durée](images/Image11.png)</span>{width=70%}</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>**Critères AIC**   </span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>| $f(t)$                                              | AIC   |                      </span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>| --------------------------------------------------- | ----- | </span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>| $a\times t$                                         | 504   |</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>| $a_1\times t + a_2\times t^{2}$                     | 492   |  </span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>| $a_1\times t + a_2\times t^{2} + a_3\times t^{3}$   | 486   |   </span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>On peut utiliser la troisième forme à savoir $a_1\times t + a_2\times t^{2} + a_3\times t^{3}$.  </span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>**Estimation du modèle avec toutes les covariables**</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>| Variables   | OR - RR | Std. err | z       | P<span class="sc">\&gt;</span>\|z\| | 95% IC          |</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>|-------------|---------|----------|---------|----------|-----------------|</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>| $t$         | 0.678   | 0.057    | -4.52   | 0.000    | 0.587 ; 0.810   |</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>| $t^2$       | 1.014   | 0.005    | +2.83   | 0.005    | 1.004 ; 1.024   |</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>| $t^3$       | 1.000   | 0.000    | -2.11   | 0.035    | 1.000 ; 1.000   |</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>| $year$      | 0.876   | 0.015    | -1.80   | 0.072    | 0.758 ; 1.012   |</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>| $age$       | 1.034   | 0.163    | +2.27   | 0.023    | 1.005 ; 1.064   |</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>| $surgery$   | 0.364   | 0.110    | -2.25   | 0.024    | 0.151 ; 0.877   |</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>|             |         |          |         |          |                 |</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>| *Constante* | *0.440* | *0.110*  | *-3.29* | *0.001*  | *0.270 ; 0.718* |</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>: Modèle logistique à durée discrète ($f(t)$ continue)</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>*Remarque*: les variables *year* et *age* ont été centrée sur leur moyenne pour rendre la constante interprétable. La constante reporte donc</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>l'Odds de décéder lors des 30 premiers jours d'une personne dont l'âge et l'année à l'entrée dans le registre </span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>est égal à l'âge et à l'année moyenne et qui n'a pas été opéré préalablement.</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>Si maintenant on estime un modèle de Cox sur ces données journalières groupées, on remarque que les résultats</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>obtenus sont très proches</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>| Variables   | OR - RR | Std. err | z       | P<span class="sc">\&gt;</span>\|z\| | 95% IC          |</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>|-------------|---------|----------|---------|----------|-----------------|</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>| $year$      | 0.878   | 0.059    | -1.93   | 0.053    | 0.769 ; 1.002   |</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>| $age$       | 1.029   | 0.014    | +2.13   | 0.033    | 1.002 ; 1.057   |</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>| $surgery$   | 0.379   | 0.165    | -2.22   | 0.026    | 0.111 ; 0.892   |</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>: Modèle de Cox</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ajustement discret</span></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Il s'agit d'introduire la variable de durée dans le modèle comme une variable catégorielle (indicatrices).</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Démarche pas conseillé si on a beaucoup de points d'observation, ce qui est le cas ici.</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>A l'inverse, si peu de points d'observation la paramétrisation avec une durée continue n'est pas conseillé.</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>La correction de la non proportionnalité peut être plus compliquée à mettre en oeuvre.</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>On va supposer que l'on ne dispose que de 4 intervalles d'observation. Pour l'exemple, on va créer ces points à partir des quartiles de la durée, et conserver pour chaque personne une seule observation par intervalle.  </span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$t=1$: Entre le début de l'exposition et 4 mois.</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$t=2$: Entre 5 mois et 11 mois .</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$t=3$: Entre 12 mois et 23 mois.</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$t=4$: 24 mois et plus.</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>On va estimer le risque globalement sur l'intervalle. La base sera plus courte que la précédente (197 observations pour 103 individus). Il ne sera plus possible ici d'interpréter les résultats en termes de rapport de probabilité, l'évènement devenant trop fréquent à l'intérieur de chaque intervalle.</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>| Variables   | OR - RR | Std. err | z       | P<span class="sc">\&gt;</span>\|z\| | 95% IC          |</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>|-------------|---------|----------|---------|----------|-----------------|</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>| $0-4 mois$  | 2.811   | 1.177    | +2.47   | 0.014    | 1.237 ; 6.387   |</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>| $5-11 mois$ | ref     |   -      |   -     |   -      |       -         |</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>| $12-23 mois$| 0.559   | 0.346    | -0.94   | 0.347    | 0.166 ; 1.881   |</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>| $24-46 mois$| 1.741   | 1.159    | +0.83   | 0.405    | 0.472 ; 6.417   |</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>| $year$      | 0.816   | 0.076    | -2.18   | 0.029    | 0.680 ; 0.980   |</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>| $age$       | 1.048   | 0.019    | +2.53   | 0.011    | 1.011 ; 1.087   |</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>| $surgery$   | 0.330   | 0.166    | -2.21   | 0.027    | 0.123 ; 0.882   |</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>|             |         |          |         |          |                 |</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>| *Constante* | *0.407* | *0.151*  | *2.43*  | *0.015*  | *0.198 ; 0.840* |</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>: Modèle logistique à durée discrète ($f(t)$ indicatrices)</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>On trouve des résultats proches de ceux éstimés avec un ajustement continu de la durée. C'est normal, la dirée fait office de variable d'ajustement peu ou pas corrélée avec les autres variables introduites.</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>| Variables   | Ajustement discret | Ajustement continu |</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>|-------------|--------------------|--------------------|</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>| $year$      | 0.816              |  0.876             | </span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>| $age$       | 1.048              |  1.034             | </span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>| $surgery$   | 0.330              |  0.364             |</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lien avec des modèles usuels à durée continue</span></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>Si la durée discrète/groupé sous tend une durée continue (ce qui est le cas ici):  </span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>L'ajustement avec des indicatrices correspond au modèle à durée discrète défini par Cox, et le plus proche du modèle semi-paramétrique. Il est également assimilable à un modèle de type *exponential piecewice constant* (cf modèle de poisson)</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Si l'ajustement se fait en utilisation une transformation de la durée par une fonction: </span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$f(t)= log(t)$ correspond à un modèle de Weibull de type *risque proportionnel* ^<span class="co">[</span><span class="ot">voir la courte section sur les modèle paramétriques usuels</span><span class="co">]</span>.</span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Si l'ajustement se fait avec des splines cubiques, le modèle à durée discrète correspond à un modèle de type *Parmar-Royston*. Si on utilise une forme quadratique standard et bien ajustée, on obtient également cette correspondance.</span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a><span class="fu">## Proportionnalité des risques</span></span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Formellement un modèle logistique à temps discret repose sur une hypothèse d'Odds proportionnel <span class="co">[</span><span class="ot">Odds ratios constants pendant la durée d'observation</span><span class="co">]</span>. Contrairement au modèle de Cox, l'estimation des probabilités (risque) n'est pas biaisée si l'hypothèse PH n'est pas respectée, les paramètres estimés sont considérés au pire comme des approximation.</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Comme pour le modèle de Cox, la correction de la non proportionnalité peut se faire en intégrant une interaction avec la durée dans le modèle.</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>Avec un ajustement continue, on remarque de nouveau que le résultat du modèle est de nouveau très proche de celui estimé avec un modèle de Cox. </span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>| Variables         | OR - RR | Std. err | z       | P<span class="sc">\&gt;</span>\|z\| | 95% CI           |</span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>|-------------------|---------|----------|---------|----------|------------------|</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>| $t$               | 0.702   | 0.059    | -4.2    | 0.000    | 0.595 ; 0.828    |</span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>| $surgery(t=0)$    | 0.155   | 0.108    | -2.67   | 0.008    | 0.039 ; 0.609    |</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>| $surgery\times t$ | 1.072   | 0.036    | 2.08    | 0.037    | 1.004 ; 1.145    |</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>| $t^2$             | 1.013   | 0.005    | 2.37    | 0.018    | 1.002 ; 1.023    |</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>| $t^3$             | 1.00    | 0.000    | -1.71   | 0.086    | 1.000 ; 1.000    |</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>| $year$            | 0.872   | 0.064    | -1.86   | 0.062    |  0.755 ; 1.007   |</span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>| $age$             | 1.033   | 0.015    | 2.23    | 0.026    | 1.004 ; 1.063    |</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>| $constante$       | *0.445* | *0.112*  | *-3.22* | *0.001*  | *0.272 ; 0.728*  |</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>: Modèle logistique à durée discrète avec correction de la non proportionnalité</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>Si on avait omis les variables *year* et *age* du modèle:</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a><span class="al">![Probabilité de décéder après correction de la non proportionnalité pour la variable surgery](images/Image13.png)</span>{width=70%}</span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"loop":true,"closeEffect":"zoom","selector":".lightbox","descPosition":"bottom","openEffect":"zoom"});</script>



</body></html>