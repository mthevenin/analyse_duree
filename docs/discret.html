<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.207">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Analyse des durées - Modèle temps discret</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./dynamiques.html" rel="next">
<link href="./cox.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Analyse des durées</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mthevenin/analyse_duree"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:marc.thevenin@ined.fr"><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Modèle temps discret</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false"><strong>Données et théorie</strong></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Donnees.html" class="sidebar-item-text sidebar-link">Les Données</a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false"><strong>Méthodes non paramétriques</strong></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fsurvie.html" class="sidebar-item-text sidebar-link">Les fonctions de survie</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./comp_fsurvie.html" class="sidebar-item-text sidebar-link">Tests de comparaison</a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true"><strong>Modèles à risques proportionnels</strong></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_mod.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cox.html" class="sidebar-item-text sidebar-link">Modèle de Cox</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discret.html" class="sidebar-item-text sidebar-link active">Modèle temps discret</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamiques.html" class="sidebar-item-text sidebar-link">Variables dynamiques</a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false"><strong>Compléments</strong></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./parametrique.html" class="sidebar-item-text sidebar-link">Modèles paramétriques</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./concurrent.html" class="sidebar-item-text sidebar-link">Risques concurrents</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./frailty.html" class="sidebar-item-text sidebar-link">Fragilité et immunité</a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false"><strong>Programmation</strong></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R.html" class="sidebar-item-text sidebar-link">R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Stata.html" class="sidebar-item-text sidebar-link">Stata</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Sas.html" class="sidebar-item-text sidebar-link">SAS</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Python.html" class="sidebar-item-text sidebar-link">PYTHON</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sections</h2>
   
  <ul>
  <li><a href="#organisation-des-données" id="toc-organisation-des-données" class="nav-link active" data-scroll-target="#organisation-des-données">Organisation des données</a></li>
  <li><a href="#ajustement-de-la-durée" id="toc-ajustement-de-la-durée" class="nav-link" data-scroll-target="#ajustement-de-la-durée">Ajustement de la durée</a>
  <ul class="collapse">
  <li><a href="#ajustement-avec-une-durée-en-continu" id="toc-ajustement-avec-une-durée-en-continu" class="nav-link" data-scroll-target="#ajustement-avec-une-durée-en-continu">Ajustement avec une durée en continu</a></li>
  <li><a href="#ajustement-discret" id="toc-ajustement-discret" class="nav-link" data-scroll-target="#ajustement-discret">Ajustement discret</a></li>
  </ul></li>
  <li><a href="#hypothèse-ph" id="toc-hypothèse-ph" class="nav-link" data-scroll-target="#hypothèse-ph">Hypothèse PH</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Modèle temps discret</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>On va principalement traiter du <strong><em>modèle logistique à temps discret</em></strong>.<br>
<br></p>
<ul>
<li>Par définition ce n’est pas un modèle à risques proportionnels, mais à Odds proportionnels. Toutefois en situation de rareté (p&lt;10%), l’Odds converge vers une probabilité, qui est une mesure du risque (ici une probabilité conditionnelle).</li>
<li>Le modèle à temps discret est de type paramétrique, il est moins contraignant que le modèle de Cox si l’hypothèse de proportionnalité n’est pas respectée, car le modèle est ajusté par une fonction de la durée. Il est donc pleinement paramétrique.</li>
<li>Formellement, le modèle est estimable avec des évènements mesurés à une durée nulle (même si cela n’a pas grand sens).</li>
<li>La base de données doit être transformée en format long: aux temps d’observation ou sur des intervalles de temps. C’est une des principales différences avec le modèle de Cox qui est une estimation aux temps d’évènement. Néanmoins avec une bonne forme fonctionnelle de la durée traitée de manière continue, les deux modèles aboutissent à des résultats quasiment identiques.</li>
<li>Permet d’introduire de manière plutôt souple un ensemble de covariables dynamiques.</li>
</ul>
<p>Avec un lien logistique, le modèle à temps discret, avec seulement des covariables fixes, peut s’écrire:</p>
<hr>
<p><span class="math display">\[log\left[\frac{P(Y=1\ |\ t_p,X_k)}{1-P(Y=1\ |\ t_p,X_k)}\right]= a_0 + \sum_{p}a_pf(t_p)+\sum_{k}b_kX_k\]</span></p>
<section id="organisation-des-données" class="level1">
<h1>Organisation des données</h1>
<p><strong>Format long</strong><br>
<br> Les données doivent être en format long: pour chaque individu on a une ligne par durée observée ou par intevalle de durées jusqu’à l’évènement ou la censure. On retrouve le <em>split</em> des données du modèle de Cox, mais généralisé à des intervalles où aucun évènement n’est observé. Avec des données de type discrètes ou groupées, phénomène classique en sciences sociales, il y a souvent peu de différence entre un allongement aux temps d’évènement et aux temps d’observation.<br>
<br></p>
<p><strong>Durée</strong><br>
<br> La durée est dans un premier temps construite sous forme d’un simple compteur, par exemple <span class="math inline">\(t=1,2,3,4,5...\)</span> (des valeurs non entières sont possibles). Le choix de la forme fonctionnelle de la durée sera présenté par la suite.</p>
<p><strong>Variable évènement/censure</strong><br>
<br> Si l’individu a connu l’évènement, elle prend la valeur 0 avant celui-ci. Au moment de l’évènement sa valeur est égale à 1. Pour les observations censurées, la variable prend toujours la valeur 0.</p>
<p><br> <strong>Application</strong><br>
On reprend les données de la base <em>transplantation</em>, mais les durées ont été regroupées par période de 30 jours. Il n’y a pas de durée mesurée comme nulle, on a considéré que les 30 premiers jours représentaient, en gros, le premier mois d’exposition. Cette variable de durée se nomme <em>mois</em>.</p>
<p><strong>Format d’origine</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+-----------------------------------------+</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span> id   year   age   surgery   mois   died <span class="sc">|</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span><span class="sc">-----------------------------------------</span><span class="er">|</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>  <span class="dv">1</span>     <span class="dv">67</span>    <span class="dv">30</span>         <span class="dv">0</span>      <span class="dv">2</span>      <span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+-----------------------------------------+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Format long et variables pour l’analyse</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+-------------------------------------------------+</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span> id   year   age   surgery   mois   died   t   d <span class="sc">|</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span><span class="sc">-------------------------------------------------</span><span class="er">|</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>  <span class="dv">1</span>     <span class="dv">67</span>    <span class="dv">30</span>         <span class="dv">0</span>      <span class="dv">2</span>      <span class="dv">1</span>   <span class="dv">1</span>   <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>  <span class="dv">1</span>     <span class="dv">67</span>    <span class="dv">30</span>         <span class="dv">0</span>      <span class="dv">2</span>      <span class="dv">1</span>   <span class="dv">2</span>   <span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+-------------------------------------------------+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ajustement-de-la-durée" class="level1">
<h1>Ajustement de la durée</h1>
<p>Un des principaux enjeux réside dans la paramétrisation de la durée:</p>
<ul>
<li>Elle peut-être modélisée sous forme de fonction d’une variable de type continue.</li>
<li>Elle peut-être modélisée comme variable discrete, de type indicatrice (0,1), sur tous les points d’observation, ou sous forme de regroupements (rappel: au moins un évènement observé dans chaque intervalle).</li>
</ul>
<section id="ajustement-avec-une-durée-en-continu" class="level2">
<h2 class="anchored" data-anchor-id="ajustement-avec-une-durée-en-continu">Ajustement avec une durée en continu</h2>
<p>Le modèle étant paramétrique, on doit trouver une fonction qui ajuste le mieux les données. Toutes transformations de la variable est possible: <span class="math inline">\(f(t)=a\times t\)</span>, <span class="math inline">\(f(t)=a\times ln(t)\)</span>……formes quadratiques. Les ajustements sous forme de <strong>splines</strong> (cubiques) tendent à se développer ces dernières années.<br>
Pour sélectionner cette fonction, on peut tester différents modèles sans covariable additionnelle, et sélectionner la forme qui minimise un critère d’information de type <strong>AIC</strong> ou <strong>BIC</strong> (vraisemblance pénalisée).<br>
<br> Exemple:<br>
On va tester les paramétrisations suivante:s une forme linéraire stricte <span class="math inline">\(f(t)=a\times t\)</span> et des effets quadratiques d’ordres 2 et 3: <span class="math inline">\(f(t)=a_1\times t + a_2\times t^{2}\)</span> et <span class="math inline">\(f(t)=a_1\times t + a_2\times t^{2} + a_3\times t^{3}\)</span>.</p>
<p><strong>Exemple</strong> Estimation des probabilités de décéder selon différents ajustements de la durée (modèle logistique à temps discret) <img src="images/Image11.png" class="img-fluid"></p>
<p><strong>Critères AIC</strong></p>
<table class="table">
<thead>
<tr class="header">
<th><span class="math inline">\(f(t)\)</span></th>
<th>AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(a\times t\)</span></td>
<td>504</td>
</tr>
<tr class="even">
<td><span class="math inline">\(a_1\times t + a_2\times t^{2}\)</span></td>
<td>492</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(a_1\times t + a_2\times t^{2} + a_3\times t^{3}\)</span></td>
<td>486</td>
</tr>
</tbody>
</table>
<p>On peut utiliser la troisième forme à savoir <span class="math inline">\(a_1\times t + a_2\times t^{2} + a_3\times t^{3}\)</span>.<br>
<br></p>
<p><strong>Estimation du modèle avec toutes les covariables</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Logistic regression                             Number of obs     <span class="ot">=</span>      <span class="dv">1</span>,<span class="dv">127</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                                                LR <span class="fu">chi2</span>(<span class="dv">6</span>)        <span class="ot">=</span>      <span class="fl">90.69</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                                                Prob <span class="sc">&gt;</span> chi2       <span class="ot">=</span>     <span class="fl">0.0000</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>Log likelihood <span class="ot">=</span> <span class="sc">-</span><span class="fl">230.33671</span>                     Pseudo R2         <span class="ot">=</span>     <span class="fl">0.1645</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>           e <span class="sc">|</span>      Coef.   Std. Err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% Conf. Interval]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>           t <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">3720566</span>   .<span class="dv">0823946</span>    <span class="sc">-</span><span class="fl">4.52</span>   <span class="fl">0.000</span>    <span class="sc">-</span>.<span class="dv">5335471</span>   <span class="sc">-</span>.<span class="dv">2105661</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>          t2 <span class="sc">|</span>   .<span class="dv">0142379</span>    .<span class="dv">005023</span>     <span class="fl">2.83</span>   <span class="fl">0.005</span>     .<span class="dv">0043929</span>    .<span class="dv">0240828</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>          t3 <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">0001659</span>   .<span class="dv">0000785</span>    <span class="sc">-</span><span class="fl">2.11</span>   <span class="fl">0.035</span>    <span class="sc">-</span>.<span class="dv">0003198</span>    <span class="sc">-</span>.<span class="dv">000012</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">1326693</span>   .<span class="dv">0737755</span>    <span class="sc">-</span><span class="fl">1.80</span>   <span class="fl">0.072</span>    <span class="sc">-</span>.<span class="dv">2772666</span>     .<span class="dv">011928</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>         age <span class="sc">|</span>   .<span class="dv">0333413</span>   .<span class="dv">0146876</span>     <span class="fl">2.27</span>   <span class="fl">0.023</span>     .<span class="dv">0045541</span>    .<span class="dv">0621285</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>     surgery <span class="sc">|</span>  <span class="sc">-</span><span class="fl">1.010918</span>    .<span class="dv">448598</span>    <span class="sc">-</span><span class="fl">2.25</span>   <span class="fl">0.024</span>    <span class="sc">-</span><span class="fl">1.890154</span>   <span class="sc">-</span>.<span class="dv">1316821</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>Remarque <span class="sc">:</span> la constante n’est pas reportée, les valeurs de la référence n’ayant pas grand  <span class="fu">sens</span> (année et âge à <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Maintenant si on estime le modèle avec la méthode de Cox (avec des durées mesurées sur une échelle de 30 jours) :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Cox regression <span class="sc">--</span> Efron method <span class="cf">for</span> ties</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>No. of subjects <span class="ot">=</span>          <span class="dv">103</span>                  Number of obs    <span class="ot">=</span>         <span class="dv">103</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>No. of failures <span class="ot">=</span>           <span class="dv">75</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>Time at risk    <span class="ot">=</span>         <span class="dv">1127</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                                                LR <span class="fu">chi2</span>(<span class="dv">3</span>)       <span class="ot">=</span>       <span class="fl">17.97</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>Log likelihood  <span class="ot">=</span>   <span class="sc">-</span><span class="fl">289.81242</span>                  Prob <span class="sc">&gt;</span> chi2      <span class="ot">=</span>      <span class="fl">0.0004</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>          _t <span class="sc">|</span>      Coef.   Std. Err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% Conf. Interval]</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">1304397</span>   .<span class="dv">0674344</span>    <span class="sc">-</span><span class="fl">1.93</span>   <span class="fl">0.053</span>    <span class="sc">-</span>.<span class="dv">2626087</span>    .<span class="dv">0017293</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>         age <span class="sc">|</span>   .<span class="dv">0288141</span>   .<span class="dv">0134981</span>     <span class="fl">2.13</span>   <span class="fl">0.033</span>     .<span class="dv">0023583</span>    .<span class="dv">0552698</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>     surgery <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">9695805</span>   .<span class="dv">4361069</span>    <span class="sc">-</span><span class="fl">2.22</span>   <span class="fl">0.026</span>    <span class="sc">-</span><span class="fl">1.824334</span>   <span class="sc">-</span>.<span class="dv">1148266</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On remarque que les coefficients estimés sont particulièrement proches.</p>
</section>
<section id="ajustement-discret" class="level2">
<h2 class="anchored" data-anchor-id="ajustement-discret">Ajustement discret</h2>
<ul>
<li>Il s’agit d’introduire la variable de durée dans le modèle comme une variable catégorielle (factor).</li>
<li>Pas conseillé si on a beaucoup de points d’observation, ce qui est le cas ici.</li>
<li>A l’inverse, si peu de points d’observation la paramétrisation avec une durée continue n’est pas conseillé, , avec en plus un nombre très (trop) élevé de degrés de liberté.</li>
<li>La correction de la non proportionnalité peut être plus compliquée à réaliser (non traité).</li>
</ul>
<p>On va supposer que l’on ne dispose que de 4 intervalles d’observation. Pour l’exemple, on va créer ces points à partir des quartiles de la durée, et conserver pour chaque personne une seule observation par intervalle.</p>
<ul>
<li>t=1: Entre le début de l’exposition et 4 mois.</li>
<li>t=2: Entre 5 mois et 11 mois .</li>
<li>t=3: Entre 12 mois et 23 mois.</li>
<li>t=4: 24 mois et plus.</li>
</ul>
<p>On va estimer le risque globalement sur l’intervalle. La base sera plus courte que la précédente (197 observations pour 103 individus).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>         <span class="dv">4</span> <span class="sc">|</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a> quantiles <span class="sc">|</span>           e</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>      of t <span class="sc">|</span>         <span class="dv">0</span>          <span class="dv">1</span> <span class="sc">|</span>     Total</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------+----------------------+----------</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>         <span class="dv">1</span> <span class="sc">|</span>        <span class="dv">50</span>         <span class="dv">53</span> <span class="sc">|</span>       <span class="dv">103</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>         <span class="dv">2</span> <span class="sc">|</span>        <span class="dv">35</span>         <span class="dv">11</span> <span class="sc">|</span>        <span class="dv">46</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>         <span class="dv">3</span> <span class="sc">|</span>        <span class="dv">27</span>          <span class="dv">5</span> <span class="sc">|</span>        <span class="dv">32</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>         <span class="dv">4</span> <span class="sc">|</span>        <span class="dv">10</span>          <span class="dv">6</span> <span class="sc">|</span>        <span class="dv">16</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------+----------------------+----------</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>     Total <span class="sc">|</span>       <span class="dv">122</span>         <span class="dv">75</span> <span class="sc">|</span>       <span class="dv">197</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>Logistic regression                             Number of obs     <span class="ot">=</span>        <span class="dv">197</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                                                LR <span class="fu">chi2</span>(<span class="dv">6</span>)        <span class="ot">=</span>      <span class="fl">39.30</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                                                Prob <span class="sc">&gt;</span> chi2       <span class="ot">=</span>     <span class="fl">0.0000</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>Log likelihood <span class="ot">=</span> <span class="sc">-</span><span class="fl">111.23965</span>                     Pseudo R2         <span class="ot">=</span>     <span class="fl">0.1501</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>           e <span class="sc">|</span>      Coef.   Std. Err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% Conf. Interval]</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>         ct4 <span class="sc">|</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>          <span class="dv">2</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">1.033368</span>   .<span class="dv">4188719</span>    <span class="sc">-</span><span class="fl">2.47</span>   <span class="fl">0.014</span>    <span class="sc">-</span><span class="fl">1.854342</span>   <span class="sc">-</span>.<span class="dv">2123944</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>          <span class="dv">3</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">1.615245</span>    .<span class="dv">544858</span>    <span class="sc">-</span><span class="fl">2.96</span>   <span class="fl">0.003</span>    <span class="sc">-</span><span class="fl">2.683147</span>   <span class="sc">-</span>.<span class="dv">5473433</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>          <span class="dv">4</span>  <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">4789305</span>   .<span class="dv">5992969</span>    <span class="sc">-</span><span class="fl">0.80</span>   <span class="fl">0.424</span>    <span class="sc">-</span><span class="fl">1.653531</span>    .<span class="dv">6956698</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>             <span class="sc">|</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">2032436</span>   .<span class="dv">0931956</span>    <span class="sc">-</span><span class="fl">2.18</span>   <span class="fl">0.029</span>    <span class="sc">-</span>.<span class="dv">3859036</span>   <span class="sc">-</span>.<span class="dv">0205835</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>         age <span class="sc">|</span>   .<span class="dv">0468518</span>   .<span class="dv">0184958</span>     <span class="fl">2.53</span>   <span class="fl">0.011</span>     .<span class="dv">0106006</span>     .<span class="dv">083103</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>     surgery <span class="sc">|</span>  <span class="sc">-</span><span class="fl">1.110163</span>   .<span class="dv">5025594</span>    <span class="sc">-</span><span class="fl">2.21</span>   <span class="fl">0.027</span>    <span class="sc">-</span><span class="fl">2.095161</span>   <span class="sc">-</span>.<span class="dv">1251644</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>Remarque <span class="sc">:</span> la constante n’est pas reportée, les valeurs de la référence</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>           n’ayant pas grand  <span class="fu">sens</span> (année et âge à <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Au niveau de l’interpretation, avec 37% d’évènements sur l’ensemble des observations, il n’est plus possible d’interpréter le modèle en terme de risque (probabilité). La lecture en termes d’Odds Ratio s’impose.</p>
<p>Probabilités estimées à partir d’un modèle avec la durée seulement.<br>
Risques sur la longueur de l’intervalle.</p>
<table class="table">
<thead>
<tr class="header">
<th>Durées</th>
<th>p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0 à 4 mois</td>
<td>0.51</td>
</tr>
<tr class="even">
<td>4 à 11 mois</td>
<td>0.24</td>
</tr>
<tr class="odd">
<td>11 à 23 mois</td>
<td>0.16</td>
</tr>
<tr class="even">
<td>23 à 61 mois</td>
<td>0.37</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="hypothèse-ph" class="level1">
<h1>Hypothèse PH</h1>
<ul>
<li><p>Formellement un modèle logistique à temps discret repose sur une hypothèse d’Odds proportionnel (Odds ratios constants pendant la durée d’observation). Contrairement au modèle de Cox, l’estimation des probabilités (risque) n’est pas biaisée si l’hypothèse PH n’est pas respectée.</p></li>
<li><p>Comme pour le modèle de Cox, la correction de la non proportionnalité peut se faire en intégrant une interaction avec la durée dans le modèle.</p></li>
</ul>
<p>Les variables year et age seront omises pour faciliter la représentation graphique (on repart sur le modèle avec la durée mesurée continue).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Logistic regression                             Number of obs     <span class="ot">=</span>      <span class="dv">1</span>,<span class="dv">127</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                                                LR <span class="fu">chi2</span>(<span class="dv">5</span>)        <span class="ot">=</span>      <span class="fl">84.78</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                                                Prob <span class="sc">&gt;</span> chi2       <span class="ot">=</span>     <span class="fl">0.0000</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>Log likelihood <span class="ot">=</span> <span class="sc">-</span><span class="fl">233.29204</span>                     Pseudo R2         <span class="ot">=</span>     <span class="fl">0.1538</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>           e <span class="sc">|</span>      Coef.   Std. Err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% Conf. Interval]</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>           t <span class="sc">|</span>   <span class="sc">-</span>.<span class="dv">373826</span>    .<span class="dv">083913</span>    <span class="sc">-</span><span class="fl">4.45</span>   <span class="fl">0.000</span>    <span class="sc">-</span>.<span class="dv">5382924</span>   <span class="sc">-</span>.<span class="dv">2093595</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>   <span class="fl">1.</span>surgery <span class="sc">|</span>  <span class="sc">-</span><span class="fl">1.929061</span>   .<span class="dv">6920142</span>    <span class="sc">-</span><span class="fl">2.79</span>   <span class="fl">0.005</span>    <span class="sc">-</span><span class="fl">3.285383</span>   <span class="sc">-</span>.<span class="dv">5727377</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>             <span class="sc">|</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a> surgery<span class="co">#c.t |</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>          <span class="dv">1</span>  <span class="sc">|</span>   .<span class="dv">0690069</span>   .<span class="dv">0333128</span>     <span class="fl">2.07</span>   <span class="fl">0.038</span>      .<span class="dv">003715</span>    .<span class="dv">1342987</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>             <span class="sc">|</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>          t2 <span class="sc">|</span>   .<span class="dv">0137676</span>   .<span class="dv">0052405</span>     <span class="fl">2.63</span>   <span class="fl">0.009</span>     .<span class="dv">0034964</span>    .<span class="dv">0240388</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>          t3 <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">0001596</span>   .<span class="dv">0000828</span>    <span class="sc">-</span><span class="fl">1.93</span>   <span class="fl">0.054</span>    <span class="sc">-</span>.<span class="dv">0003218</span>    <span class="fl">2.62e-06</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>Remarque <span class="sc">:</span> la constante n’est pas reportée.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/Image13.png" class="img-fluid"></p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./cox.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Modèle de Cox</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./dynamiques.html" class="pagination-link">
        <span class="nav-page-text">Variables dynamiques</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb7" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Modèle temps discret"</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (rsconnect)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(memisc)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>On va principalement traiter du ***modèle logistique à temps discret***.   </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Par définition ce n’est pas un modèle à risques proportionnels, mais à Odds proportionnels. Toutefois en situation de rareté (p&lt;10%), l’Odds converge vers une probabilité, qui est une mesure du risque (ici une probabilité conditionnelle).</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Le modèle à temps discret est de type paramétrique, il est moins contraignant que le modèle de Cox si l’hypothèse de proportionnalité n’est pas respectée, car le modèle est ajusté par une fonction de la durée. Il est donc pleinement paramétrique.</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Formellement, le modèle est estimable avec des évènements mesurés à une durée nulle (même si cela n’a pas grand sens).</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>La base de données doit être transformée en format long: aux temps d’observation ou sur des intervalles de temps. C’est une des principales différences avec le modèle de Cox qui est une estimation aux temps d’évènement. Néanmoins avec une bonne forme fonctionnelle de la durée traitée de manière continue, les deux modèles aboutissent à des résultats quasiment identiques.</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Permet d’introduire de manière plutôt souple un ensemble de covariables dynamiques.</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>Avec un lien logistique, le modèle à temps discret, avec seulement des covariables fixes, peut s'écrire:   </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>$$log\left<span class="co">[</span><span class="ot">\frac{P(Y=1\ |\ t_p,X_k)}{1-P(Y=1\ |\ t_p,X_k)}\right</span><span class="co">]</span>= a_0 + \sum_{p}a_pf(t_p)+\sum_{k}b_kX_k$$</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="fu"># Organisation des données</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>**Format long**  </span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>Les données doivent être en format long: pour chaque individu on a une ligne par durée observée ou par intevalle de durées jusqu'à l'évènement ou la censure. On retrouve le  *split* des données du modèle de Cox, mais généralisé à des intervalles où aucun évènement n'est observé. Avec des données de type discrètes ou groupées, phénomène classique en sciences sociales, il y a souvent peu de différence entre un allongement aux temps d'évènement et aux temps d'observation.  </span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>**Durée**  </span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>La durée est dans un premier temps construite sous forme d'un simple compteur, par exemple $t=1,2,3,4,5...$ (des valeurs non entières sont possibles). Le choix de la forme fonctionnelle de la durée sera présenté par la suite.  </span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>**Variable évènement/censure**  </span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>Si l'individu a connu l'évènement, elle prend la valeur 0 avant celui-ci. Au moment de l'évènement sa valeur est égale à 1. Pour les observations censurées, la variable prend toujours la valeur 0.</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>**Application**  </span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>On reprend les données de la base *transplantation*, mais les durées ont été regroupées par période de 30 jours. Il n’y a pas de durée mesurée comme nulle, on a considéré que les 30 premiers jours représentaient, en gros, le premier mois d’exposition. Cette variable de durée se nomme *mois*. </span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>**Format d'origine**</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+-----------------------------------------+</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span> id   year   age   surgery   mois   died <span class="sc">|</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span><span class="sc">-----------------------------------------</span><span class="er">|</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>  <span class="dv">1</span>     <span class="dv">67</span>    <span class="dv">30</span>         <span class="dv">0</span>      <span class="dv">2</span>      <span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+-----------------------------------------+</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>**Format long et variables pour l'analyse**</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+-------------------------------------------------+</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span> id   year   age   surgery   mois   died   t   d <span class="sc">|</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span><span class="sc">-------------------------------------------------</span><span class="er">|</span></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>  <span class="dv">1</span>     <span class="dv">67</span>    <span class="dv">30</span>         <span class="dv">0</span>      <span class="dv">2</span>      <span class="dv">1</span>   <span class="dv">1</span>   <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>  <span class="dv">1</span>     <span class="dv">67</span>    <span class="dv">30</span>         <span class="dv">0</span>      <span class="dv">2</span>      <span class="dv">1</span>   <span class="dv">2</span>   <span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+-------------------------------------------------+</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a><span class="fu"># Ajustement de la durée</span></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>Un des principaux enjeux réside dans la paramétrisation de la durée:  </span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Elle peut-être modélisée sous forme de fonction d’une variable de type continue.</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Elle peut-être modélisée comme variable discrete, de type indicatrice (0,1), sur tous les points d'observation, ou sous forme de regroupements (rappel: au moins un évènement observé dans chaque intervalle).  </span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ajustement avec une durée en continu</span></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>Le modèle étant paramétrique, on doit trouver une fonction qui ajuste le mieux les données. Toutes transformations de la variable est possible: $f(t)=a\times t$, $f(t)=a\times ln(t)$......formes quadratiques. Les ajustements sous forme de **splines** (cubiques) tendent à se développer ces dernières années.  </span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>Pour sélectionner cette  fonction, on peut tester différents modèles sans covariable additionnelle, et sélectionner la forme qui minimise un critère d'information de type **AIC** ou **BIC** (vraisemblance pénalisée).   </span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>Exemple:  </span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>On va tester les paramétrisations suivante:s une forme linéraire stricte  $f(t)=a\times t$ et des effets quadratiques d'ordres 2 et 3: $f(t)=a_1\times t + a_2\times t^{2}$ et $f(t)=a_1\times t + a_2\times t^{2} + a_3\times t^{3}$.  </span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>**Exemple**</span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>Estimation des probabilités de décéder selon différents ajustements de la durée (modèle logistique à temps discret)</span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/Image11.png)</span></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>**Critères AIC**   </span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>| $f(t)$                                              | AIC   |                      </span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>| --------------------------------------------------- | ----- | </span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>| $a\times t$                                         | 504   |</span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>| $a_1\times t + a_2\times t^{2}$                     | 492   |  </span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>| $a_1\times t + a_2\times t^{2} + a_3\times t^{3}$   | 486   |   </span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>On peut utiliser la troisième forme à savoir $a_1\times t + a_2\times t^{2} + a_3\times t^{3}$.  </span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;BR&gt;</span></span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>**Estimation du modèle avec toutes les covariables**</span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>Logistic regression                             Number of obs     <span class="ot">=</span>      <span class="dv">1</span>,<span class="dv">127</span></span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>                                                LR <span class="fu">chi2</span>(<span class="dv">6</span>)        <span class="ot">=</span>      <span class="fl">90.69</span></span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>                                                Prob <span class="sc">&gt;</span> chi2       <span class="ot">=</span>     <span class="fl">0.0000</span></span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>Log likelihood <span class="ot">=</span> <span class="sc">-</span><span class="fl">230.33671</span>                     Pseudo R2         <span class="ot">=</span>     <span class="fl">0.1645</span></span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>           e <span class="sc">|</span>      Coef.   Std. Err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% Conf. Interval]</span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>           t <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">3720566</span>   .<span class="dv">0823946</span>    <span class="sc">-</span><span class="fl">4.52</span>   <span class="fl">0.000</span>    <span class="sc">-</span>.<span class="dv">5335471</span>   <span class="sc">-</span>.<span class="dv">2105661</span></span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>          t2 <span class="sc">|</span>   .<span class="dv">0142379</span>    .<span class="dv">005023</span>     <span class="fl">2.83</span>   <span class="fl">0.005</span>     .<span class="dv">0043929</span>    .<span class="dv">0240828</span></span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a>          t3 <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">0001659</span>   .<span class="dv">0000785</span>    <span class="sc">-</span><span class="fl">2.11</span>   <span class="fl">0.035</span>    <span class="sc">-</span>.<span class="dv">0003198</span>    <span class="sc">-</span>.<span class="dv">000012</span></span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">1326693</span>   .<span class="dv">0737755</span>    <span class="sc">-</span><span class="fl">1.80</span>   <span class="fl">0.072</span>    <span class="sc">-</span>.<span class="dv">2772666</span>     .<span class="dv">011928</span></span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>         age <span class="sc">|</span>   .<span class="dv">0333413</span>   .<span class="dv">0146876</span>     <span class="fl">2.27</span>   <span class="fl">0.023</span>     .<span class="dv">0045541</span>    .<span class="dv">0621285</span></span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>     surgery <span class="sc">|</span>  <span class="sc">-</span><span class="fl">1.010918</span>    .<span class="dv">448598</span>    <span class="sc">-</span><span class="fl">2.25</span>   <span class="fl">0.024</span>    <span class="sc">-</span><span class="fl">1.890154</span>   <span class="sc">-</span>.<span class="dv">1316821</span></span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>Remarque <span class="sc">:</span> la constante n’est pas reportée, les valeurs de la référence n’ayant pas grand  <span class="fu">sens</span> (année et âge à <span class="dv">0</span>)</span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a>Maintenant si on estime le modèle avec la méthode de Cox (avec des durées mesurées sur une échelle de 30 jours) :</span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a>Cox regression <span class="sc">--</span> Efron method <span class="cf">for</span> ties</span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a>No. of subjects <span class="ot">=</span>          <span class="dv">103</span>                  Number of obs    <span class="ot">=</span>         <span class="dv">103</span></span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a>No. of failures <span class="ot">=</span>           <span class="dv">75</span></span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a>Time at risk    <span class="ot">=</span>         <span class="dv">1127</span></span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a>                                                LR <span class="fu">chi2</span>(<span class="dv">3</span>)       <span class="ot">=</span>       <span class="fl">17.97</span></span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a>Log likelihood  <span class="ot">=</span>   <span class="sc">-</span><span class="fl">289.81242</span>                  Prob <span class="sc">&gt;</span> chi2      <span class="ot">=</span>      <span class="fl">0.0004</span></span>
<span id="cb7-137"><a href="#cb7-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-138"><a href="#cb7-138" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb7-139"><a href="#cb7-139" aria-hidden="true" tabindex="-1"></a>          _t <span class="sc">|</span>      Coef.   Std. Err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% Conf. Interval]</span>
<span id="cb7-140"><a href="#cb7-140" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb7-141"><a href="#cb7-141" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">1304397</span>   .<span class="dv">0674344</span>    <span class="sc">-</span><span class="fl">1.93</span>   <span class="fl">0.053</span>    <span class="sc">-</span>.<span class="dv">2626087</span>    .<span class="dv">0017293</span></span>
<span id="cb7-142"><a href="#cb7-142" aria-hidden="true" tabindex="-1"></a>         age <span class="sc">|</span>   .<span class="dv">0288141</span>   .<span class="dv">0134981</span>     <span class="fl">2.13</span>   <span class="fl">0.033</span>     .<span class="dv">0023583</span>    .<span class="dv">0552698</span></span>
<span id="cb7-143"><a href="#cb7-143" aria-hidden="true" tabindex="-1"></a>     surgery <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">9695805</span>   .<span class="dv">4361069</span>    <span class="sc">-</span><span class="fl">2.22</span>   <span class="fl">0.026</span>    <span class="sc">-</span><span class="fl">1.824334</span>   <span class="sc">-</span>.<span class="dv">1148266</span></span>
<span id="cb7-144"><a href="#cb7-144" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb7-145"><a href="#cb7-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-146"><a href="#cb7-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-147"><a href="#cb7-147" aria-hidden="true" tabindex="-1"></a>On remarque que les coefficients estimés sont particulièrement proches. </span>
<span id="cb7-148"><a href="#cb7-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-149"><a href="#cb7-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-150"><a href="#cb7-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-151"><a href="#cb7-151" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ajustement discret</span></span>
<span id="cb7-152"><a href="#cb7-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-153"><a href="#cb7-153" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Il s'agit d'introduire la variable de durée dans le modèle comme une variable catégorielle (factor).</span>
<span id="cb7-154"><a href="#cb7-154" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Pas conseillé si on a beaucoup de points d'observation, ce qui est le cas ici.</span>
<span id="cb7-155"><a href="#cb7-155" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>A l'inverse, si peu de points d'observation la paramétrisation avec une durée continue n'est pas conseillé, , avec en plus un nombre très (trop) élevé de degrés de liberté.</span>
<span id="cb7-156"><a href="#cb7-156" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>La correction de la non proportionnalité peut être plus compliquée à réaliser (non traité).</span>
<span id="cb7-157"><a href="#cb7-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-158"><a href="#cb7-158" aria-hidden="true" tabindex="-1"></a>On va supposer que l'on ne dispose que de 4 intervalles d'observation. Pour l'exemple, on va créer ces points à partir des quartiles de la durée, et conserver pour chaque personne une seule observation par intervalle.  </span>
<span id="cb7-159"><a href="#cb7-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-160"><a href="#cb7-160" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>t=1: Entre le début de l'exposition et 4 mois.</span>
<span id="cb7-161"><a href="#cb7-161" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>t=2: Entre 5 mois et 11 mois .</span>
<span id="cb7-162"><a href="#cb7-162" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>t=3: Entre 12 mois et 23 mois.</span>
<span id="cb7-163"><a href="#cb7-163" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>t=4: 24 mois et plus.</span>
<span id="cb7-164"><a href="#cb7-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-165"><a href="#cb7-165" aria-hidden="true" tabindex="-1"></a>On va estimer le risque globalement sur l'intervalle. La base sera plus courte que la précédente (197 observations pour 103 individus). </span>
<span id="cb7-166"><a href="#cb7-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-167"><a href="#cb7-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb7-168"><a href="#cb7-168" aria-hidden="true" tabindex="-1"></a>         <span class="dv">4</span> <span class="sc">|</span></span>
<span id="cb7-169"><a href="#cb7-169" aria-hidden="true" tabindex="-1"></a> quantiles <span class="sc">|</span>           e</span>
<span id="cb7-170"><a href="#cb7-170" aria-hidden="true" tabindex="-1"></a>      of t <span class="sc">|</span>         <span class="dv">0</span>          <span class="dv">1</span> <span class="sc">|</span>     Total</span>
<span id="cb7-171"><a href="#cb7-171" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------+----------------------+----------</span></span>
<span id="cb7-172"><a href="#cb7-172" aria-hidden="true" tabindex="-1"></a>         <span class="dv">1</span> <span class="sc">|</span>        <span class="dv">50</span>         <span class="dv">53</span> <span class="sc">|</span>       <span class="dv">103</span> </span>
<span id="cb7-173"><a href="#cb7-173" aria-hidden="true" tabindex="-1"></a>         <span class="dv">2</span> <span class="sc">|</span>        <span class="dv">35</span>         <span class="dv">11</span> <span class="sc">|</span>        <span class="dv">46</span> </span>
<span id="cb7-174"><a href="#cb7-174" aria-hidden="true" tabindex="-1"></a>         <span class="dv">3</span> <span class="sc">|</span>        <span class="dv">27</span>          <span class="dv">5</span> <span class="sc">|</span>        <span class="dv">32</span> </span>
<span id="cb7-175"><a href="#cb7-175" aria-hidden="true" tabindex="-1"></a>         <span class="dv">4</span> <span class="sc">|</span>        <span class="dv">10</span>          <span class="dv">6</span> <span class="sc">|</span>        <span class="dv">16</span> </span>
<span id="cb7-176"><a href="#cb7-176" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------+----------------------+----------</span></span>
<span id="cb7-177"><a href="#cb7-177" aria-hidden="true" tabindex="-1"></a>     Total <span class="sc">|</span>       <span class="dv">122</span>         <span class="dv">75</span> <span class="sc">|</span>       <span class="dv">197</span> </span>
<span id="cb7-178"><a href="#cb7-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-179"><a href="#cb7-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-180"><a href="#cb7-180" aria-hidden="true" tabindex="-1"></a>Logistic regression                             Number of obs     <span class="ot">=</span>        <span class="dv">197</span></span>
<span id="cb7-181"><a href="#cb7-181" aria-hidden="true" tabindex="-1"></a>                                                LR <span class="fu">chi2</span>(<span class="dv">6</span>)        <span class="ot">=</span>      <span class="fl">39.30</span></span>
<span id="cb7-182"><a href="#cb7-182" aria-hidden="true" tabindex="-1"></a>                                                Prob <span class="sc">&gt;</span> chi2       <span class="ot">=</span>     <span class="fl">0.0000</span></span>
<span id="cb7-183"><a href="#cb7-183" aria-hidden="true" tabindex="-1"></a>Log likelihood <span class="ot">=</span> <span class="sc">-</span><span class="fl">111.23965</span>                     Pseudo R2         <span class="ot">=</span>     <span class="fl">0.1501</span></span>
<span id="cb7-184"><a href="#cb7-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-185"><a href="#cb7-185" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb7-186"><a href="#cb7-186" aria-hidden="true" tabindex="-1"></a>           e <span class="sc">|</span>      Coef.   Std. Err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% Conf. Interval]</span>
<span id="cb7-187"><a href="#cb7-187" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb7-188"><a href="#cb7-188" aria-hidden="true" tabindex="-1"></a>         ct4 <span class="sc">|</span></span>
<span id="cb7-189"><a href="#cb7-189" aria-hidden="true" tabindex="-1"></a>          <span class="dv">2</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">1.033368</span>   .<span class="dv">4188719</span>    <span class="sc">-</span><span class="fl">2.47</span>   <span class="fl">0.014</span>    <span class="sc">-</span><span class="fl">1.854342</span>   <span class="sc">-</span>.<span class="dv">2123944</span></span>
<span id="cb7-190"><a href="#cb7-190" aria-hidden="true" tabindex="-1"></a>          <span class="dv">3</span>  <span class="sc">|</span>  <span class="sc">-</span><span class="fl">1.615245</span>    .<span class="dv">544858</span>    <span class="sc">-</span><span class="fl">2.96</span>   <span class="fl">0.003</span>    <span class="sc">-</span><span class="fl">2.683147</span>   <span class="sc">-</span>.<span class="dv">5473433</span></span>
<span id="cb7-191"><a href="#cb7-191" aria-hidden="true" tabindex="-1"></a>          <span class="dv">4</span>  <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">4789305</span>   .<span class="dv">5992969</span>    <span class="sc">-</span><span class="fl">0.80</span>   <span class="fl">0.424</span>    <span class="sc">-</span><span class="fl">1.653531</span>    .<span class="dv">6956698</span></span>
<span id="cb7-192"><a href="#cb7-192" aria-hidden="true" tabindex="-1"></a>             <span class="sc">|</span></span>
<span id="cb7-193"><a href="#cb7-193" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">2032436</span>   .<span class="dv">0931956</span>    <span class="sc">-</span><span class="fl">2.18</span>   <span class="fl">0.029</span>    <span class="sc">-</span>.<span class="dv">3859036</span>   <span class="sc">-</span>.<span class="dv">0205835</span></span>
<span id="cb7-194"><a href="#cb7-194" aria-hidden="true" tabindex="-1"></a>         age <span class="sc">|</span>   .<span class="dv">0468518</span>   .<span class="dv">0184958</span>     <span class="fl">2.53</span>   <span class="fl">0.011</span>     .<span class="dv">0106006</span>     .<span class="dv">083103</span></span>
<span id="cb7-195"><a href="#cb7-195" aria-hidden="true" tabindex="-1"></a>     surgery <span class="sc">|</span>  <span class="sc">-</span><span class="fl">1.110163</span>   .<span class="dv">5025594</span>    <span class="sc">-</span><span class="fl">2.21</span>   <span class="fl">0.027</span>    <span class="sc">-</span><span class="fl">2.095161</span>   <span class="sc">-</span>.<span class="dv">1251644</span></span>
<span id="cb7-196"><a href="#cb7-196" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb7-197"><a href="#cb7-197" aria-hidden="true" tabindex="-1"></a>Remarque <span class="sc">:</span> la constante n’est pas reportée, les valeurs de la référence</span>
<span id="cb7-198"><a href="#cb7-198" aria-hidden="true" tabindex="-1"></a>           n’ayant pas grand  <span class="fu">sens</span> (année et âge à <span class="dv">0</span>)</span>
<span id="cb7-199"><a href="#cb7-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-200"><a href="#cb7-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-201"><a href="#cb7-201" aria-hidden="true" tabindex="-1"></a>Au niveau de l'interpretation,  avec 37% d'évènements sur l'ensemble des observations, il n'est plus possible d'interpréter le modèle en terme de risque (probabilité). La lecture en termes d'Odds Ratio s'impose.  </span>
<span id="cb7-202"><a href="#cb7-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-203"><a href="#cb7-203" aria-hidden="true" tabindex="-1"></a>Probabilités estimées à partir d'un modèle avec la durée seulement.  </span>
<span id="cb7-204"><a href="#cb7-204" aria-hidden="true" tabindex="-1"></a>Risques sur la longueur de l'intervalle.</span>
<span id="cb7-205"><a href="#cb7-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-206"><a href="#cb7-206" aria-hidden="true" tabindex="-1"></a>| Durées         | p     |                      </span>
<span id="cb7-207"><a href="#cb7-207" aria-hidden="true" tabindex="-1"></a>| -------------- | ------| </span>
<span id="cb7-208"><a href="#cb7-208" aria-hidden="true" tabindex="-1"></a>| 0  à  4 mois   | 0.51  |</span>
<span id="cb7-209"><a href="#cb7-209" aria-hidden="true" tabindex="-1"></a>| 4  à 11 mois   | 0.24  |  </span>
<span id="cb7-210"><a href="#cb7-210" aria-hidden="true" tabindex="-1"></a>| 11 à 23 mois   | 0.16  | </span>
<span id="cb7-211"><a href="#cb7-211" aria-hidden="true" tabindex="-1"></a>| 23 à 61 mois   | 0.37  |      </span>
<span id="cb7-212"><a href="#cb7-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-213"><a href="#cb7-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-214"><a href="#cb7-214" aria-hidden="true" tabindex="-1"></a><span class="fu"># Hypothèse PH</span></span>
<span id="cb7-215"><a href="#cb7-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-216"><a href="#cb7-216" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Formellement un modèle logistique à temps discret repose sur une hypothèse d'Odds proportionnel (Odds ratios constants pendant la durée d'observation). Contrairement au modèle de Cox, l'estimation des probabilités (risque) n'est pas biaisée si l'hypothèse PH n'est pas respectée. </span>
<span id="cb7-217"><a href="#cb7-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-218"><a href="#cb7-218" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Comme pour le modèle de Cox, la correction de la non proportionnalité peut se faire en intégrant une interaction avec la durée dans le modèle.</span>
<span id="cb7-219"><a href="#cb7-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-220"><a href="#cb7-220" aria-hidden="true" tabindex="-1"></a>Les variables year et age seront omises pour faciliter la représentation graphique (on repart sur le modèle avec la durée mesurée continue).  </span>
<span id="cb7-221"><a href="#cb7-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-222"><a href="#cb7-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb7-223"><a href="#cb7-223" aria-hidden="true" tabindex="-1"></a>Logistic regression                             Number of obs     <span class="ot">=</span>      <span class="dv">1</span>,<span class="dv">127</span></span>
<span id="cb7-224"><a href="#cb7-224" aria-hidden="true" tabindex="-1"></a>                                                LR <span class="fu">chi2</span>(<span class="dv">5</span>)        <span class="ot">=</span>      <span class="fl">84.78</span></span>
<span id="cb7-225"><a href="#cb7-225" aria-hidden="true" tabindex="-1"></a>                                                Prob <span class="sc">&gt;</span> chi2       <span class="ot">=</span>     <span class="fl">0.0000</span></span>
<span id="cb7-226"><a href="#cb7-226" aria-hidden="true" tabindex="-1"></a>Log likelihood <span class="ot">=</span> <span class="sc">-</span><span class="fl">233.29204</span>                     Pseudo R2         <span class="ot">=</span>     <span class="fl">0.1538</span></span>
<span id="cb7-227"><a href="#cb7-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-228"><a href="#cb7-228" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb7-229"><a href="#cb7-229" aria-hidden="true" tabindex="-1"></a>           e <span class="sc">|</span>      Coef.   Std. Err.      z    P<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>     [<span class="dv">95</span>% Conf. Interval]</span>
<span id="cb7-230"><a href="#cb7-230" aria-hidden="true" tabindex="-1"></a><span class="sc">-------------+----------------------------------------------------------------</span></span>
<span id="cb7-231"><a href="#cb7-231" aria-hidden="true" tabindex="-1"></a>           t <span class="sc">|</span>   <span class="sc">-</span>.<span class="dv">373826</span>    .<span class="dv">083913</span>    <span class="sc">-</span><span class="fl">4.45</span>   <span class="fl">0.000</span>    <span class="sc">-</span>.<span class="dv">5382924</span>   <span class="sc">-</span>.<span class="dv">2093595</span></span>
<span id="cb7-232"><a href="#cb7-232" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb7-233"><a href="#cb7-233" aria-hidden="true" tabindex="-1"></a>   <span class="fl">1.</span>surgery <span class="sc">|</span>  <span class="sc">-</span><span class="fl">1.929061</span>   .<span class="dv">6920142</span>    <span class="sc">-</span><span class="fl">2.79</span>   <span class="fl">0.005</span>    <span class="sc">-</span><span class="fl">3.285383</span>   <span class="sc">-</span>.<span class="dv">5727377</span></span>
<span id="cb7-234"><a href="#cb7-234" aria-hidden="true" tabindex="-1"></a>             <span class="sc">|</span></span>
<span id="cb7-235"><a href="#cb7-235" aria-hidden="true" tabindex="-1"></a> surgery<span class="co">#c.t |</span></span>
<span id="cb7-236"><a href="#cb7-236" aria-hidden="true" tabindex="-1"></a>          <span class="dv">1</span>  <span class="sc">|</span>   .<span class="dv">0690069</span>   .<span class="dv">0333128</span>     <span class="fl">2.07</span>   <span class="fl">0.038</span>      .<span class="dv">003715</span>    .<span class="dv">1342987</span></span>
<span id="cb7-237"><a href="#cb7-237" aria-hidden="true" tabindex="-1"></a>             <span class="sc">|</span></span>
<span id="cb7-238"><a href="#cb7-238" aria-hidden="true" tabindex="-1"></a>          t2 <span class="sc">|</span>   .<span class="dv">0137676</span>   .<span class="dv">0052405</span>     <span class="fl">2.63</span>   <span class="fl">0.009</span>     .<span class="dv">0034964</span>    .<span class="dv">0240388</span></span>
<span id="cb7-239"><a href="#cb7-239" aria-hidden="true" tabindex="-1"></a>          t3 <span class="sc">|</span>  <span class="sc">-</span>.<span class="dv">0001596</span>   .<span class="dv">0000828</span>    <span class="sc">-</span><span class="fl">1.93</span>   <span class="fl">0.054</span>    <span class="sc">-</span>.<span class="dv">0003218</span>    <span class="fl">2.62e-06</span></span>
<span id="cb7-240"><a href="#cb7-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-241"><a href="#cb7-241" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb7-242"><a href="#cb7-242" aria-hidden="true" tabindex="-1"></a>Remarque <span class="sc">:</span> la constante n’est pas reportée.</span>
<span id="cb7-243"><a href="#cb7-243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-244"><a href="#cb7-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-245"><a href="#cb7-245" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/Image13.png)</span></span>
<span id="cb7-246"><a href="#cb7-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-247"><a href="#cb7-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-248"><a href="#cb7-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-249"><a href="#cb7-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-250"><a href="#cb7-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-251"><a href="#cb7-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-252"><a href="#cb7-252" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Marc Thévenin - Ined-Sms - Octobre 2022</div>
  </div>
</footer>



</body></html>